<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>

	

	
	<link rel="preconnect" href="https://apps.developermedia.com" />
	<link rel="preconnect" href="https://cdn1.developermedia.com" />
	<link rel="preconnect" href="https://cdn.ampproject.org" />
	<link rel="preconnect" href="https://fonts.googleapis.com" />
	<link rel="preconnect" href="https://ajax.googleapis.com" />
	<link rel="preconnect" href="https://adservice.google.com" />
	<link rel="preconnect" href="https://www.googletagservices.com" />
	<link rel="preconnect" href="https://www.googletagmanager.com" />
	<link rel="preconnect" href="https://www.google.com" />
	<link rel="preconnect" href="https://www.google-analytics.com" />
	<link rel="preconnect" href="https://pagead2.googlesyndication.com" />

	<link rel="preconnect" href="https://codeproject.freetls.fastly.net" />


	<link rel="preload" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/logo250x135.gif" as="image" />


	<link rel="preload" href="/App_Themes/CodeProject/Img/logo135-bg.gif" as="image" />
	<link rel="preload" href="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js" as="script" type="text/javascript" />


	<title>Inter Computer Read/Write File Lock - CodeProject</title> 
    
	<!-- inlined file /App_Themes/CodeProject/Css/article.critical.min.css. Minimized in Release. -->
<style type="text/css">
.blank-background{background-color:#fff}html,div,span,applet,object,iframe,a,abbr,acronym,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,fieldset,form,label,table,tbody,tfoot,thead,tr,th,td,li,ol,ul{margin:0;padding:0;border:0}html{font-size:100.01%;-webkit-font-smoothing:antialiased;font-smooth:always}body,p,h1,h2,h3,h4,h5,h6,li,tr,td,th,dd,dt{font-family:"Segoe UI",Arial,Sans-Serif;font-size:15px;line-height:1.4;color:#111}body{margin:0}h1,h3,h4,h5,th{font-weight:bold}h1{color:#333;padding:0;margin:0 0 7px;text-align:left}h2{margin:20px 0 11px;padding:0;padding-bottom:10px;color:#333}h3{color:#f90}h1{font-size:29px;font-weight:200}h2{font-size:29px;font-weight:200}h3{font-size:19px;font-weight:normal}h4{font-size:16px}pre{color:#000;background-color:#fbedbb;padding:6px;font:14px Consolas,monospace,mono;white-space:pre;overflow:auto;border:solid 1px #fbedbb;-moz-tab-size:4;-o-tab-size:4;-webkit-tab-size:4;tab-size:4}code{color:#900;font:15px Consolas,monospace,mono}table{background-color:Transparent}img{-ms-interpolation-mode:bicubic}a{text-decoration:none;color:#005782}a:visited{color:#800080}a:hover{text-decoration:underline}a:not([href]){color:inherit;text-decoration:none}input[type="text"],input[type="url"],input[type="search"],input[type="email"],select,textarea{border:1px solid #d7d7d7;font-size:15px;padding:5px}a.button,a.button-large,.button,.button-large{color:#fff;background-color:#e08900;border:1px solid #ccc;text-decoration:none;white-space:nowrap;font-size:100%;padding:4px;cursor:pointer;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}table.small-text td,ul.small-text li,ol.small-text li,.small-text{font-size:13px}.invisible{display:none}.subdue,.subdue li,tr.subdue td{color:#808080}.align-left{text-align:left}.align-right{text-align:right}.align-center{text-align:center}.float-right{float:right}.float-left{float:left}.sticky{position:sticky;top:0}.extended{width:100%;box-sizing:border-box}.padded-top{padding-top:20px}.tight{margin:0;padding:0}.nowrap{white-space:nowrap}.fixed-layout{table-layout:fixed}.raised{background-color:#fff8df;border:1px solid #ccc;-moz-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);-webkit-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);box-shadow:4px 4px 16px 1px rgba(0,0,0,.25)}ol,ul{padding-left:40px;margin:10px 0}ol.compact li,ul.compact li,ol li.compact,ul li.compact{font-size:13px}ul.download{margin-top:25px}ul.download li,ul li.download,ul.Download li,ul li.Download{background:url("/images/download24.png") no-repeat scroll left center transparent;font-weight:bold;list-style-type:none;margin:0 0 6px -40px;padding:0 0 1px 30px;vertical-align:middle}.callout{margin:20px 0;background-color:#ffffe1;color:#333;border:1px solid #ccc;padding:15px;border-radius:3px;-webkit-border-radius:3px;-moz-border-radius:3px}.trace{padding:20px;background-color:#eee;color:#333;border:1px solid #f00;font-size:12px}textarea,input[type="text"],input[type="button"],input[type="submit"]{-webkit-appearance:none;border-radius:0}.container-content{background-color:#fff;position:relative;zoom:1;padding:0 9px;cursor:default}.container-content-wrap{margin:auto;max-width:1270px}.container-content pre,.container-code pre,.answer pre{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word;_white-space:pre;word-break:break-word;-ms-word-break:break-word}.flex-container{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.flex-extend{justify-content:space-between}.flex-item{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.flex-item-tight{flex:0 1 auto}.hover-container{display:block;position:relative}.clearfix:after,.container:after{display:block;content:'.';visibility:hidden;height:0;clear:both}.clearfix,.container{display:inline-block;display:block}.access-link,.access-link img{position:absolute;top:0;left:0;width:1px;height:1px;z-index:101;border-style:none;margin-top:-1px;overflow:hidden}.site-top-menu{white-space:nowrap;position:absolute;z-index:101;width:100%}.site-top-menu .main-content{width:100%}.site-top-menu .main-content .memberbar{margin-left:90px;margin-right:10px}.site-top-menu.fixed .main-content{margin:auto;max-width:1270px}.site-header{background-image:url('/App_Themes/CodeProject/Img/logo135-bg.gif');white-space:nowrap;overflow:hidden}.site-header .main-content{position:relative;overflow:hidden;white-space:nowrap}.site-header .logo{display:inline-block}.site-header .promo{display:inline-block;position:absolute;top:33px;right:0}.site-header.fixed .main-content{margin:auto;max-width:1270px}.sub-headerbar{padding-right:9px;position:relative;margin:auto;max-width:1270px}.sub-headerbar-divider{margin-left:10px;height:1px;border-bottom:1px solid #ccc;position:absolute;bottom:2px;left:0;right:9px}.memberbar{height:25px;padding-top:10px;color:#999;font-size:13px}.memberbar a{color:#808080;font-size:13px}div.navbar{white-space:nowrap}.navmenu{background:#fff;color:#4d4d4d;padding:0;margin:0;list-style:none;height:25px}.navmenu ul,.navmenu li{margin:0;padding:0}.navmenu .has-submenu{position:absolute;right:5px;padding-left:10px}.navmenu&gt;li:hover&gt;a,.navmenu&gt;li&gt;a:active{border:1px solid #ccc}.navmenu ul,.navmenu&gt;li.open:hover&gt;a,.navmenu&gt;li.open&gt;a:active{border:1px solid #ccc;border-bottom-color:#fff}.navmenu&gt;li{margin:0 11px 2px 2px}.navmenu&gt;li:active,.navmenu&gt;li:active&gt;a,.navmenu&gt;li:hover,.navmenu&gt;li&gt;a:active{background:#fff;color:#4d4d4d}.navmenu&gt;li&gt;a{padding:2px 7px 6px 7px;border:1px solid transparent;font-weight:bold}.navmenu a{display:block;float:left;color:#666;background:#fff;font-size:16px;padding:0 9px;text-decoration:none;white-space:nowrap}.navmenu a.fly{white-space:nowrap}.navmenu ul{background:#fff;position:absolute;left:-9999px;top:-9999px;list-style:none}.navmenu li{float:left;color:#4d4d4d}.navmenu li.last{height:9px}.navmenu li a:active,.navmenu li a:hover{color:#fff;background-color:#f90}.navmenu li&gt;a:active,.navmenu li:hover,.navmenu li:hover&gt;a,.navmenu li:hover.heading,.navmenu li a.selected{position:relative;color:#fff;background-color:#f90}.navmenu li.openable:hover ul{left:0;top:30px;z-index:500}.navmenu li.openable:hover&gt;ul ul{position:absolute;left:-9999px;top:-9999px;width:auto}.navmenu li.open{position:relative}.navmenu li.open a{color:#fff;background-color:#f90}.navmenu li.open ul{left:0;top:30px;z-index:500}.navmenu li.open ul ul,.navmenu li.open li.open ul ul,.navmenu li.open li.open li.open ul ul,.navmenu li.open li.open li.open li.open ul ul{position:absolute;left:-9999px;top:-9999px}.navmenu li ul{border-bottom:5px solid #f90}.navmenu li li{float:none}.navmenu li li:active&gt;a.fly,.navmenu li li:hover&gt;a.fly{color:#fff;background-color:#f90}.navmenu li li a{float:none;font-size:13px;font-weight:normal}.navmenu li li a.fly{color:#4d4d4d;background-color:#fff;padding:2px 20px}.navmenu li li a.break{margin-bottom:15px}.navmenu li li a.highlight1,.navmenu li li a.highlight1:active,.navmenu li li a.highlight1:hover{background-color:#090}.navmenu li li a.highlight2,.navmenu li li a.highlight2:active,.navmenu li li a.highlight2:hover{background-color:#f90}.navmenu li li a.highlight3,.navmenu li li a.highlight3:active,.navmenu li li a.highlight3:hover{background-color:#000}.navmenu li li a.highlight1,.navmenu li li a.highlight2,.navmenu li li a.highlight3{color:#fff;font-size:15px;margin:5px 0;padding:9px 20px}.site-footer{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;padding-top:5px;width:100%;font-size:12px;color:#999}.site-footer .align-left,.site-footer .align-center,.site-footer .align-right{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.site-footer .align-left{flex:1 0 100px}.site-footer .align-center{flex:0 1 0%;white-space:nowrap}.site-footer .align-right{flex:1 0 100px}.site-footer .page-width .active{border-bottom:2px solid #f90}.searchbar{padding:0}.searchbar .search{margin-bottom:4px;padding:2px 5px 0;border:1px solid #ccc}.searchbar .search.subdue{color:#ccc}.searchbar input.search{width:190px;border:none;font-size:12px;padding:4px 2px}.searchbar .search-advanced{padding:8px;width:203px;z-index:1000;background-color:#fff;border:solid 1px #ccc;position:absolute;top:-4px;right:0}.searchbar .popup{display:none}.search td{background-color:#fff}.article-container-parts{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex}.article-container{-webkit-box-flex:1;-moz-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;background-color:#fff;color:#111;zoom:1;position:relative;max-width:100%;min-height:675px}.article-container .article{margin:0 20px 0 10px;line-height:143%}.article-container span.stats{margin-left:30px}.article-left-sidebar{width:120px;min-width:120px;min-height:400px;font-size:13px;border-right:1px solid #f2f2f2;padding:0}.article-left-sidebar .article-left-sidebar-inner{width:120px;min-width:120px}.article-left-sidebar .tabs&gt;div{padding:5px 0 5px 10px}.article-left-sidebar .selected{font-weight:bold;background:transparent url("/images/right-selected.gif") no-repeat scroll right 9px}.article-left-sidebar h4{color:#f90;font-size:13px;font-weight:bold}.article-left-sidebar .stats div div div{padding:0 0 10px 10px;color:#666}.article-right-sidebar{width:300px;margin-left:10px;font-size:13px}.article-right-sidebar .gototop{text-align:center;padding:10px 0;opacity:0;-webkit-transition:opacity .3s linear 0ms;-moz-transition:opacity .3s linear 0ms;-o-transition:opacity .3s linear 0ms;transition:opacity .3s linear 0ms}.container-content .edit-links{margin:21px 0 0 10px}.article-summary{padding:0 10px 0 10px;overflow:hidden}.article h1{margin:0 0 15px 0}.article h2{color:#f90}.article pre{overflow:auto}.article .header .title{color:#808080}.article .header .author{font-weight:bold;min-width:100px}.article .header .author a{color:#808080}.article .header .avatar{max-width:48px;max-height:48px;overflow:unset}.article .header .avatar-wrap{width:48px;height:48px;margin-right:10px;text-align:center}.article .header .date{white-space:nowrap}.article .header .license{margin-left:15px}.article .header .stats{margin-left:30px}.article img.lazyload,.article img.lazyloading{opacity:0}.article img.lazyloaded{opacity:1;transition:opacity 300ms}.article .share-list{margin-bottom:40px;width:385px;display:inline-block}.article .summary{color:#808080;padding:40px 0 15px 0}.article .text{padding-top:10px}.article-nav{text-align:right;margin-top:21px;vertical-align:middle;line-height:15px}.msg-728x90{width:728px;height:90px;overflow:hidden}.msg-300x250{width:300px;height:250px;overflow:hidden}.tags{line-height:190%}.tags .t{background:none repeat scroll 0 0 transparent;border:1px solid transparent;border-radius:12px 0 0 12px;line-height:1.4;padding:0 2px 0 4px;position:relative;text-decoration:none;margin:2px 0 4px 0;white-space:nowrap}.tags .t:hover{background-color:#fff8ba;border:1px solid #e5dc8a;text-decoration:none}.tags .t a{color:#666;display:inline-block;margin-right:3px;padding-left:5px;text-overflow:ellipsis}.container-breadcrumb{font-size:13px;margin-top:7px;color:#808080;margin:12px 0 35px}.container-breadcrumb a{color:#808080}.pre-lang{display:-webkit-box;display:-moz-box;display:-ms-flexbox;display:-webkit-flex;display:flex;background-color:#fbedbb;justify-content:space-between;padding:4px 8px;margin-top:5px;color:#999;border-bottom:solid 1px #ffd044}.code-comment{color:#008000;font-style:italic}.code-keyword{color:#00f}.code-sdkkeyword{color:#399}.code-string{color:#800080}.code-attribute{color:#f00}.code-leadattribute{color:#800000}.pre-action-link{font-size:12px;color:#999}.pre-action-link span{cursor:pointer;margin:0;-webkit-transition:color .1s linear;-moz-transition:color .1s linear;-o-transition:color .1s linear;transition:color .1s linear}.speech-bubble-container-down,.speech-bubble-container-up,.speech-bubble-container-up-right,.speech-bubble-container-left,.speech-bubble-container-right{position:relative}.speech-bubble-up,.speech-bubble-down,.speech-bubble-left,.speech-bubble-right,.speech-bubble-up-right{padding:.6em;border:1px solid #ccc;background-color:#fff;margin:15px;text-decoration:none;font-weight:normal;text-align:left;white-space:normal;color:#333;font-size:12px}.speech-bubble-down{margin-bottom:0}.tooltip .speech-bubble-up,.tooltip .speech-bubble-up-right,.tooltip .speech-bubble-down,.tooltip .speech-bubble-left,.tooltip .speech-bubble-right{-moz-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);-webkit-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);box-shadow:4px 4px 16px 1px rgba(0,0,0,.25)}.speech-bubble-pointer-down,.speech-bubble-pointer-down-inner{width:0;height:0;border-bottom-width:0;background:none}.speech-bubble-pointer-down{border-left:7px solid transparent;border-right:7px solid transparent;border-top:1px solid #ccc;border-top-width:14px;margin-left:35px;margin-bottom:15px;_display:none}.speech-bubble-pointer-up,.speech-bubble-pointer-up-right,.speech-bubble-pointer-up-inner,.speech-bubble-pointer-up-right-inner{width:0;height:0;border-top-width:0;background:none}.speech-bubble-pointer-up,.speech-bubble-pointer-up-right{border-left:5px solid transparent;border-right:5px solid transparent;border-bottom:1px solid #ccc;border-bottom-width:14px;margin-left:35px;position:absolute;top:-12px;_display:none}.speech-bubble-pointer-up-inner,.speech-bubble-pointer-up-right-inner{border-left:5px solid transparent;border-right:5px solid transparent;border-bottom:12px solid #fff;margin-left:-5px;margin-bottom:-16px;padding-top:4px;position:absolute;_display:none}.speech-bubble-container-up-right .speech-bubble-pointer-up-right{margin-left:0;margin-right:0;right:35px}.tooltip{position:relative;text-decoration:none}.tooltip .speech-bubble-container-up,.tooltip .speech-bubble-container-down,.tooltip .speech-bubble-container-left,.tooltip .speech-bubble-container-right,.tooltip .speech-bubble-container-up-right,.tooltip .tooltip-flyout{display:none;opacity:0;-webkit-transition:opacity .2s linear 0ms;-moz-transition:opacity .2s linear 0ms;-o-transition:opacity .2s linear 0ms;transition:opacity .2s linear 0ms}.tooltip:hover .speech-bubble-container-up,.tooltip:active .speech-bubble-container-up,.tooltip:hover .speech-bubble-container-down,.tooltip:active .speech-bubble-container-down,.tooltip:hover .speech-bubble-container-left,.tooltip:active .speech-bubble-container-left,.tooltip:hover .speech-bubble-container-right,.tooltip:active .speech-bubble-container-right,.tooltip:hover .speech-bubble-container-up-right,.tooltip:active .speech-bubble-container-up-right,.tooltip:hover .tooltip-flyout,.tooltip:active .tooltip-flyout{display:block;z-index:16777271;opacity:1;-webkit-transition:opacity .2s linear 0ms;-moz-transition:opacity .2s linear 0ms;-o-transition:opacity .2s linear 0ms;transition:opacity .2s linear 0ms}.tooltip:hover .speech-bubble-container-up,.tooltip:active .speech-bubble-container-up{left:-35px}.tooltip:hover .speech-bubble-container-up,.tooltip:active .speech-bubble-container-up,.tooltip:hover .speech-bubble-container-up-right,.tooltip:active .speech-bubble-container-up-right{text-decoration:none;position:absolute;width:150px;color:#000;cursor:text}.tooltip:hover .tooltip-flyout,.tooltip:active .tooltip-flyout,.tooltip:hover .speech-bubble-container-up-right .speech-bubble-pointer-up-right,.tooltip:active .speech-bubble-container-up-right .speech-bubble-pointer-up-right,.tooltip:hover .speech-bubble-container-up .speech-bubble-pointer-up,.tooltip:active .speech-bubble-container-up .speech-bubble-pointer-up{top:1px}a:hover.tooltip{text-decoration:none}.tooltip-flyout{position:relative;border:1px solid #ccc;color:#666;background-color:#fff;margin:15px;z-index:2147483646;white-space:normal;font-weight:normal;text-align:left;cursor:text;width:175px;-moz-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);-webkit-box-shadow:4px 4px 16px 1px rgba(0,0,0,.25);box-shadow:4px 4px 16px 1px rgba(0,0,0,.25)}.bottom-promo{height:90px;margin-top:10px;overflow:hidden}.bottom-promo .msg-728x90{width:728px;margin:0 auto}.msg-728x90{overflow:hidden;position:relative;height:90px;min-width:728px}body .msg-728x90{*float:right}body .bottom-promo .msg-728x90{*float:none}table.forum{table-layout:fixed;margin:0 0 20px 0;padding:0;width:100%}.forum table{border-collapse:separate}.forum .header1,.forum .header1 TD{color:#333;font-size:13px;vertical-align:middle}.forum .header2,.forum .header2 TD{color:#fff;background-color:#f90;font-size:13px;vertical-align:middle}.forum .header2 input,.forum .header2 TD input,.forum .header2 select,.forum .header2 TD select{padding:2px}.forum .button{border:1px solid #fc6;margin:1px}.forum .searchbar{border:1px solid #ccc;padding:4px 0 0 0;margin:3px 0}.forum .searchbar .search{width:200px}.forum .searchbar input[type=image]{vertical-align:middle}.forum .dropdown{background-color:#fffdfa;font-size:95%;margin-left:5px}.forum .footer,.forum .footer td,.forum .navbar,.forum .navbar td{font-size:13px;padding:8px 0;border:0;border-top:1px solid #808080}.author-wrapper{position:relative;padding:0 0 0 200px;min-height:185px}.author-wrapper .pic-wrapper{position:absolute;left:0;top:5px}.author-wrapper .profile-pic{border:1px solid #333;margin:0;padding:10px;-moz-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);-webkit-box-shadow:3px 3px 5px 1px rgba(0,0,0,.2);box-shadow:3px 3px 5px 1px rgba(0,0,0,.2)}.author-wrapper .description{padding:15px 15px 0 0}.author-wrapper .container-member .author{font-size:22px;color:#333}.author-wrapper .container-member .company{font-size:15px;color:#808080}.member-signin{font-size:13px}.member-signin .forgot{padding:0}.member-signin a.forgot{color:#808080}.member-signin.tooltip&gt;span{border:1px solid transparent;padding:2px 6px 4px 6px;z-index:503}.member-signin.tooltip .tooltip-flyout{border:1px solid #ccc;border-bottom:5px solid #f90;padding:10px;width:200px;position:absolute;top:3px;left:-163px;background-color:#fff}.rating-container .rating-prompt{padding-right:5px;white-space:nowrap;line-height:25px;margin-right:2px;font-weight:bold;color:#808080}.rating-container .rating-votes{margin-left:5px}.rating-container.large-stars,.rating-container.medium-stars,.rating-container.small-stars{margin-left:7px}.rating-container.large-stars .rating-votes,.rating-container.large-stars .rating-prompt,.rating-container.large-stars .rating-poor,.rating-container.large-stars .rating-good{line-height:25px}.desktop-only{display:inherit}.tablet-only,.tablet-block-only{display:none}.mobile-only,.mobile-block-only{display:none}.desktop-only.tablet-only{display:inherit}.tablet-only,.mobile-only{display:none}.tablet-only.desktop-only{display:inherit}.rrssb-buttons,.rrssb-buttons li,.rrssb-buttons li a{-moz-box-sizing:border-box;box-sizing:border-box}.clearfix{*zoom:1}.clearfix:after{clear:both}.clearfix:before,.clearfix:after{content:" ";display:table}.rrssb-buttons{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;height:40px;margin:0;padding:0;width:100%}.rrssb-buttons li{float:left;height:100%;list-style:none;margin:0;padding:0 2.5px;line-height:13px}.rrssb-buttons li.email a{background-color:#0a88ff}.rrssb-buttons li.facebook a{background-color:#306199}.rrssb-buttons li.linkedin a{background-color:#007bb6}.rrssb-buttons li.twitter a{background-color:#26c4f1}.rrssb-buttons li.reddit a{background-color:#8bbbe3}.rrssb-buttons li.pinterest a{background-color:#b81621}.rrssb-buttons li.compact{padding:0 4.5px}.rrssb-buttons li.compact a{border-radius:50%;padding:0 7px 0 32px}.rrssb-buttons li.compact a .icon{left:7px;top:-3px;width:5%;transform:scale(.85)}.rrssb-buttons li.compact a .icon svg{height:auto;width:auto}.rrssb-buttons li a{background-color:#ccc;border-radius:3px;display:block;font-size:11px;font-weight:bold;height:100%;padding:11px 7px 12px 27px;position:relative;text-align:center;text-decoration:none;text-transform:uppercase;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;width:100%;-webkit-transition:background-color .2s ease-in-out;-moz-transition:background-color .2s ease-in-out;-o-transition:background-color .2s ease-in-out;transition:background-color .2s ease-in-out}.rrssb-buttons li a .icon{display:block;height:100%;left:10px;padding-top:9px;position:absolute;top:0;width:10%}.rrssb-buttons li a .icon svg{height:17px;width:17px}.rrssb-buttons li a .icon svg path,.rrssb-buttons li a .icon svg polygon{fill:#fff}.cc-window{opacity:1;background-color:#f90}.cc-window.cc-invisible{opacity:0}.cc-animate.cc-revoke.cc-bottom{transform:translateY(2em)}.cc-window,.cc-revoke{position:fixed;overflow:hidden;box-sizing:border-box;font-family:"Segoe UI",Arial,Sans-Serif;font-size:13px;line-height:1.5em;display:flex;flex-wrap:nowrap;z-index:9999}.cc-window.cc-banner{padding:.7em 1.8em;width:100%;flex-direction:row}.cc-revoke{padding:.5em}.cc-btn,.cc-link,.cc-close,.cc-revoke{cursor:pointer}.cc-link{opacity:.8;display:inline-block;padding:.2em;text-decoration:underline}.cc-link:active,.cc-link:visited{color:initial}.cc-btn{display:block;padding:.4em .8em;font-size:.9em;font-weight:bold;border-width:2px;border-style:solid;text-align:center;white-space:nowrap}.cc-banner .cc-btn:last-child{min-width:110px;margin-left:10px}.cc-highlight .cc-btn:first-child{background-color:transparent;border-color:transparent}.cc-revoke.cc-bottom{bottom:0;left:3em;border-top-left-radius:.5em;border-top-right-radius:.5em}.cc-bottom{bottom:1em}.cc-window.cc-banner{align-items:center}.cc-banner.cc-bottom{left:0;right:0;bottom:0}.cc-banner .cc-message{flex:1}.cc-compliance{display:flex;align-items:center;align-content:space-between}.cc-compliance&gt;.cc-btn{flex:1}.cc-btn+.cc-btn{margin-left:.5em}
</style>
<link rel="stylesheet" type="text/css" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.2022.05.26.1" media="none" onload="if(media!='all')media='all'" />
<noscript>&lt;link rel="stylesheet" type="text/css" href="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.2022.05.26.1"&gt;</noscript>


    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js" defer=""></script>
<script type="text/javascript" src="https://codeproject.freetls.fastly.net/script/Articles/JS/article.min.js?dt=2.8.2022.05.26.1" defer=""></script>
<script type="text/javascript" src="https://accounts.google.com/gsi/client" defer="" async=""></script>
<script type="text/javascript" src="/script/JS/advertisement.min.js" defer=""></script>
<script type="text/javascript" src="/script/Membership/JS/MemberProfilePopup.min.js?v=1.4" defer=""></script>
<script type="text/javascript" src="/a.min.js?v=1.3" defer=""></script>

	
<meta http-equiv="content-language" content="en-US" />
<meta charset="UTF-8" />
<meta name="Description" content="Using File Management Windows API for implementing inter computer Read/Write lock" />
<meta name="Keywords" content="VC8.0, WinXP, Win2003, C++, Windows, Win32, MFC, Dev, Intermediate" />
<meta name="Author" content="AndreBroz" />
<meta name="Rating" content="General" />
<meta name="Revisit-After" content="1 days" />
<meta name="application-name" content="CodeProject" />
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13" />

<link rel="dns-prefetch" href="//ajax.googleapis.com" /> 
<link rel="canonical" href="https://www.codeproject.com/Articles/49670/Inter-Computer-Read-Write-File-Lock" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@CodeProject" />
<meta name="og:site_name" content="CodeProject" />
<meta name="twitter:creator" content="@CodeProject" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="1/4/2010 11:48:00 AM" />
<meta property="article:modified_time" content="1/4/2010 11:48:00 AM" />
<meta name="twitter:label1" content="Written by" />
<meta name="twitter:data1" content="AndreBroz" />
<meta name="twitter:label2" content="Reading time" />
<meta name="twitter:data2" content="5 min read" />
<meta property="og:url" content="https://www.codeproject.com/Articles/49670/Inter-Computer-Read-Write-File-Lock" />
<meta property="og:title" content="Inter Computer Read/Write File Lock" />
<meta property="og:description" content="Using File Management Windows API for implementing inter computer Read/Write lock" />

<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Python" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=34" />
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx" />
<meta name="robots" content="index, follow" />

<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-touch-icon.png" /> 
<link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png" /> 
<link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png" /> 
<link rel="manifest" href="/favicon/manifest.json" /> 
<link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#ff9900" />
	<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.codeproject.com/Articles/49670/Inter-Computer-Read-Write-File-Lock"
   },
  "name": "Inter Computer Read/Write File Lock",
  "headline": "Inter Computer Read/Write File Lock",
  "url": "https://www.codeproject.com/Articles/49670/Inter-Computer-Read-Write-File-Lock",
  "discussionUrl": "https://www.codeproject.com/Articles/49670/Inter-Computer-Read-Write-File-Lock#_comments",
  "isFamilyFriendly": "true",
  "image": "https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/Article100.png",
  "keywords": "VC8.0,WinXP,Win2003,C++,Windows,Win32,MFC,Dev,Intermediate",
  "commentCount": "9",
  "editor" : {
    "@type" : "Person",
    "name" : "Deeksha Shenoy",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3866010"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  },
  "description": "Using File Management Windows API for implementing inter computer Read/Write lock",
  "articleSection": "MFC",
  "author" : [{
      "@type" : "Person",
      "name" : "AndreBroz",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3363403"
    }],
  "datePublished": "2010-01-04",
  "dateCreated": "2010-01-04",
  "dateModified": "2010-01-04"
,
  "contentRating" : {
    "@type" : "Rating",
    "ratingValue" : 4.20,
    "bestRating" : 5,
    "worstRating" : 1
  }
}</script>

<script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=desktop",
      "name" : "Desktop Programming"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/script/Content/Tag.aspx?tags=MFC",
      "name" : "MFC"
    }
  }]
}</script>


	<base target="_top" />
	
    


<script type="text/javascript">
function defrm () { /* thanks twitter */
    document.write = '';
    window.top.location = window.self.location;
    setTimeout(function() { document.body.innerHTML = ''; }, 0);
    window.self.onload = function(evt) { document.body.innerHTML = ''; };
}

if (window.top !== window.self) {
    try {
        if (window.top.location.host) { /* will throw for all except chrome */ }
        else { defrm(); /* chrome */ }
    } catch (ex) { defrm(); /* everyone else */ }
}

// Specific case where a site is screwing with us.
if (typeof(DemoUrl) !== 'undefined') {
    document.write(unescape('%3Cme') + 'ta http' + '-equiv="re' + 'fresh con' +
                           'tent="1;url=' + DemoUrl + unescape('"%3CE'));
}
</script>
	





    <script async="" type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-YZNPNQ0F2S"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-YZNPNQ0F2S' );
    </script>

<link id="googleidentityservice" type="text/css" media="all" rel="stylesheet" href="https://accounts.google.com/gsi/style" /><style id="googleidentityservice_button_styles">.qJTHM{-webkit-user-select:none;color:#202124;direction:ltr;-webkit-touch-callout:none;font-family:"Roboto-Regular",arial,sans-serif;-webkit-font-smoothing:antialiased;font-weight:400;margin:0;overflow:hidden;-webkit-text-size-adjust:100%}.ynRLnc{left:-9999px;position:absolute;top:-9999px}.L6cTce{display:none}.bltWBb{word-break:break-all}.hSRGPd{color:#1a73e8;cursor:pointer;font-weight:500;text-decoration:none}.Bz112c-W3lGp{height:16px;width:16px}.Bz112c-E3DyYd{height:20px;width:20px}.Bz112c-r9oPif{height:24px;width:24px}.Bz112c-uaxL4e{-webkit-border-radius:10px;border-radius:10px}.LgbsSe-Bz112c{display:block}.S9gUrf-YoZ4jf,.S9gUrf-YoZ4jf *{border:none;margin:0;padding:0}.fFW7wc-ibnC6b&gt;.aZ2wEe&gt;div{border-color:#4285f4}.P1ekSe-ZMv3u&gt;div:nth-child(1){background-color:#1a73e8!important}.P1ekSe-ZMv3u&gt;div:nth-child(2),.P1ekSe-ZMv3u&gt;div:nth-child(3){background-image:linear-gradient(to right,rgba(255,255,255,.7),rgba(255,255,255,.7)),linear-gradient(to right,#1a73e8,#1a73e8)!important}.haAclf{display:inline-block}.nsm7Bb-HzV7m-LgbsSe{-webkit-border-radius:4px;border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition:background-color .218s,border-color .218s;transition:background-color .218s,border-color .218s;-webkit-user-select:none;-webkit-appearance:none;background-color:#fff;background-image:none;border:1px solid #dadce0;color:#3c4043;cursor:pointer;font-family:"Google Sans",arial,sans-serif;font-size:14px;height:40px;letter-spacing:0.25px;outline:none;overflow:hidden;padding:0 12px;position:relative;text-align:center;vertical-align:middle;white-space:nowrap;width:auto}@media screen and (-ms-high-contrast:active){.nsm7Bb-HzV7m-LgbsSe{border:2px solid windowText;color:windowText}}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe{font-size:14px;height:32px;letter-spacing:0.25px;padding:0 10px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe{font-size:11px;height:20px;letter-spacing:0.3px;padding:0 8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe{padding:0;width:40px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe{width:32px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe{width:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK{-webkit-border-radius:20px;border-radius:20px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe{-webkit-border-radius:16px;border-radius:16px}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe{-webkit-border-radius:10px;border-radius:10px}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc{border:none;color:#fff}.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc{background-color:#1a73e8}.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc{background-color:#202124;color:#e8eaed}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:18px;margin-right:8px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:14px;min-width:14px;width:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{height:10px;min-width:10px;width:10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin-left:8px;margin-right:-4px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:10px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:8px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c{padding:4px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:3px;border-top-left-radius:3px;-webkit-border-bottom-left-radius:3px;border-bottom-left-radius:3px;display:-webkit-box;display:-webkit-flex;display:flex;justify-content:center;-webkit-align-items:center;align-items:center;background-color:#fff;height:36px;margin-left:-10px;margin-right:12px;min-width:36px;width:36px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c,.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsSe-Bz112c{margin:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:28px;margin-left:-8px;margin-right:10px;min-width:28px;width:28px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{height:16px;margin-left:-6px;margin-right:8px;min-width:16px;width:16px}.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:3px;border-radius:3px;margin-left:2px;margin-right:0;padding:0}.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:14px;border-radius:14px}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:8px;border-radius:8px}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex-direction:row;flex-direction:row;justify-content:space-between;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;height:100%;position:relative;width:100%}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX{justify-content:center}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:1;flex-grow:1;font-family:"Google Sans",arial,sans-serif;font-weight:500;overflow:hidden;text-overflow:ellipsis;vertical-align:top}.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-weight:300}.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId{-webkit-flex-grow:0;flex-grow:0}.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe{-webkit-transition:background-color .218s;transition:background-color .218s;bottom:0;left:0;position:absolute;right:0;top:0}.nsm7Bb-HzV7m-LgbsSe:hover,.nsm7Bb-HzV7m-LgbsSe:focus{-webkit-box-shadow:none;box-shadow:none;border-color:#d2e3fc;outline:none}.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.04)}.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(66,133,244,.1)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe,.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.24)}.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe{background:rgba(255,255,255,.32)}.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY{-webkit-border-radius:50%;border-radius:50%;display:-webkit-box;display:-webkit-flex;display:flex;height:20px;margin-left:-4px;margin-right:8px;min-width:20px;width:20px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId{font-family:"Roboto";font-size:12px;text-align:left}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf,.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS{overflow:hidden;text-overflow:ellipsis}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;color:#5f6368;fill:#5f6368;font-size:11px;font-weight:400}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff{color:#e8eaed;fill:#e8eaed}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c{height:18px;margin:-3px -3px -3px 2px;min-width:18px;width:18px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-top-left-radius:0;border-top-left-radius:0;-webkit-border-bottom-left-radius:0;border-bottom-left-radius:0;-webkit-border-top-right-radius:3px;border-top-right-radius:3px;-webkit-border-bottom-right-radius:3px;border-bottom-right-radius:3px;margin-left:12px;margin-right:-10px}.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf{-webkit-border-radius:18px;border-radius:18px}.L5Fo6c-sM5MNb{border:0;display:block;left:0;position:relative;top:0}.L5Fo6c-bF1uUb{-webkit-border-radius:4px;border-radius:4px;bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0}.L5Fo6c-bF1uUb:focus{border:none;outline:none}sentinel{}</style><meta http-equiv="origin-trial" content="AzoawhTRDevLR66Y6MROu167EDncFPBvcKOaQispTo9ouEt5LvcBjnRFqiAByRT+2cDHG1Yj4dXwpLeIhc98/gIAAACFeyJvcmlnaW4iOiJodHRwczovL2RvdWJsZWNsaWNrLm5ldDo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ==" /><meta http-equiv="origin-trial" content="A6+nc62kbJgC46ypOwRsNW6RkDn2x7tgRh0wp7jb3DtFF7oEhu1hhm4rdZHZ6zXvnKZLlYcBlQUImC4d3kKihAcAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXN5bmRpY2F0aW9uLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ==" /><meta http-equiv="origin-trial" content="A/9La288e7MDEU2ifusFnMg1C2Ij6uoa/Z/ylwJIXSsWfK37oESIPbxbt4IU86OGqDEPnNVruUiMjfKo65H/CQwAAACLeyJvcmlnaW4iOiJodHRwczovL2dvb2dsZXRhZ3NlcnZpY2VzLmNvbTo0NDMiLCJmZWF0dXJlIjoiUHJpdmFjeVNhbmRib3hBZHNBUElzIiwiZXhwaXJ5IjoxNjYxMjk5MTk5LCJpc1N1YmRvbWFpbiI6dHJ1ZSwiaXNUaGlyZFBhcnR5Ijp0cnVlfQ==" /><script src="https://securepubads.g.doubleclick.net/gpt/pubads_impl_2022052601.js" async=""></script></head>	

<body class="chrome chrome102">

	<div id="ctl00_OneTap_OneTap">
    <div id="g_id_onload" data-client_id="857795997829.apps.googleusercontent.com" data-login_uri="/script/Membership/OAuthLogOn.aspx?auth=Google">
    </div>
</div>



	<a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="https://codeproject.freetls.fastly.net/images/t.gif" /></a>




<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix flex-container flex-extend">

	<div id="ctl00_MemberBar_GenInfo" class="flex-item align-left">15,318,183 members</div>

	<div class="flex-item">
		
	</div>

	<div class="flex-item align-right">

		

		

		

			<script type="text/javascript">//&lt;!--
			function doSubmit(secure)
			{
				if (secure)
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock"
				else
					document.signinForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock"
				document.signinForm.submit();
				return true;
			}//--&gt;
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock">Sign in</a>
                    <img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/login32.png" width="16" height="16" style="vertical-align:middle;" />
				</span>

				<div class="tooltip-flyout">
					<form name="signinForm" id="signinForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock" method="post" class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden" />

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email" autocomplete="email" /></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password" autocomplete="current-password" /></div>
						<div class="action">
                            <input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" />
                            <input type="hidden" name="fld_quicksign" value="true" />
							<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);" />
						</div>

						<div class="container">
							
							Â 
							<a id="ctl00_MemberBar_SendPassword" class="forgot float-right" href="/script/Membership/SendPassword.aspx?rp=/Articles/49670/Inter-Computer-Read-Write-File-Lock">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark" />

					Sign in with <a class="oauth" alt="Sign in using Github" title="Sign in using Github" href="/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="/script/Membership/Images/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Facebook" title="Sign in using Facebook" href="/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="/script/Membership/Images/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Google" title="Sign in using Google" href="/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="/script/Membership/Images/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>
<a class="oauth" alt="Sign in using Microsoft" title="Sign in using Microsoft" href="/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="/script/Membership/Images/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;" /></a>

				</div>
            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;" /></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Desktop-ProgrammingMFC" data-country="US" data-tags="VC8.0, WinXP, Win2003, C++, Windows, Win32, MFC, Dev, Intermediate,rating4"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-ProgrammingMFC&amp;sz=728x90&amp;c=513949"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-ProgrammingMFC&amp;sz=728x90&amp;c=513949"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript></div></div>
        </div>
    </div>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search " id="sb_tb" autocomplete="off" value="" name="q" /></td><td><input type="image" src="https://codeproject.freetls.fastly.net/images/search.gif" /></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced popup small-text align-left">
	<b>Search within:<br /></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="checked" /><label for="sb_kw">Articles</label><br />
<input type="radio" id="sb_qa" name="sbo" value="qa" /><label for="sb_qa">Quick Answers</label><br />
<input type="radio" id="sb_fm" name="sbo" value="fm" /><label for="sb_fm">Messages</label><br />


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="/script/Content/SiteMap.aspx">Browse Topics<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout" class="taxonomy">
			<li>
				<div id="siteMap"></div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="/script/Articles/Latest.aspx">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="/script/Articles/Submit.aspx">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Submit an article or tip
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtImportGitHub" class="fly highlight3" href="/script/Articles/ImportArticle.aspx">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Import GitHub Project
			</a></li>
        
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="/script/Articles/BlogFeed.aspx">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Import your Blog
			</a></li>		
        
        <li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments">
			<img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="/Questions/ask.aspx"><img src="https://codeproject.freetls.fastly.net/images/write13.png" width="13" height="13" /> Ask a Question</a></li>

		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="/script/Answers/List.aspx?tab=active">View All Questions</a></li>
        
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=81" style="padding-left:30px">View C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=78" style="padding-left:30px">View C++ questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=268" style="padding-left:30px">View Python questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=87" style="padding-left:30px">View Javascript questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;amp;alltags=true&amp;amp;tags=91" style="padding-left:30px">View Java questions</a></li>
			
    
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_SenseAI" class="fly" href="/Feature/SenseAI-Discussions.aspx">CodeProject SenseAI</a></li>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1580997/Application-Lifecycle">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1533717/Running-a-Business">Running a Business</a></li>
<li><a class="fly" href="/Forums/1533716/Sales-Marketing">Sales / Marketing</a></li>
<li><a class="fly" href="/Forums/1651/Collaboration-Beta-Testing">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="/Forums/3304/Work-Issues">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/369270/Design-and-Architecture">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1969389/Artificial-Intelligence">Artificial Intelligence</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/12076/ASP-NET">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1580226/JavaScript">JavaScript</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1969388/Internet-of-Things">Internet of Things</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1647/C-Cplusplus-MFC">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/4486/ATL-WTL-STL">ATL /  WTL / STL</a></li>
<li><a class="fly" href="/Forums/3785/Managed-Cplusplus-CLI">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1649/Csharp">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1627782/Free-Tools">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1827460/Objective-C-and-Swift">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1725/Database">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/186301/Hardware-Devices">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="/Forums/1644/System-Admin">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1606152/Hosting-and-Servers">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1643/Java">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1942421/Linux-Programming">Linux Programming</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1650/NET-Core-and-Framework">.NET (Core and Framework)</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1848626/Android">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1876716/iOS">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/13695/Mobile">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1004257/WPF">WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1646/Visual-Basic">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1640/Web-Development">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="/Forums/1652005/Spam-and-Abuse-Watch">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable"><a id="ctl00_TopNavBar_Features" href="/Feature/">
      <span class="desktop-only tablet-only">features</span><span class="mobile-only">stuff</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="/script/Contests/CurrentCompetitions.aspx?cmpTpId=3&amp;amp;awsac=true">Competitions</a></li>
        
		<li><a id="ctl00_TopNavBar_Conferences" class="fly" href="/script/Conferences/List.aspx">Conferences</a></li>
		
		<li><a id="ctl00_TopNavBar_News" class="fly" href="/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="/script/Surveys/List.aspx">Surveys</a></li>
		
        
		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="/script/Contests/Winners.aspx?obtid=1&amp;amp;cmpTpId=2&amp;amp;cid=0">Most Valuable Professionals</a></li>

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="/Lounge.aspx">The Lounge Â </a></li>
		<li><a id="ctl00_TopNavBar_SiteBlog" class="fly break" href="/Members/CodeProject#_comments">The CodeProject Blog</a></li>

		<li><a id="ctl00_TopNavBar_WhereAmILink" class="fly" href="/Forums/1939564/Where-I-am-Member-Photos">Where I Am: Member Photos</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>

		<li class="last"></li>
	</ul>

</li>


<li class="openable" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="/KB/FAQs/">
    <span class="desktop-only tablet-only">help</span><span class="mobile-only">?</span>
</a>


	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="/Forums/1641/Article-Writing">Article Help Forum</a></li>
		
		
		
		
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 

	<div class="container-content">

        
		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a rel="nofollow" href="/script/Content/SiteMap.aspx">Articles</a> / <a rel="nofollow" href="/script/Content/Tag.aspx?tags=desktop">Desktop Programming</a> / <a rel="nofollow" href="/script/Content/Tag.aspx?tags=MFC">MFC</a></div>
			</div>

            <div class="float-left">
				
			</div>

			<div class="edit-links float-right">
				



 
Â 










			</div>

			<div class="article-nav float-right">
				


<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



 

<a id="ctl00_ActionLinks_PrintMd" data-tooltip="Print" data-enabletooltip="true" data-width="auto" href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?display=Print">
   <img src="/App_Themes/CodeProject/Img/print48.png" width="24" height="24" style="border:0" />
</a>



<span id="ctl00_ActionLinks_R">
    
    
</span>
			</div>
		</div>

        
		<div class="extended article-container-parts">

			
		    <div id="ctl00_LeftSideBar" class="article-left-sidebar">

                <div id="ctl00_StickyBlock" class="article-left-sidebar-inner sticky">

                    
    		        

<div class="tabs">
	<div class=" selected">Article</div>
<div class="browse-code"><a href="/script/Articles/ViewDownloads.aspx?aid=49670">Browse Code</a></div>
<div><a href="/script/Articles/Statistics.aspx?aid=49670">View Stats</a></div>
<div><a href="/script/Articles/ListVersions.aspx?aid=49670">Revisions (17)</a></div>
<div><a href="#_comments">Comments (9)</a></div>
<div>Posted 4 Jan 2010</div>


    
</div>



			        

			        <div>
                        <h4 id="ctl00_TaggedAsWrapper">Tagged as</h4>
			            <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="/Tags/VC8.0" data-id="9">VC8.0</a></div><div class="t"><a rel="tag" href="/Tags/WinXP" data-id="24">WinXP</a></div><div class="t"><a rel="tag" href="/Tags/Win2003" data-id="26">Win2003</a></div><div class="t"><a rel="tag" href="/Tags/Cplusplus" data-id="78">C++</a></div><div class="t"><a rel="tag" href="/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="/Tags/Win32" data-id="99">Win32</a></div><div class="t"><a rel="tag" href="/Tags/MFC" data-id="107">MFC</a></div></span> 

	
	
</span>


			        </div>

                    <div id="ctl00_VerticalStatsWrapper" class="stats">
                    <h4>Stats</h4>
                    <div id="ctl00_VerticalStats"><div class="stats"><div>32.2K views</div><div>486 downloads</div><div>14 bookmarked</div></div></div>
                    </div>

                    
                </div>
		    </div>
            

			
			<div id="AT" class="article-container  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="./View.aspx" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="yex7ehZlwCKjYvhLXkH7ARYUcb5ALuHvLywl7W9GIw73gm2+OknIk0ZKF+5mF52MKp9ddTQk/XUxJFSTDmUNTmBchGOWaI1ER5TmDQdDx4XVrfvWYOmBVDXnnJYzqkHXIqg+QGmFskMNBfvFBjHMp9Gqgs6uOeaHig4FI9u8SgmPfio4DbMbf9lsJMjfPtQfyiAYMcB8PkLMK/DtfjiKDQypkwzBoInAzK1M8c8Q9wQ2IVCbYh/MA5wakK0+RJCFx1WqpZe1jsSURyRdmogDx1Uw5EU0+7nmo/r5DrZIPp3AhDOjG4vdiJN6J69pBZ6iN4nE7mMqHEz7cBUqerxG3C4wSu+XXWVo0V6cId1mZqJwQ8cSrCcw4Kt/VjeTKagwlTkatvlCmks/NzHtySSz1aqg5l2uos47CxTyHLSUcOZKTr7kG5XDWYK5x7el7P/p4jlmlLV7DudbAEO99uRlWql/Eb+dEhvebWhiPCt1Oagj9EilmAjmMH9OGDA4zV1jpBdAbV+v8KFpIuXOsx6UFkGI7jwzZ5XEgJ3RLjpuSumP8XADx33P7ljETr7OOQIIZzJ2esq4HZFn3rGO7ChNm9TQPbV4vYXrmegien+klMpdMw3VPmN0okMluKrNUNLHENcE+o5GbJ+kW/pL7gul+IQwmyu4LkRrN4sxmPkNKeIDQxLJQfmmN5084c65OJTgMVl7FpdD6mIJrcioGrkZWf/RGxXEF9bwdFmFhGif7tgv4YsFCD4VsFhSqnlxM6sPb1Aq6tYOitlEteEwj58qmkNDRtAqNl4K29Hge4cqnFeAn5E6vimLk+6hidzMK0J8fkxuakfojMcc5T0D7rMdPHpEBOcHLi+neg4uN55gfFF1UjcjjJ4k2l/Dv0HHA46u2r2kK7L2MCnUiweKNHQRIrNcFwOIGMHp15IWgritr5GMQu+fTHFFzNk6pWjps+NsOJhwg6Sa5SOD1U8SRBigoCDNpWkvZ8+YhR1oU+LU8fyjkNryX4Dqn0A0PM74q5tZHf5M+X3r9+wXigNNw6RnWg2mcowA6xCkBQ8PLzegb7i5a2EVuL1B0HcbzHfZErXXZJiny8FTtiyvrAt3UXnRa4cg1zOdDd5FUK1EPVoaYbMyuyQwxRcAL8/UcpNTSrkttuB9duz+/BNRTViHYf4x/+yX87HtN+DJhKUbQCIFvU5rIUgDMB4hmwTEYhbArNdfbYQ6zahcuA3q+ks7b4YvmcWZVodq2CEO2H6UtMWacdZxNN6/3Yi6r+hDqlORpD5QjKyfeTblIXB5v2PkFxkmPCNIuu5HPMfvpN0qqucpKAs1ypD5LCThLhcsiOemIzDXaV48mJvvd4lPt1SOVuVgjc3mS1e4RY0H1qYcdpofrmDSFhrxWlbkYm1zZVVvtesu3byVMZlS8okI8UBF/lXiFOaR4ilBcFB30Rh9EGPBlp/hDsELkodfafbKknfpIAZhf5dv+c9ifsnMZiYtU2Y7v8vgLSLtem6+ztIm9to+S/mqzWPdzkv3gJE0Lc6gWaTbSizp+fKbpT3enYQ/D95tp7e0eG21/0xMsKJB0eogWraiXSTt8ysDkGkyNAu9GyUgoPFZMIBjX+BInyOXJfR1XUMp9KtJzhr9u3hHNucLdAlcggRpTQZodpj/SjC595K44hiVfnyq6NrdK6mjB62jjRbZdcHYwrCMeAkpuiaJwGU28/Fe4u570WFqD/Qyh2AVtigeH9mFfwx0jCprY7qiPnkNw/jNW+siOGvZKH97O72cPRkNcD35tlIJCsdUZD2wCBcRvmBzgUUxaQ3bupohzH/unbkrxN6uwTuC5GGJCgWwA6GyWzI7xzAVMdLi6ND+T8J9TalJFqy7vC+0uTWJBUVlHobvA3XjRq7owd0x2q+TlttpeBGGcAlBG/AH9PD1x5O5wtSd5zPIf5IGVPTpBmnaLXc=" />
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69" />
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Inter Computer Read/Write File Lock</h1>
					    </div>

                        <div>
					        
					        <div class="entry flex-container">

								

                                <div class="flex-item" style="flex:1 1 auto">
                                    <div class="flex-container" style="justify-content:space-between;flex-wrap:wrap-reverse">
                                       <span id="ctl00_Authors" class="author flex-item"><a href="/script/Membership/View.aspx?mid=3363403" rel="author">AndreBroz</a></span> 

                                        <div class="flex-item" style="margin-top:-4px;">
                                            <div id="ctl00_RateArticle_RatingTable" class="small-text" data-objectref="2_49670_17">

	<meta itemprop="upvoteCount" content="3" />


	<div id="ctl00_RateArticle_RatingRow" class="flex-container rating-container large-stars">

					
		<div id="ctl00_RateArticle_Prompt" class="rating-prompt nowrap">Rate me:</div>

		
		<div class="nowrap tooltip">

			
			
			

			
			<div id="ctl00_RateArticle_RatingHistWrap" class="tooltip">

				
				<div id="ctl00_RateArticle_ResultWithHist" class="rating-result"><div class="flex-container rating-stars large-stars"><div><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div style="width:4px;" class="clipped"><img src="https://www.codeproject.com/script/Ratings/Images/star-fill-lg.png" style="width:24px;height:24px" /></div><div style="width:20px;position:relative" class="clipped"><img src="https://www.codeproject.com/script/Ratings/Images/star-empty-lg.png" style="width:24px;height:24px;position:absolute;top:0px;right:0" /></div></div></div>
				

				<div class="speech-bubble-container-up-right" style="width:170px">
					<div class="speech-bubble-up-right">
						<div class="histogram"></div>
					</div>
					<div class="speech-bubble-pointer-up-right">
						<div class="speech-bubble-pointer-up-right-inner"></div>
					</div>
				</div>
			</div>

			
            

			
            <span id="ctl00_RateArticle_RatingSignin" class="speech-bubble-container-down">
		        <div class="speech-bubble-down">
                    Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock">Sign up or sign in</a> 
                    to vote.
		        </div>
		        <div class="speech-bubble-pointer-down">
			        <div class="speech-bubble-pointer-down-inner"></div>
		        </div>
	        </span>    

		</div>
		
	
		
		<div id="ctl00_RateArticle_VoteCountNoHist" class="rating-votes nowrap">4.20/5  (4 votes)</div>	

		

		
		<div class="rating-undo" title="Undo vote" style="margin-left:5px;display:none"></div>

		
		
	</div>

	
	

</div>

                                        </div>
                                    </div>

                                    <div class="flex-container">
                                        <span id="ctl00_LastUpdated" class="date flex-item-tight" title="Date last updated">4 Jan 2010</span><a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license flex-item-tight" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a><span id="ctl00_ReadingTime" class="stats flex-item-tight">5 min read</span>
                                    </div>
                                </div>
					        </div>

                            

                        </div>

                        <div id="ctl00_DescriptionSpot" class="summary">Using File Management Windows API for implementing inter computer Read/Write lock</div><span id="ctl00_ThumbnailUrl" class="date" content="https://codeproject.global.ssl.fastly.net/script/Articles/Images/article100x80.png"></span>			

                    </div>
                    
					
					

					

					
					

					
					
					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="/KB/threads/inter_comp_rw_file_lock/TestFileLock.zip">Download source - 22.72 KB</a> </li></ul>

<h2>Introduction</h2>

<p>Sometimes it is required to access some shared resource from several applications which reside on different computers. For example, the case can be that there are two applications that access the same Microsoft Access database file which is located on the network share. At some moment, one of the applications needs to compact the database file which involves copying the file to a different name, removing the original file and than renaming the new compacted file to the original. During this process, all threads and processes that access the database should wait, otherwise they fail. On the other hand, the thread that starts compacting the database file should wait for all other threads and processes to finish their work with the database. There are plenty of synchronization mechanisms like named events, named mutexes that allow inter process synchronization. But I don't know any that allows synchronization between computers. I tried to search for any existing solutions to this problem in the Internet and found nothing. That is why I decided to create an Inter Computer Read/Write Lock which can be implemented using File Management Windows API.</p>

<h2>Using the Code</h2>

<p>The lock classes are intended to be used like MFC <code>CSingleLock </code>class. They are not thread-safe because they are intended to be created on a thread stack and usually their lifetime is inside the scope where the shared resource is accessed.</p>

<div class="pre-lang" id="premain745272"><div>C++</div><div class="pre-action-link"><span id="copycode745272" class="copy-code" data-index="745272" style="visibility:hidden">Copy Code</span></div></div>
<pre id="pre745272" style="margin-top:0;" class="lang-cplusplus" data-language="C++" data-allowshrink="True" data-collapse="False">{
    NMt::CReadFileLock l_Lock(<span class="code-string">"</span><span class="code-string">\\\\mycomputer\\share\\test.mdb"</span>, <span class="code-keyword">true</span>);
    <span class="code-comment">// connect to db and perform read/update operations
</span>    <span class="code-comment">// ...
</span>    <span class="code-comment">// close db connection
</span>}

{
    NMt::CWriteFileLock l_Lock(<span class="code-string">"</span><span class="code-string">\\\\mycomputer\\share\\test.mdb"</span>, <span class="code-keyword">true</span>);
    <span class="code-comment">// compact db
</span>    <span class="code-comment">// (copies db to a different file while compacting it, removes the original db file, 
</span>    <span class="code-comment">// renames the compacted file to the original)
</span>    <span class="code-comment">// ...
</span>} </pre>

<p>The first parameter is a path to a resource that should be accessed. The second parameter is whether it attempts to lock initially in the constructor. An application should have read/write access to a directory where the resource is located because these locks create/open two lock files in the same directory.</p>

<h2>How the Code Works</h2>

<p>The implementation is based on the fact that <code>CreateFile </code>can be viewed as an atomic operation. There are two files used for locking. The first one with <em>.rlc</em> extension is created/opened by readers in the shared mode, allowing many readers to open the file while writers create/open this file in the exclusive mode allowing only a single writer to access this file. The second file with <em>.wlc</em> extension is created/opened by readers in the shared mode and immediately closed, while writers create/open this file in the exclusive mode to prevent readers from entering. This allows writers to get preference when accessing the resource and prevents writers from starvation. If a reader/writer fails to create/open some of the lock files because of the sharing violation error, it will wait for some period and try to access the files again. This allows waiting on the lock until resource is unlocked.</p>

<p>The <code>CReadFileLock </code>and <code>CWriteFileLock </code>classes are actually not more than a convenient way to use the base class implementation - <code>CRWFileLock</code>.</p>

<div class="pre-lang" id="premain434971"><div>C++</div><div class="pre-action-link"><span id="copycode434971" class="copy-code" data-index="434971" style="visibility:hidden">Copy Code</span></div></div>
<pre id="pre434971" style="margin-top:0;" class="lang-cplusplus" data-language="C++" data-allowshrink="True" data-collapse="False"><span class="code-comment">/*</span><span class="code-comment">!
\brief Read File Lock class.
*/</span>
<span class="code-keyword">class</span> CReadFileLock : <span class="code-keyword">public</span> CRWFileLock
{
public:
  <span class="code-comment">// LIFECYCLE
</span>  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Constructor.
  \param[in] xi_cszFilePath a path to a file to be accessed
  \param[in] xi_bInitialLock if it is initially locked
  \param[in] xi_nPollPeriodMs polling period (milliseconds)
  */</span>
  CReadFileLock(LPCTSTR xi_cszFilePath,
                <span class="code-keyword">bool</span> xi_bInitialLock = <span class="code-keyword">false</span>,
                DWORD xi_nPollPeriodMs = <span class="code-digit">1000</span>) :
      CRWFileLock(<span class="code-keyword">true</span>, xi_cszFilePath, xi_bInitialLock, xi_nPollPeriodMs) {}
};
<span class="code-comment">/*</span><span class="code-comment">!
\brief Write File Lock class.
*/</span>
<span class="code-keyword">class</span> CWriteFileLock : <span class="code-keyword">public</span> CRWFileLock
{
public:
  <span class="code-comment">// LIFECYCLE
</span>  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Constructor.
  \param[in] xi_cszFilePath a path to a file to be accessed
  \param[in] xi_bInitialLock if it is initially locked
  \param[in] xi_nPollPeriodMs polling period (milliseconds)
  */</span>
  CWriteFileLock(LPCTSTR xi_cszFilePath,
                 <span class="code-keyword">bool</span> xi_bInitialLock = <span class="code-keyword">false</span>,
                 DWORD xi_nPollPeriodMs = <span class="code-digit">1000</span>) :
      CRWFileLock(<span class="code-keyword">false</span>, xi_cszFilePath, xi_bInitialLock, xi_nPollPeriodMs) {}
};
</pre>

<p>Where <code>CRWFileLock </code>is an actual implementation class.</p>

<div class="pre-lang" id="premain818239"><div>C++</div><div class="pre-action-link"><span id="copycode818239" class="copy-code" data-index="818239" style="visibility:hidden">Copy Code</span></div></div>
<pre id="pre818239" style="margin-top:0;" class="lang-cplusplus" data-language="C++" data-allowshrink="True" data-collapse="False"><span class="code-comment">/*</span><span class="code-comment">!
\brief A Read/Write File Lock implementation base class.
*/</span>
<span class="code-keyword">class</span> CRWFileLock
{
public:
  <span class="code-comment">// LIFECYCLE
</span>  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Constructor.
  \param[in] xi_bIsReadLock if it is a read lock
  \param[in] xi_cszFilePath a path to a file to be accessed
  \param[in] xi_bInitialLock if it is initially locked
  \param[in] xi_nPollPeriodMs polling period (milliseconds)
  */</span>
  CRWFileLock(<span class="code-keyword">bool</span> xi_bIsReadLock,
              LPCTSTR xi_cszFilePath,
              <span class="code-keyword">bool</span> xi_bInitialLock = <span class="code-keyword">false</span>,
              DWORD xi_nPollPeriodMs = <span class="code-digit">1000</span>);
  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Destructor.
  */</span>
  ~CRWFileLock();
  <span class="code-comment">// OPERATIONS
</span>  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Locks access to the file.
  */</span>
  <span class="code-keyword">void</span> Lock();
  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Unlocks access to the file.
  */</span>
  <span class="code-keyword">void</span> Unlock();
protected:
  <span class="code-comment">// DATA MEMBERS
</span>  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Readers/Writers lock file path.
  */</span>
  CString m_sReaderWriterLockFilePath;
  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Writers lock file path.
  */</span>
  CString m_sWriterLockFilePath;
  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Readers/Writers lock file.
  */</span>
  HANDLE m_hReaderWriterLockFile;
  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Writers lock file.
  */</span>
  HANDLE m_hWriterLockFile;
  <span class="code-comment">/*</span><span class="code-comment">!
  \brief If it is locked.
  */</span>
  <span class="code-keyword">bool</span> m_bIsLocked;
  <span class="code-comment">/*</span><span class="code-comment">!
  \brief If it is a read lock.
  */</span>
  <span class="code-keyword">bool</span> m_bIsReadLock;
  <span class="code-comment">/*</span><span class="code-comment">!
  \brief Polling period (milliseconds).
  */</span>
  DWORD m_nPollPeriodMs;
};
</pre>

<p>The constructor of <code>CRWFileLock </code>class accepts the following parameters:</p>

<ul>
<li><code>xi_bIsReadLock </code>- A type of the lock to be created (<code>true </code>for a read lock, <code>false </code>for a write lock) </li><li><code>xi_cszFilePath </code>- A path to a resource to be locked. This file is not necessary to exist because this path is just used to create paths for two lock files with extensions <em>.rlc</em> and <em>.wlc</em> which are added to the original path </li><li><code>xi_bInitialLock</code> - If the resource is initially attempted to be locked </li><li><code>xi_nPollPeriodMs </code>- Used for how much time to sleep when trying to access lock the files again </li></ul>

<p>The code of the constructor just initialises the class member variables and calls Lock operation if an initial lock is specified.</p>

<div class="pre-lang" id="premain670294"><div>C++</div><div class="pre-action-link"><span id="copycode670294" class="copy-code" data-index="670294" style="visibility:hidden">Copy Code</span></div></div>
<pre id="pre670294" style="margin-top:0;" class="lang-cplusplus" data-language="C++" data-allowshrink="True" data-collapse="False">NMt::CRWFileLock::CRWFileLock(<span class="code-keyword">bool</span> xi_bIsReadLock,
                              LPCTSTR xi_cszFilePath, 
                              <span class="code-keyword">bool</span> xi_bInitialLock<span class="code-comment">/*</span><span class="code-comment"> = false*/</span>, 
                              DWORD xi_nPollPeriodMs<span class="code-comment">/*</span><span class="code-comment"> = 1000*/</span>) :
  m_bIsReadLock(xi_bIsReadLock), m_bIsLocked(<span class="code-keyword">false</span>),
  m_hReaderWriterLockFile(<span class="code-digit">0</span>), m_hWriterLockFile(<span class="code-digit">0</span>), 
  m_nPollPeriodMs(xi_nPollPeriodMs)
{
  CString l_sFilePath = xi_cszFilePath;
  <span class="code-keyword">if</span> (!l_sFilePath.IsEmpty())
  {
    m_sReaderWriterLockFilePath = l_sFilePath + <span class="code-string">"</span><span class="code-string">.rlc"</span>;
    m_sWriterLockFilePath = l_sFilePath + <span class="code-string">"</span><span class="code-string">.wlc"</span>;
  }
  <span class="code-keyword">if</span> (xi_bInitialLock)
  {
    Lock();
  }
}</pre>

<p>The destructor just calls Unlock operation to allow automatic unlocking when exiting a scope. </p>

<div class="pre-lang" id="premain437295"><div>C++</div><div class="pre-action-link"><span id="copycode437295" class="copy-code" data-index="437295" style="visibility:hidden">Copy Code</span></div></div>
<pre id="pre437295" style="margin-top:0;" class="lang-cplusplus" data-language="C++" data-allowshrink="True" data-collapse="False">NMt::CRWFileLock::~CRWFileLock()
{
  Unlock();
} </pre>

<p>There are two operations common for lock classes: <code>Lock </code>and <code>Unlock</code>.</p>

<p>But the common code at the beginning that checks if the lock is already applied the lock operation differs for a read lock and a write lock.</p>

<div class="pre-lang" id="premain445593"><div>C++</div><div class="pre-action-link"><span id="copycode445593" class="copy-code" data-index="445593" style="visibility:hidden">Copy Code</span></div></div>
<pre id="pre445593" style="margin-top:0;" class="lang-cplusplus" data-language="C++" data-allowshrink="True" data-collapse="False"><span class="code-keyword">void</span>
NMt::CRWFileLock::Lock()
{
  <span class="code-keyword">if</span> (m_sReaderWriterLockFilePath.IsEmpty() || m_bIsLocked)
  {
    <span class="code-keyword">return</span>;
  }
  <span class="code-keyword">if</span> (m_bIsReadLock)
  {
    <span class="code-comment">// prevent writers from starvation
</span>    <span class="code-keyword">while</span> (<span class="code-keyword">true</span>)
    {
      <span class="code-comment">// try to open in shared mode
</span>      m_hWriterLockFile = ::CreateFile(m_sWriterLockFilePath, 
                                       GENERIC_READ, 
                                       FILE_SHARE_READ,
                                       NULL, <span class="code-comment">// default security
</span>                                       OPEN_ALWAYS,
                                       FILE_ATTRIBUTE_NORMAL,
                                       NULL);
      <span class="code-keyword">if</span> (INVALID_HANDLE_VALUE == m_hWriterLockFile)
      {
        DWORD l_nErr = ::GetLastError();
        <span class="code-keyword">if</span> (ERROR_SHARING_VIOLATION == l_nErr)
        {
          <span class="code-comment">// locked by writer, wait
</span>          Sleep(m_nPollPeriodMs);
          <span class="code-keyword">continue</span>;
        }
        DisplayMsg(<span class="code-string">"</span><span class="code-string">Cannot create a writer lock file %s: %d"</span>, m_sWriterLockFilePath, l_nErr);
        <span class="code-keyword">break</span>;
      }
      <span class="code-comment">// succeeded to open - no writers claimed access
</span>      <span class="code-comment">// close it to allow writers to open it
</span>      <span class="code-keyword">if</span> (<span class="code-digit">0</span> == ::CloseHandle(m_hWriterLockFile))
      {
        DisplayMsg(<span class="code-string">"</span><span class="code-string">Cannot close a writer lock file %s: %d"</span>, m_sWriterLockFilePath, ::GetLastError());
      }
      <span class="code-keyword">break</span>;
    }

    <span class="code-keyword">while</span> (<span class="code-keyword">true</span>)
    {
      <span class="code-comment">// lock writers, allow readers to share
</span>      m_hReaderWriterLockFile = ::CreateFile(m_sReaderWriterLockFilePath, 
                                             GENERIC_READ, 
                                             FILE_SHARE_READ,
                                             NULL, <span class="code-comment">// default security
</span>                                             OPEN_ALWAYS,
                                             FILE_ATTRIBUTE_NORMAL,
                                             NULL);
      <span class="code-keyword">if</span> (INVALID_HANDLE_VALUE == m_hReaderWriterLockFile)
      {
        DWORD l_nErr = ::GetLastError();
        <span class="code-keyword">if</span> (ERROR_SHARING_VIOLATION == l_nErr)
        {
          <span class="code-comment">// locked by writer, wait
</span>          Sleep(m_nPollPeriodMs);
          <span class="code-keyword">continue</span>;
        }
        DisplayMsg(<span class="code-string">"</span><span class="code-string">Cannot create a reader/writer lock file %s: %d"</span>, m_sReaderWriterLockFilePath, l_nErr);
        <span class="code-keyword">break</span>;
      }
      <span class="code-comment">// succeeded to lock
</span>      <span class="code-keyword">break</span>;
    }
  }
  <span class="code-keyword">else</span>
  {
    <span class="code-comment">// prevent readers from entering, writers open this file in exclusive mode
</span>    <span class="code-keyword">while</span> (<span class="code-keyword">true</span>)
    {
      m_hWriterLockFile = ::CreateFile(m_sWriterLockFilePath, 
                                       GENERIC_READ | GENERIC_WRITE, 
                                       <span class="code-digit">0</span>, <span class="code-comment">// exclusive
</span>                                       NULL, <span class="code-comment">// default security
</span>                                       OPEN_ALWAYS,
                                       FILE_ATTRIBUTE_NORMAL,
                                       NULL);
      <span class="code-keyword">if</span> (INVALID_HANDLE_VALUE == m_hWriterLockFile)
      {
        DWORD l_nErr = ::GetLastError();
        <span class="code-keyword">if</span> (ERROR_SHARING_VIOLATION == l_nErr)
        {
          <span class="code-comment">// locked by writers, wait
</span>          Sleep(m_nPollPeriodMs);
          <span class="code-keyword">continue</span>;
        }
        DisplayMsg(<span class="code-string">"</span><span class="code-string">Cannot create a writer lock file %s: %d"</span>, m_sWriterLockFilePath, l_nErr);
        <span class="code-keyword">break</span>;
      }
      <span class="code-comment">// succeeded to lock
</span>      <span class="code-keyword">break</span>;
    }

    <span class="code-comment">// lock readers/writers
</span>    <span class="code-keyword">while</span> (<span class="code-keyword">true</span>)
    {
      m_hReaderWriterLockFile = ::CreateFile(m_sReaderWriterLockFilePath, 
                                             GENERIC_READ | GENERIC_WRITE, 
                                             <span class="code-digit">0</span>, <span class="code-comment">// exclusive access
</span>                                             NULL, <span class="code-comment">// default security
</span>                                             OPEN_ALWAYS,
                                             FILE_ATTRIBUTE_NORMAL,
                                             NULL);
      <span class="code-keyword">if</span> (INVALID_HANDLE_VALUE == m_hReaderWriterLockFile)
      {
        DWORD l_nErr = ::GetLastError();
        <span class="code-keyword">if</span> (ERROR_SHARING_VIOLATION == l_nErr)
        {
          <span class="code-comment">// locked by readers/writers, wait
</span>          Sleep(m_nPollPeriodMs);
          <span class="code-keyword">continue</span>;
        }
        DisplayMsg(<span class="code-string">"</span><span class="code-string">Cannot create a reader/writer lock file %s: %d"</span>, m_sReaderWriterLockFilePath, l_nErr);
        <span class="code-keyword">break</span>;
      }
      <span class="code-comment">// succeeded to lock
</span>      <span class="code-keyword">break</span>;
    }

  }
  m_bIsLocked = <span class="code-keyword">true</span>;
}</pre><div>In the read lock, readers try to create/open the writer lock file in the shared mode. If this file is opened in the exclusive mode, readers wait for some polling period before trying to open this file again. If readers succeed to open this file, they immediately close it. This allows writers to open this file and prevents them from possible starvation. Then, readers proceed by creating/opening the common reader/writer lock file in the shared read mode. This allows multiple readers to access the resource simultaneously while preventing writers to enter because writers try to create/open this file in the exclusive mode. If a reader fails to open this file because of the sharing violation error that indicates that a writer opened this file in the exclusive mode, in this case the reader sleeps for some polling period and tries to open this file again.</div>

<p>On the opposite side, a writer tries first to create the writer lock file. If it fails because of the sharing violation error, it indicates that some other writer created this file, so the writer sleeps for some polling period and tries to create this file again. After successfully creating the writer lock file, the writer proceeds to creation/opening of the reader/writer lock file. It tries to create this file in the exclusive mode assuring that only a single writer can access the shared resource. If it fails because of the sharing violation error, it indicates that one/several readers or a single writer opened this file. In this case, the writer sleeps for some polling period and tries to open this file again.</p>

<p>Unlock operation just closes handles to the lock files allowing accessing these files from other threads/processes.</p>

<div class="pre-lang" id="premain48117"><div>C++</div><div class="pre-action-link"><span id="copycode48117" class="copy-code" data-index="48117" style="visibility:hidden">Copy Code</span></div></div>
<pre id="pre48117" style="margin-top:0;" class="lang-cplusplus" data-language="C++" data-allowshrink="True" data-collapse="False"><span class="code-keyword">void</span> 
NMt::CRWFileLock::Unlock()
{
  <span class="code-keyword">if</span> (m_sReaderWriterLockFilePath.IsEmpty() || !m_bIsLocked)
  {
    <span class="code-keyword">return</span>;
  }
  <span class="code-keyword">if</span> (!m_bIsReadLock) <span class="code-comment">// write lock
</span>  {
    <span class="code-comment">// release readers
</span>    <span class="code-keyword">if</span> (<span class="code-digit">0</span> == ::CloseHandle(m_hWriterLockFile))
    {
      DisplayMsg(<span class="code-string">"</span><span class="code-string">Cannot close a writer lock file %s: %d"</span>, 
        m_sWriterLockFilePath, ::GetLastError());
    }
  }
  <span class="code-comment">// release readers/writers
</span>  <span class="code-keyword">if</span> (<span class="code-digit">0</span> == ::CloseHandle(m_hReaderWriterLockFile))
  {
    DisplayMsg(<span class="code-string">"</span><span class="code-string">Cannot close a reader/writer lock file %s: %d"</span>, 
        m_sReaderWriterLockFilePath, ::GetLastError());
  }
  m_bIsLocked = <span class="code-keyword">false</span>;
}</pre>

<h2>History</h2>

<ul>
<li>12/31/2009: Initial version</li><li>04/01/2014: Fixed a bug to prevent readers from infinite locking if Windows OS crashes when a write lock was applied   </li></ul>


						</div>
						

						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						<h2>Share</h2>
				        <div class="share-list">
					        

    <ul class="rrssb-buttons clearfix">
        <li id="ctl00_SocialLike_Email" class="email compact">
            <a href="mailto:?subject=Inter%20Computer%20Read%2fWrite%20File%20Lock%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0aUsing%20File%20Management%20Windows%20API%20for%20implementing%20inter%20computer%20Read%2fWrite%20lock%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock%0a">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <g>
                            <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 &#10;                                c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 &#10;                                9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 &#10;                                0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 &#10;                                7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 &#10;                                0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 &#10;                                26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 &#10;                                1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"/>
                        </g>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Twitter" class="twitter compact">
            <a href="http://twitter.com/home?status=Inter+Computer+Read%2fWrite+File+Lock+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32&#10;                        c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155&#10;                        C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965&#10;                        C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683&#10;                        c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851&#10;                        C26.275,7.229,25.39,8.196,24.253,8.756z"/>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Facebook" class="facebook compact">
            
            <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434&#10;                            c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726&#10;                            c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"/>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_LinkedIn" class="linkedin compact">
            <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock&amp;title=Inter+Computer+Read%2fWrite+File+Lock+-+CodeProject&amp;summary=Using+File+Management+Windows+API+for+implementing+inter+computer+Read%2fWrite+lock&amp;source=codeproject.com" class="popup">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                        <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803&#10;                            c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048&#10;                            h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501&#10;                            c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546&#10;                            C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"/>
                    </svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Reddit" class="reddit compact">
            <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock&amp;title=Inter+Computer+Read%2fWrite+File+Lock+-+CodeProject">
                <span class="icon">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                    <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"/>
                    <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"/>
                    <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 &#10;                    c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 &#10;                    4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 &#10;                    19.5 17.8 19.5 17.5 19.791z"/><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 &#10;                    0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 &#10;                    2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 &#10;                    0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 &#10;                    2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 &#10;                    8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 &#10;                    3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 &#10;                    13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 &#10;                    13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 &#10;                    c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 &#10;                    0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 &#10;                    c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 &#10;                    C26.354 13.8 26.1 14.3 25.8 14.605z"/></g></svg>
                </span>
                
            </a>
        </li><li id="ctl00_SocialLike_Pinterest" class="pinterest compact">
            <a href="http://pinterest.com/pin/create/bookmarklet/?is_video=false&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock&amp;description=Inter+Computer+Read%2fWrite+File+Lock+-+CodeProject">
                <span class="icon">
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M14.021,1.57C6.96,1.57,1.236,7.293,1.236,14.355c0,7.062,5.724,12.785,12.785,12.785c7.061,0,12.785-5.725,12.785-12.785&#10;                        C26.807,7.294,21.082,1.57,14.021,1.57z M15.261,18.655c-1.161-0.09-1.649-0.666-2.559-1.219c-0.501,2.626-1.113,5.145-2.925,6.458&#10;                        c-0.559-3.971,0.822-6.951,1.462-10.116c-1.093-1.84,0.132-5.545,2.438-4.632c2.837,1.123-2.458,6.842,1.099,7.557&#10;                        c3.711,0.744,5.227-6.439,2.925-8.775c-3.325-3.374-9.678-0.077-8.897,4.754c0.19,1.178,1.408,1.538,0.489,3.168&#10;                        C7.165,15.378,6.53,13.7,6.611,11.462c0.131-3.662,3.291-6.227,6.46-6.582c4.007-0.448,7.771,1.474,8.29,5.239&#10;                        c0.579,4.255-1.816,8.865-6.102,8.533L15.261,18.655z"/>
                    </svg>
                </span>
                
            </a>
        </li>

    </ul>



				        </div> 
    			        
                        <h2 id="ctl00_AboutHeading">About the Author</h2>
						    

<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="https://codeproject.freetls.fastly.net/script/Membership/Images/member_unknown.gif" style="border-width:0px;transform:rotate(0deg);" />
    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="/Members/AndreBroz">AndreBroz</a></b>

        <table>
        <tbody><tr>
            <td rowspan="2" nowrap="" valign="middle">
            
            </td>
            <td nowrap="nowrap">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Software Developer</span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
            <td rowspan="2" style="padding-left:15px">
                
            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Israel <img src="/script/Geo/Images/IL.gif" alt="Israel" width="16" height="11" /></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        I am a professional C++/C# developer. In my free time I also develop for Windows Phone. Please see my applications at <a rel="nofollow noopener" href="http://www.windowsphone.com/en-US/store/publishers?publisherId=andrebroz">Windows Store</a>

        
    </div>

</div><br />
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Desktop-ProgrammingMFC" data-country="US" data-loadonview="true" data-tags="VC8.0, WinXP, Win2003, C++, Windows, Win32, MFC, Dev, Intermediate,rating4,pos_bottom"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-ProgrammingMFC&amp;sz=728x90&amp;c=513949"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-ProgrammingMFC&amp;sz=728x90&amp;c=513949"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
				</div>
				
                
                

				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">Â </a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1"><div class="callout">
	<b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock%3ffid%3d1555915%26df%3d90%26mpp%3d25%26sort%3dPosition%26view%3dNormal%26spc%3dRelaxed%26prof%3dTrue">Sign In</a> to use this message board.</b>
</div></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1555915" /><input type="hidden" name="sbo" value="fm" /><input id="search_forumCtrl_ctl00_MessageBoard" type="search" class="search" autocomplete="off" name="q" /><input type="image" src="https://codeproject.freetls.fastly.net/images/search.gif" />
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="/script/Forums/SetOptions.aspx?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1555915" /><input type="hidden" name="currentQS" value="fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;view=Normal&amp;spc=Relaxed&amp;prof=True&amp;floc=%2fArticles%2f49670%2fInter-Computer-Read-Write-File-Lock" /><input type="hidden" name="floc" value="/Articles/49670/Inter-Computer-Read-Write-File-Lock" />Spacing<select size="1" class="dropdown" name="spc">
<option selected="" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>Â Â Layout<select size="1" class="dropdown" name="view">
<option selected="" value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>Â Â Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="" value="25">25</option><option value="50">50</option>
</select>Â Â Â <input type="submit" value="Update" name="SetOpt" class="button" />
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background msg-list">
<tbody><tr id="F3603242_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx3603242xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3603242" parent="3601343" thread="3601343" href="/Messages/3603242/Re-Concurrent-writers">Re: Concurrent writers</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">AndreBroz</span><span class="date">19-Sep-10  4:26</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3363403">AndreBroz</a></span></td><td class="date"><span>19-Sep-10  4:26Â </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3603242_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="" href="/script/Forums/View.aspx?fid=1555915&amp;msg=3601343"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>Hi,<br />
Thank you for your message.<br />
As far as I understand CreateFile in Windows is an atomic operation. Therefore if two writers simultaneously try to create the .wlc file in exclusive mode only one of them will succeed. The other one will fail with sharing violation error. My lock is based on the atomicity of CreateFile operation. I do not know exactly but it may be not the case in Linux. As far as I understand you should use Linux specific lock api.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/49670/Inter-Computer-Read-Write-File-Lock">Sign In</a>Â·<wbr /><a href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3601343" title="ViewÂ Thread">ViewÂ Thread</a></td><td style="text-align:right;"><span data-objectref="3_3603242" name="react-item_3603242" id="MRF3603242" class="reaction-result"></span><span data-objectref="3_3603242" data-votingtype="GoodOrBad" name="RateItem_3603242" id="MVF3603242" class="rating-result"></span><a href="/Messages/3603242/Re-Concurrent-writers" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a>Â </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3604078_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="74px" class="indent"><a name="xx3604078xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3604078" parent="3603978" thread="3601343" href="/Messages/3604078/Re-Concurrent-writers">Re: Concurrent writers</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">AndreBroz</span><span class="date">20-Sep-10  5:41</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3363403">AndreBroz</a></span></td><td class="date"><span>20-Sep-10  5:41Â </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3604078_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="" href="/script/Forums/View.aspx?fid=1555915&amp;msg=3603978"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>I do not know how your application works to suggest you anything. As far as I understand you can replace CreateFile with the similar Linux API.<br />
<br />
I tested this class with Windows network shares. That should be SMB protocol. I never tested it with NFS.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/49670/Inter-Computer-Read-Write-File-Lock">Sign In</a>Â·<wbr /><a href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3601343" title="ViewÂ Thread">ViewÂ Thread</a></td><td style="text-align:right;"><span data-objectref="3_3604078" name="react-item_3604078" id="MRF3604078" class="reaction-result"></span><span data-objectref="3_3604078" data-votingtype="GoodOrBad" name="RateItem_3604078" id="MVF3604078" class="rating-result"></span><a href="/Messages/3604078/Re-Concurrent-writers" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a>Â </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3352538_h0" class="header hover-row root">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx3352538xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3352538" parent="0" thread="3352538" href="/Messages/3352538/just-for-help">just for help</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">sealplusplus</span><span class="date">1-Feb-10  19:08</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5625722">sealplusplus</a></span></td><td class="date"><span>1-Feb-10  19:08Â </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3352538_h1" class="content root selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">hello I am boy from Mian chian...<br />
I like the C/C++...<br />
as you konw the 1st language is no-Engilig. and some other reasons. I have a lot of thing to learning..<br />
<br />
just search, and get you articl about &lt; CString Management &gt;, so I just want to know how can I get the CString Class original code. I want konw the detail and read it will make me using CString very wall in my codeing...<br />
<br />
thanks a lot...<br />
<br />
yous coder<br />
<br />
<br />
sealplusplus<br />
<br />
2 February 2010<br />
<br />
Link: yxjseal@sohu.com waiting you write back....<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/49670/Inter-Computer-Read-Write-File-Lock">Sign In</a>Â·<wbr /><a href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3352538" title="ViewÂ Thread">ViewÂ Thread</a></td><td style="text-align:right;"><span data-objectref="3_3352538" name="react-item_3352538" id="MRF3352538" class="reaction-result"></span><span data-objectref="3_3352538" data-votingtype="GoodOrBad" name="RateItem_3352538" id="MVF3352538" class="rating-result"></span><a href="/Messages/3352538/just-for-help" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a>Â </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3352774_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx3352774xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3352774" parent="3352538" thread="3352538" href="/Messages/3352774/Re-just-for-help">Re: just for help</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">AndreBroz</span><span class="date">1-Feb-10  23:27</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3363403">AndreBroz</a></span></td><td class="date"><span>1-Feb-10  23:27Â </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3352774_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,3352538);" href="/Messages/3352538/just-for-help"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>Hi,<br />
<br />
Sorry I do not understand what you mean. My article is not about CString management. Anyway you can see CString source code if you have Visual Studio installed, you can look in Visual Studio installation folder for VC\atlmfc\include\cstringt.h, cstringt.inl<br />
<br />
Good luck<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/49670/Inter-Computer-Read-Write-File-Lock">Sign In</a>Â·<wbr /><a href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3352538" title="ViewÂ Thread">ViewÂ Thread</a></td><td style="text-align:right;"><span data-objectref="3_3352774" name="react-item_3352774" id="MRF3352774" class="reaction-result"></span><span data-objectref="3_3352774" data-votingtype="GoodOrBad" name="RateItem_3352774" id="MVF3352774" class="rating-result"></span><a href="/Messages/3352774/Re-just-for-help" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a>Â </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3353866_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx3353866xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3353866" parent="3352774" thread="3352538" href="/Messages/3353866/Re-just-for-help">Re: just for help</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">sealplusplus</span><span class="date">2-Feb-10  15:50</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5625722">sealplusplus</a></span></td><td class="date"><span>2-Feb-10  15:50Â </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3353866_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,3352774);" href="/Messages/3352774/Re-just-for-help"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>I am so sorry, yes I know this article is not aobut CSting management, for I search you CString management is few years ago, so I make sure you can get my Message, write here the last article. and thank you for you CString Mangement for someone transalte it into chinese.. and help more china C++ coder.<br />
<br />
My engilish is not good...<br />
<br />
All I want to say is, I want read those CString class functions...<br />
<br />
e.g:<br />
string::string( )<br />
{<br />
     //This is what I want read<br />
<br />
}<br />
<br />
string::string( const char *str = NULL )<br />
{<br />
<br />
}<br />
string::~string( )<br />
{<br />
<br />
<br />
}<br />
<br />
In my computer I get Visual Studio 2005 and search the cstringt.h, but no file find. <br />
thank you again for you help.<br />
<br />
<br />
yous coder<br />
<br />
<br />
sealplusplus.<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/49670/Inter-Computer-Read-Write-File-Lock">Sign In</a>Â·<wbr /><a href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3352538" title="ViewÂ Thread">ViewÂ Thread</a></td><td style="text-align:right;"><span data-objectref="3_3353866" name="react-item_3353866" id="MRF3353866" class="reaction-result"></span><span data-objectref="3_3353866" data-votingtype="GoodOrBad" name="RateItem_3353866" id="MVF3353866" class="rating-result"></span><a href="/Messages/3353866/Re-just-for-help" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a>Â </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3355703_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="74px" class="indent"><a name="xx3355703xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3355703" parent="3353866" thread="3352538" href="/Messages/3355703/Re-just-for-help">Re: just for help</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">AndreBroz</span><span class="date">3-Feb-10  23:22</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=3363403">AndreBroz</a></span></td><td class="date"><span>3-Feb-10  23:22Â </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3355703_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,3353866);" href="/Messages/3353866/Re-just-for-help"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>Sorry, I never wrote an article about CString management. <br />
<br />
It is strange you cannot find source files for CString. Try right click on CString in you project file and choose 'Go to Definition'. You will get to afxstr.h. Then do the same on CStringT. You will get to cstringt.h.<br />
<br />
Good luck<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/49670/Inter-Computer-Read-Write-File-Lock">Sign In</a>Â·<wbr /><a href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3352538" title="ViewÂ Thread">ViewÂ Thread</a></td><td style="text-align:right;"><span data-objectref="3_3355703" name="react-item_3355703" id="MRF3355703" class="reaction-result"></span><span data-objectref="3_3355703" data-votingtype="GoodOrBad" name="RateItem_3355703" id="MVF3355703" class="rating-result"></span><a href="/Messages/3355703/Re-just-for-help" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a>Â </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3356689_h0" class="header hover-row">
<td class="subject-line normal " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="92px" class="indent"><a name="xx3356689xx"></a><img height="16px" width="16px" align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" alt="General" title="General" /></td><td class="subject hover-container"><a class="message-link" name="3356689" parent="3355703" thread="3352538" href="/Messages/3356689/Re-just-for-help">Re: just for help</a> <a onclick="return forumCtrl_ctl00_MessageBoard.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.freetls.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px" /></a><div class="mobile-only">
	<span class="author">sealplusplus</span><span class="date">4-Feb-10  14:54</span>
</div></td><td class="icon"><img border="0" src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="Member" alt="Member" height="16px" /></td><td class="author"><span><a href="/script/Membership/View.aspx?mid=5625722">sealplusplus</a></span></td><td class="date"><span>4-Feb-10  14:54Â </span></td>
</tr>
</tbody></table></td>
</tr><tr id="F3356689_h1" class="content selected" style="display:none;">
<td class="normal" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumCtrl_ctl00_MessageBoard.SwitchMessage(null,3355703);" href="/Messages/3355703/Re-just-for-help"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0" /></a></div>Sorry, maybe I make mistake. I just search CString management, ant get you Name and you atricle...<br />
<br />
Wish you good luck, when I have time, I read you article..<br />
<br />
thank you...<br />
<br />
yous coder<br />
<br />
sealplusplus<br /></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/49670/Inter-Computer-Read-Write-File-Lock">Sign In</a>Â·<wbr /><a href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3352538" title="ViewÂ Thread">ViewÂ Thread</a></td><td style="text-align:right;"><span data-objectref="3_3356689" name="react-item_3356689" id="MRF3356689" class="reaction-result"></span><span data-objectref="3_3356689" data-votingtype="GoodOrBad" name="RateItem_3356689" id="MVF3356689" class="rating-result"></span><a href="/Messages/3356689/Re-just-for-help" title="Get permanent link" style="border:0 !important"><img src="https://codeproject.freetls.fastly.net/App_Themes/CodeProject/Img/link32.png" style="width:14px;height:14px;border:0" /></a>Â </td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99  18:00 Â  Â  Last Update: 31-May-22  18:30</span></td><td><a rel="nofollow" href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/49670/Inter-Computer-Read-Write-File-Lock?fid=1555915&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Normal&amp;fr=8" /><span class="nav-link selected">1</span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General" /> General Â Â  <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News" /> News Â Â  <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion" /> Suggestion Â Â  <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question" /> Question Â Â  <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug" /> Bug Â Â  <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer" /> Answer Â Â  <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke" /> Joke Â Â  <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_kudos.gif" width="16px" height="16px" alt="Praise" /> Praise Â Â  <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant" /> Rant Â Â  <img align="top" src="https://www.codeproject.com/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin" /> Admin Â Â  </p><p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p>
				

			</div>
			

            
            <div id="ctl00_RightSideBar" class="article-right-sidebar">

				

                <div id="ctl00_RHSticky" class="container-article-info-sticky padded-top sticky">

					<div class="padded-top" style="height:250px;width:300px">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="senseai" data-country="US" data-tags="VC8.0, WinXP, Win2003, C++, Windows, Win32, MFC, Dev, Intermediate,rating4"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/senseai&amp;sz=300x250&amp;c=513949"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/senseai&amp;sz=300x250&amp;c=513949"  width="300px" height="250px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
					</div>

        		    

<div class="article-summary">

    
    

</div>

				    

                    

				    

				    

					<div class="padded-top" style="height:250px;width:300px">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Desktop-ProgrammingMFC" data-country="US" data-loadonview="true" data-tags="VC8.0, WinXP, Win2003, C++, Windows, Win32, MFC, Dev, Intermediate,rating4"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-ProgrammingMFC&amp;sz=300x250&amp;c=513949"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Desktop-ProgrammingMFC&amp;sz=300x250&amp;c=513949"  width="300px" height="250px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
					</div>

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="/Articles/49670/Inter-Computer-Read-Write-File-Lock#_articleTop">Go to top</a>
                    </div>

			    </div>
            </div>
            

        </div>
        

		
		<div class="site-footer">
			<div class="align-left">
				<a id="ctl00_PermaLink" href="/Articles/49670/Inter-Computer-Read-Write-File-Lock">Permalink</a><br />
				<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a><br />
				<a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a><br />
    			<a id="ctl00_CookiePolicyLink" href="/info/cookie.aspx">Cookies</a><br />
                <a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Use</a><br />
			</div>

            <div class="align-center">
				


<div class="page-width">
    Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?PageFlow=FixedWidth">fixed</a>
    |
    <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="/Articles/49670/Inter-Computer-Read-Write-File-Lock?PageFlow=Fluid">fluid</a>
</div>


				

				

	            

                <br />
			</div>
                
			<div class="align-right">
				Article Copyright 2010 by AndreBroz<br />Everything else
				Copyright Â© <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2022 <br />
                <br />
				Web01 
				2.8.2022.05.26.1<br />
			</div>
		</div>
		

		<br clear="all" />
		
			

	</div> 
	</div> 
</div>



<img id="ctl00_Audience" src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord='637896402290357769';dc_seg=33705250?" style="border-width:0px;height:1px;width:1px;" />



<script type="text/javascript"> // IMMEDIATE script

function Join() {
                                     document.location.href = 'https://www.codeproject.com/script/Membership/Modify.aspx';
                                     return false;
                                  }

var diqzkgdipy = function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).on("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&amp;&amp;t.toLowerCase()==="true";i=typeof i=="string"&amp;&amp;i.toLowerCase()==="true";r=typeof r=="string"&amp;&amp;r.toLowerCase()==="true";r||c||t&amp;&amp;!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i &amp;&amp; i.html &amp;&amp; n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&amp;&amp;(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&amp;&amp;(document.body.clientWidth||document.body.clientHeight)&amp;&amp;(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&amp;&amp;(f+=n.height*-1);e=t.top&gt;=0&amp;&amp;t.top-200&lt;=r||t.top&lt;=0&amp;&amp;t.top&gt;=f;o=i&gt;t.left&amp;&amp;t.right&gt;=0;u=e&amp;&amp;o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&amp;&amp;n.style.position!=="fixed"&amp;&amp;n.offsetParent?t=!0:n&amp;&amp;n.style.position==="fixed"&amp;&amp;(i=window.getComputedStyle(n),t=i&amp;&amp;i.display!=="none"),t&amp;&amp;c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&amp;&amp;(n="webkitHidden"),n!==null&amp;&amp;document[n]&amp;&amp;(t=!1),t};return{init:e}};
document.addEventListener('DOMContentLoaded', function() {
var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new diqzkgdipy).init()}catch(i){(new diqzkgdipy).init()}};try{t='/a.min.js?v=1.3';n.open("GET",t,!0);n.send()}catch(i){(new diqzkgdipy).init()}

  $('div[data-type="ad"][data-showindicator="true"]').before('&lt;div class="small-text muted hidden"&gt;Advertisement&lt;/div&gt;');
  setTimeout(function(){ 
    $('div[data-type="ad"][data-showindicator="true"]').each(function( index ) {
      if ($(this).height() &gt; 0) {
       $(this).prev().removeClass('hidden');
      }
    });
  }, 2000);

});

var ratingCtrl_ctl00_RateArticle;

var forumConfig_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard;
var forumCtrl_ctl00_MessageBoard_forumMsgFlag;
var forumCtrl_ctl00_MessageBoard_rating;
var forumCtrl_ctl00_MessageBoard_ratingConfig;
var forumCtrl_ctl00_MessageBoard_reaction;
var forumCtrl_ctl00_MessageBoard__reactionConfig;

var subscriptionConfig_ctl00_MessageBoard = {
 ParentId      : 'ctl00_MessageBoard_SubscribeDiv',
 NewId         : 'ctl00_MessageBoard_SubscribeNew',
 ReplyId       : 'ctl00_MessageBoard_SubscribeReplies',
 InstantId     : 'ctl00_MessageBoard_SubscribeInstant',
 DailyId       : 'ctl00_MessageBoard_SubscribeDaily',
 MessageTypeId : 'ctl00_MessageBoard_MessageType',
 GetInfoUrl    : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/GetSubscriptions',
 UpdateInfoUrl : '/script/Forums/WebServices/ForumSubscriptionServices.aspx/UpdateSubscription',
 ForumId       : 1555915,
};
var subscriptions_ctl00_MessageBoard;

var xwzizxv = false;
var DMReportsOK = null;
function showDMAlert() { 
  var $div = $('div.msg-728x90');
  $div.append($('&lt;img src="/images/alert-top-block.gif" style="right:0;position:absolute;z-index:0"&gt;'));
}
function onDMcallBack(event)
{
   if (event.originalEvent) event = event.originalEvent;
   jQuery.support.cors = true;
   if (event.data === 'DM-disabled') DMReportsOK = false;
   else if (event.data=='DM-enabled') DMReportsOK = true;
   else if (typeof event.data == 'object' &amp;&amp; event.data.sender &amp;&amp;             event.data.sender == 'DeveloperMedia' &amp;&amp; event.data.application=='apps' &amp;&amp;
            event.data.action == 'reportEnabled') {
            DMReportsOK = event.data.data.enabled;
   }
   lfmxdupugk = !DMReportsOK;
}
function checkLoaded() { 
 var showBlockMsg = false;
 var block        = 'None';
 if (block === 'None' &amp;&amp; typeof DMAds === 'undefined')
     block = 'ResourceBlocked';
 if (block === 'None' &amp;&amp; !document.getElementById('adbp-tester'))     block = 'ResourceBlocked';
 if (block === 'None' &amp;&amp; DMReportsOK === false)     block = 'DomModified';
 lfmxdupugk = block != 'None';
 if (xwzizxv) {
  $.ajax({ url:'/script/Content/Ajax/VS.aspx',    data:{'cadm':block},     cache:false, async:true });
};
 if (showBlockMsg &amp;&amp; block != 'None')
    showDMAlert();
}
</script>

<script type="text/javascript"> // DEFERRED script

document.addEventListener('DOMContentLoaded', function() {

	new CodeBlocks().initialise('#contentdiv');
	
	$('.author-wrapper .description').shorten({showChars: 400});
	
	anchorAnimate();
	
	$('#__EVENTVALIDATION').attr('autocomplete', 'off');
	
	$('#joinBtn').css('visibility', 'visible');
	
	$('.oauth').click(function () {
	    $this = $(this);
	    href = $this.attr('href');
	    var myWindow = window.open(href, 'popup',
	                              'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
	    myWindow.focus();
	    var timer = setInterval(function () {
	        if (myWindow.closed) {
	            clearInterval(timer);
	            // window.location.reload(); // May do a POST reload, shows a warning
	            window.location = window.location; // force a GET reload
	        }
	    }, 200);
	    return false;
	});
	
	var oSrchFlt = false, oSrchBox=false, srchBoxFoc=false;
	var sbar     = $('#sb_tb');
	var sfilter  = $('#SearchFilter');
	
	if (typeof(InitWatermark) !== 'undefined')
	  InitWatermark('sb_tb', 'Search for articles, questions, tips');
	if (sbar &amp;&amp; sfilter) {
	  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
	  sbar.blur(function() {
	    if (!oSrchFlt) { sfilter.hide(); sfilter.removeClass('open'); }
	    srchBoxFoc = false;
	  });
	  sbar.focus(function() {
	    oSrchFlt   = false;
	    srchBoxFoc = true;
	    sfilter.show();
	    sfilter.addClass('open');
	  });
	  sbar.mouseleave(function()    { oSrchBox = false; });
	  sbar.mouseover(function()     { oSrchBox = true; });
	  sfilter.mouseleave(function() {
	    oSrchFlt=false;
	    if (!srchBoxFoc &amp;&amp; !oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }
	  });
	  sfilter.mouseover(function()  { oSrchFlt = true; });
	}
	
	var ratingConfig_ctl00_RateArticle = {
	  objectRef:          '2_49670_17',
	  objectSubtypeId:    1,
	  objectTypeName:     'article',
	  ownerId:            3363403,
	  votingType:         'None',
	  ratingDisplayMode:  'LargeStars',
	  resultDisplayMode:  'LargeStars',
	  ratingCallback:     null,
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  baseDir:            '/script/Ratings/',
	  ratingUrl:          'ajax/RateItem.aspx',
	  histogramUrl:       'ajax/Histogram.aspx',
	  getRatingUrl:       'ajax/GetRatings.aspx',
	  width:              130,
	  forceComment:       false,
	  lowVoteThreshold:   0,
	  minRating:          1,
	  maxRating:          5
	};
	ratingCtrl_ctl00_RateArticle = new RatingControl('#ctl00_RateArticle_RatingTable',ratingConfig_ctl00_RateArticle);
	
	forumConfig_ctl00_MessageBoard_ratingConfig = {
	  objectTypeId:       3,
	  objectTypeName:     'message',
	  bulkResultSelector: '#_MessageBoardctl00_MessageBoard',
	  votingType:         'GoodOrBad',
	  staticServer:       'https://codeproject.freetls.fastly.net',
	  forceComment:       false,
	  ratingDisplayMode:  'TextOnly',
	  resultDisplayMode:  'TextOnly'
	};
	forumCtrl_ctl00_MessageBoard_rating = new RatingControl('#_MessageBoardctl00_MessageBoard .content', forumConfig_ctl00_MessageBoard_ratingConfig);
	forumConfig_ctl00_MessageBoard = {
	    objectName          : 'forumCtrl_ctl00_MessageBoard',
	    messageTypeId       : 3,
	    searchPrompt        : 'Search Comments',
	    smoothScroll        : true,
	    allowReporting      : false,
	    allowRating         : false,
	    allowRatingDisplay  : true,
	    allowReactions      : false,
	    forumDir            : '/script/Forums/',
	    staticServer        : 'https://codeproject.freetls.fastly.net',
	    switchMsgCallback   : null,
	    ratingControl       : forumCtrl_ctl00_MessageBoard_rating,
	    reactionControl     : null,
	    codeblockProcessor  : new CodeBlocks(),
	    getReportFormMethod : getReportFormHtml,
	    voteHiThreshold     : 5 - 0.5,
	    reportOptions       : [
	       { reportTypeId : 19, name : 'Abusive / Trolling'},
	       { reportTypeId : 20, name : 'Inappropriate'},
	       { reportTypeId : 5, name : 'Spam'},
	    ],
	};
	forumCtrl_ctl00_MessageBoard = new ForumControl('#ForumTable',forumConfig_ctl00_MessageBoard, -1);
	forumCtrl_ctl00_MessageBoard_rating.setConfig('ratingCallback', forumCtrl_ctl00_MessageBoard.showMessageRating);
	forumCtrl_ctl00_MessageBoard.Initialise();
	
	subscriptions_ctl00_MessageBoard = new Subscriptions(subscriptionConfig_ctl00_MessageBoard);
	subscriptions_ctl00_MessageBoard.initialise();
	
	cookieconsent.initialise({
	                                    enabled : true,
	                                    cookie  : { domain: 'codeproject.com' },
	                                    palette : {
	                                        popup: { background: '#ff9900' },
	                                        button: { background: '#f5d948' }
	                                    },
	                                    law :  {
	                                        showForAllRegions : true, 
	                                        countryCode : 'US' 
	                                    },
	                                    theme: 'edgeless',
	                                    type : 'opt-in-out',
	                                    content: {
	                                        message: 'Like every other website we use cookies. By using our site you acknowledge that you have read and understand our &lt;a href=\'/info/cookie.aspx\'&gt;Cookie Policy&lt;/a&gt;, &lt;a href=\'/info/privacy.aspx\'&gt;Privacy Policy&lt;/a&gt;, and our &lt;a href=\'/info/TermsOfUse.aspx\'&gt;Terms of Service&lt;/a&gt;.',
	                                        href:    'https://www.codeproject.com/info/privacy.aspx',
	                                        dismiss: 'Ask me later'
	                                    },
	                                    revokable:true,
	                                    onStatusChange: function(status) {
	                                        $.ajax({
	                                		    dataType  : 'json',
	                                            data: JSON.stringify({ allowCookies : this.hasConsented() }),
	                                            url: '/script/membership/webservices/LoggedOnMemberservices.aspx/SetCookieConsent',
	                                            cache: false,
	                                            type: 'POST',
	                                            contentType: 'application/json'
	                                        })
	                                        console.log(this.hasConsented() ? 'enable cookies' : 'disable cookies');
	                                        console.log(this.hasAnswered() ? 'has answered' : 'did not answer');
	                                    },
	                                });
	
	$(window).on('message', onDMcallBack);
	setTimeout(checkLoaded, 4000);

})
</script>










<div id="adbp-tester">an advertisement</div><script type="text/javascript">if(typeof DMAds=="undefined"){var SendDmAdUid=!1,SendSearchTermsToServer=!0,CodeProjectPublisherId="lqm.codeproject.site",EnableMutableAds=!0,EnableViewOnScroll=!0,adServer=adServer||window.location.protocol+"//ads.DeveloperMedia.com/",SearchTermUrl="https://apps.developermedia.com/Ads/PageTerms/GetTerms",AdClickUrl="https://apps.developermedia.com/Ads/PageTerms/LogClick",DownvoteUrl="https://apps.developermedia.com/Ads/AdVote/DownvoteByFingerprint",UndoDownvoteUrl="https://apps.developermedia.com/Ads/AdVote/UndoDownvote",ReportAdUrl="https://apps.developermedia.com/Ads/AdVote/ReportAd",GlobalIdUrl="https://apps.developermedia.com/Ads/GlobalUserIdentification/",CloseAdImageUrl="https://cdn1.developermedia.com/Content/images/undo.png",UndoCloseAdImageUrl="https://cdn1.developermedia.com/Content/images/redo.png",DmLogoImageUrl="https://cdn1.developermedia.com/Content/images/dm-logo-150x23.png";String.prototype.includes||(String.prototype.includes=function(n,t){"use strict";return(typeof t!="number"&amp;&amp;(t=0),t+n.length&gt;this.length)?!1:this.indexOf(n,t)!==-1});var DMAdXHelper=function(){var n=[],t={},s=!1,r=!1,v=0,f=null,y=function(n){try{var i=p(n),t=w(n),r=b(n);t.insertBefore(r,t.children[0]);n.closeAdButton=i;n.reportAdDiv=t;n.adContainer.appendChild(i);n.adContainer.parentNode.appendChild(t);n.reportButton=t.getElementsByClassName("reportButton")[0];n.reportButton.disabled=!0;n.reportButton.onclick=function(){return l(n),!1}}catch(u){console.log(u)}},p=function(n){var i=document.createElement("input");return i.type="image",i.src=t.CloseAdImageUrl,i.title="Report Ad",i.align="left",i.style.cssText="z-index:1000; position:relative; left:0px; top:-"+n.height+"px; margin-top: 0px; margin-left: 0px; display:block; font-size:0px; border: 0px; padding: 0px; height:14px; width:14px",i.onclick=n.width===125&amp;&amp;n.height===125?function(){return c(n),l(n),!1}:function(){return c(n),!1},i},w=function(n){var t=n.width,i=n.height,r=document.createElement("div"),u="&lt;select class='reportReason' style='max-width:150px !important; padding: 0px !important'&gt;&lt;option&gt;Offensive&lt;\/option&gt;&lt;option&gt;Abusive&lt;\/option&gt;&lt;option&gt;Off topic&lt;\/option&gt;&lt;option&gt;Don't like the Ad&lt;\/option &gt; &lt;option&gt;Wrong language&lt;\/option&gt;&lt;\/select &gt; ",f="&lt;input type='button' disabled class='reportButton' style='padding: 0px !important' value='Report'&gt;&lt;\/input&gt;";return t===728&amp;&amp;i===90?k(r,u,f):t===300&amp;&amp;i===250?d(r,u,f):t===160&amp;&amp;i===600?g(r,u,f):t===125&amp;&amp;i===125&amp;&amp;nt(r),(t===728&amp;&amp;i===90||t===300&amp;&amp;i===250||t===160&amp;&amp;i===600)&amp;&amp;tt(n,r),r},b=function(n){var i=document.createElement("input");return i.type="image",i.src=t.UndoCloseAdImageUrl,i.title="Show Ad",i.style.cssText="z-index:1000; position:relative; left:0px; top:0px; width:14px; height:14px;margin-top: 0px; margin-left: 0px; font-size:0px; display:block; padding: 0px; border: 0px",i.onclick=function(){return h(n),!1},i},k=function(n,i,r){n.innerHTML="&lt;div class='sendReportContainer' style='padding-left: 2px; display:block; line-height:initial !important'&gt;&lt;div style='display:inline-block; font:14px/18px \"Segoe UI\", Arial'&gt;&lt;b&gt;Don't like this Ad?&lt;\/b&gt;&lt;\/div&gt;&lt;div class='dropzone' contenteditable='true' style='margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal'&gt;1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here&lt;\/div&gt;&lt;div style='margin-left:10px; display:inline-block; font:14px/18px \"Segoe UI\", Arial;'&gt; "+i+"&amp;nbsp;"+r+"&lt;\/div&gt;&lt;\/div&gt;&lt;div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'&gt;&lt;span style='color:#999'&gt;Thank you for the report!&lt;\/span&gt;&lt;\/div&gt;&lt;a href='http://www.developermedia.com/' target='_blank'&gt;&lt;img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:10px; top:10px;'&gt;&lt;\/a&gt;";n.style.cssText="display:none; width:728px; height:90px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},d=function(n,i,r){n.innerHTML="&lt;div class='sendReportContainer' style='padding: 5px 5px; display:block; line-height:initial !important'&gt;&lt;div style='padding-bottom:5px; font:14px/18px \"Segoe UI\", Arial;'&gt;&lt;b&gt;Don't like this Ad?&lt;\/b&gt;&lt;\/div&gt;&lt;div class='dropzone' contenteditable='true' style='height:100px; width: 290px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'&gt;1. Hit the refresh icon to show the ad again so you can take a screenshot &lt;br/&gt;2. Drag and Drop or paste the screenshot here&lt;\/div&gt;&lt;div style='margin-top:5px; font:14px/18px \"Segoe UI\", Arial; '&gt; "+i+"&lt;\/div&gt;&lt;div style='margin-top:5px; display:block; font:14px/18px \"Segoe UI\", Arial;'&gt;"+r+"&lt;\/div&gt;&lt;\/div&gt;&lt;div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial; '&gt;&lt;span style='color:#999;'&gt;Thank you for the report!&lt;\/span&gt;&lt;\/div&gt;&lt;a href='http://www.developermedia.com/' target='_blank'&gt;&lt;img src='"+t.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:20px; bottom:10px;'&gt;&lt;\/a&gt;";n.style.cssText="display:none; width:300px; height:250px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},g=function(n,i,r){n.innerHTML="&lt;div class='sendReportContainer' style='padding: 20px 15px; display:block; line-height:initial !important'&gt;&lt;div style='padding-bottom:20px; display:block; font:14px/18px \"Segoe UI\", Arial;'&gt;&lt;b&gt;Don't like this Ad?&lt;\/b&gt;&lt;\/div&gt;&lt;div class='dropzone' contenteditable='true' style='height:180px; width: 130px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'&gt;1. Hit the refresh icon to show the ad again so you can take a screenshot &lt;br/&gt;&lt;br/&gt;2. Drag and Drop or paste the screenshot here&lt;\/div&gt;&lt;div style='padding-bottom:10px; padding-top: 10px display:block; font:14px/18px \"Segoe UI\", Arial;'&gt; "+i+"&lt;\/div&gt;&lt;div style='font:14px/18px \"Segoe UI\", Arial;'&gt;"+r+"&lt;\/div&gt;&lt;\/div&gt;&lt;div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'&gt;&lt;span style='color:#999;'&gt;Thank you for the report!&lt;\/span&gt;&lt;\/div&gt;&lt;a href='http://www.developermedia.com/' target='_blank'&gt;&lt;img src='"+t.DmLogoImageUrl+"' style='max-width:120px;position:absolute; right:20px; bottom:20px;'&gt;&lt;\/a&gt;";n.style.cssText="display:none; width:160px; height:600px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},nt=function(n){n.innerHTML="&lt;div class='reportSentContainer' style='padding: 5px 5px;font:14px/18px \"Segoe UI\", Arial; width: 100px; height: 100px'&gt;&lt;span style='color:#999;'&gt;Thank you for the report!&lt;\/span&gt;&lt;\/div&gt;";n.style.cssText="display:none; width:125px; height:125px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},tt=function(n,t){if(n&amp;&amp;n.adContainer){var i=t.getElementsByClassName("dropzone")[0];i.dropzoneFor=n.adContainer.id;n.dropzone=i;s&amp;&amp;(i.ondragenter=function(n){n.currentTarget.style.backgroundColor="yellow";n.currentTarget.innerHTML="&lt;br/&gt;&lt;br/&gt;Drag and Drop the ad here"},i.ondragleave=function(n){n.currentTarget.style.backgroundColor="lightgray";u(n.currentTarget.dropzoneFor)},i.ondragover=function(n){n.stopPropagation();n.preventDefault();n.currentTarget.style.backgroundColor="yellow"},i.ondrop=function(n){n.currentTarget.style.backgroundColor="lightgreen";rt(n)});r?f?f.observe(i,{childList:!0}):i.addEventListener("DOMSubtreeModified",function(){a(i)}):i.addEventListener("paste",it,!1)}},h=function(n){n.reportAdDiv.style.display==="none"?(n.reportAdDiv.style.display="table",n.closeAdButton.style.display="none",n.adContainer.style.display="none",n.dropzone.focus()):(n.reportAdDiv.style.display="none",n.closeAdButton.style.display="block",n.adContainer.style.display="block")},e=function(n){var t=i(n),r=t.dropzone;r.style.backgroundColor="lightgreen";r.innerHTML=t.width===160&amp;&amp;t.height===600?"&lt;br/&gt; Your screenshot has been received â thanks! &lt;br/&gt;&lt;br/&gt; Next step: Whatâs wrong with the ad":t.width===300&amp;&amp;t.height===250?"&lt;br/&gt; Your screenshot has been received â thanks! &lt;br/&gt;&lt;br/&gt; Next step: Whatâs wrong with the ad":t.width===728&amp;&amp;t.height===90?"Your screenshot has been received â thanks! Next step: Whatâs wrong with the ad":"Ad info received. Press Report to submit"},o=function(n){var t=i(n);t&amp;&amp;(t.reportButton.disabled=!1)},u=function(n){var t=i(n);t&amp;&amp;(t.reportButton.disabled=!0)},c=function(n){h(n)},l=function(n){var r=n.reportAdDiv.getElementsByClassName("reportReason")[0],s=r&amp;&amp;r.options[r.selectedIndex].value||"Unspecified",u=n.reportAdDiv.getElementsByClassName("sendReportContainer")[0],f=n.reportAdDiv.getElementsByClassName("reportSentContainer")[0];u&amp;&amp;(u.style.display="none");f&amp;&amp;(f.style.display="block");try{var e=new XMLHttpRequest,i=new FormData,h=DMUserIdentityHelper&amp;&amp;DMUserIdentityHelper.getGlobalUserId()||0,o=null;n.fileList&amp;&amp;n.fileList.length&gt;0&amp;&amp;(o=n.fileList[0]);e.open("POST",t.DownvoteUrl,!0);i.append("adScreenshot",o);i.append("reason",s);i.append("DmGlobalUserId",h);e.send(i)}catch(c){console.log(c)}},it=function(n){var t,h,l,s,c,a,f,v;if(!r){if(n.preventDefault(),t=[],h=!1,window.clipboardData)t=window.clipboardData.files,h=!0;else if((n.clipboardData||n.originalEvent.clipboardData)&amp;&amp;(l=n.clipboardData||n.originalEvent.clipboardData,s=l&amp;&amp;l.items||[],t=[],s&amp;&amp;s.length&gt;0))for(h=!0,c=0;c&lt;s.length;c++)a=s[c],a.kind==="file"&amp;&amp;(t[t.length]=a.getAsFile());f=n.currentTarget.dropzoneFor;t&amp;&amp;t.length&gt;0?(v=i(f),v&amp;&amp;(v.fileList=t),o(f),e(f)):h?(n.currentTarget.innerHTML="&lt;br/&gt;&lt;br/&gt; No files found on clipboard &lt;br/&gt;",u(f)):(n.currentTarget.innerHTML="&lt;br/&gt;&lt;br/&gt; Paste not supported on your browser &lt;br/&gt;",u(f))}},rt=function(n){var f,r,t;if(n.stopPropagation(),n.preventDefault(),f=i(n.currentTarget.dropzoneFor),r=[],n.dataTransfer.files&amp;&amp;n.dataTransfer.files.length&gt;0)for(t=0;t&lt;n.dataTransfer.files.length;t++)n.dataTransfer.files[t].type&amp;&amp;n.dataTransfer.files[t].type.indexOf("image")&gt;=0&amp;&amp;(r[r.length]=n.dataTransfer.files[t]);r.length&gt;0?(f&amp;&amp;(f.fileList=r),e(n.currentTarget.dropzoneFor),o(n.currentTarget.dropzoneFor)):(n.currentTarget.style.backgroundColor="yellow",n.currentTarget.innerHTML="&lt;br/&gt;&lt;br/&gt;The dropped item was not an image",u(n.currentTarget.dropzoneFor))},a=function(n){for(var t,i=0;i&lt;n.children.length;i++)t=n.children[i],t.nodeName.toLowerCase()==="img"&amp;&amp;t.style.display!=="none"&amp;&amp;t.src&amp;&amp;(t.style.display="none",ut(t.src,n))},ut=function(n,t){if(n){var f=n.indexOf(","),r=n.substring(0,f),h=r.indexOf(":"),c=r.indexOf(";"),l=r.substring(h+1,c),a=n.substring(f+1),v=ot(a,l,512),u=t.dropzoneFor,s=i(u);s&amp;&amp;(s.fileList=[v]);e(u);o(u)}},ft=function(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&amp;&amp;"ondrop"in n},et=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")&gt;-1},i=function(t){for(var i=0,r=n.length;i&lt;r;i++)if(n[i]&amp;&amp;n[i].adContainer&amp;&amp;n[i].adContainer.id===t)return n[i];return null},ot=function(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r&lt;e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u&lt;f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})};return{appendAd:function(t){n.push(t)},init:function(i,u){n=i;t=u;s=ft();r=et();r&amp;&amp;window.MutationObserver&amp;&amp;(f=new MutationObserver(function(n){n.forEach(function(n){a(n.target)})}))},showAdReportingInterface:function(n){var t=i(n);t&amp;&amp;y(t)},setGlobalUserId:function(n){v=n}}}(),DMUserIdentityHelper=function(){var r,t,u="dmaduid",f="dmaduid_confirm",e,o,i=[],n=0,l=function(){return SendDmAdUid?navigator.cookieEnabled!==void 0?navigator.cookieEnabled:(document.cookie="testcookie=test; max-age=10000",document.cookie.indexOf("testcookie=test")&gt;=0):!1},a=function(){var t=document.location.hostname,n=/([^.]+\.[^.]{3,})$/i.exec(t);return n?n[1]:(n=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(t),n!==null?n[1]:t)},s=function(n,t,i,r,u,f){var e="",o;e=n+"="+t;i&gt;0&amp;&amp;(o=new Date,o.setTime(o.getTime()+i*864e5))&amp;&amp;(e+="; expires="+o.toGMTString());r&amp;&amp;(e+="; path="+r);u&amp;&amp;u.indexOf(".")!==-1&amp;&amp;(e+="; domain="+u);f&amp;&amp;(e+="; secure");document.cookie=e},h=function(n){var r=document.cookie,u=null,t,i;if(r!=="")for(t=r.split(";"),index=0;index&lt;t.length;index++)if(i=t[index].replace(/^\s+/,""),i.substring(0,n.length+1)===n+"="){u=i.substring(n.length+1);break}return u},v=function(n){var t=document.createElement("IFRAME");return t.width=1,t.height=1,t.src=e,t.id="DMGlobalUserIdetifierIFRAME",t.name="DMGlobalUserIdetifierIFRAME",t.style.display="none",document.body.appendChild(t),t.onload=n,t},y=function(){var i,l,n,a,e;if(r)if(i=h(u),l=h(f),!l&amp;&amp;JSON){if(n={},n.sender=location.href,n.Id=Math.random(),a=function(){o.contentWindow.postMessage(JSON.stringify(n),GlobalIdUrl)},e=function(i){var r=null,e;try{r=JSON.parse(i.data)}catch(o){}r&amp;&amp;r.Id&amp;&amp;r.Id===n.Id&amp;&amp;(e=r.DmGlobalUserId,s(u,e,365,"/",t,!1),s(f,r.DmGlobalUserConfirmResponse,365,"/",t,!1),c(e))},window.addEventListener)window.addEventListener("message",e,!1);else try{window.attachEvent("message",e)}catch(y){}o=v(a)}else i&amp;&amp;c(i)},c=function(t){for(n=t;i.length&gt;0;){var r=i.pop();typeof r=="function"&amp;&amp;r()}};return{init:function(n){e=n;r=l();t=a();y()},getGlobalUserId:function(t){return n!==0?n:t?(i.push(t),n):void 0}}}(),DMAds={PageQueryTerms:"",PageTags:null,Tile:1,CurrentDocument:null,PublisherCode:"",PublisherPageViewID:0,PublisherPageViewGuid:null,CreateAdsCalled:!1,GetTermsCalled:!1,Ads:[],GPTRenderingMode:"loading",PIIViolatingUrls:["http://www.aspsnippets.com/handlers/comments.ashx","codeproject.com/script/membership/sendpassword.aspx","http://www.dailyfreecode.com/userlogin.aspx","codeproject.com/script/membership/modify.aspx","dotnetspider.com/account/login.aspx","codeproject.com/script/membership/logon.aspx"],SetQueryTerms:function(){function u(n){for(var i,u="",t=0;t&lt;r.length;t++)if(i=r[t],n.indexOf(i.d)&gt;=0){u=i.q;break}return u}function f(n,t){var r=t.toLowerCase().indexOf(n),u,i;return r&lt;0||r+n.length&gt;=t.length?"":(u=t.indexOf("&amp;",r),u&lt;0&amp;&amp;(u=t.length),i=t.substring(r+n.length,u),i=i.replace(/\+/gi," "),i=decodeURIComponent(i),i.replace(/\"/gi,""))}function e(n){if(n===undefined)return"";var t=n.replace(/^\s+|\s+$/gi,"");return t?(t=t.replace(/\bAND\b|\bNOT\b|^NOT\b|\bOR\b|[^A-Z0-9\+\-\#\._\s]+|\b[A-Z0-9]+:/gi," "),t.replace(/\s+/g," ")):""}var r=[{d:"www.google.",q:"q="},{d:"www.bing.com",q:"q="},{d:"search.live.com",q:"q="},{d:"search.yahoo.com",q:"p="},{d:"codeproject.com",q:"q="},{d:"msdn.microsoft.com",q:"query="},{d:"www.ask.com",q:"q="},{d:"yandex.com",q:"text="},{d:"yandex.ru",q:"text="},{d:"www.baidu.com",q:"wd="},{d:"localhost",q:"q="},{d:"mkyong.com",q:"q="},{d:"codeplex.com",q:"query="},{d:"aspsnippets.com",q:"q="},{d:"trirand.com",q:"s="}],i="",n=document.URL,t=u(n);if(t!==""&amp;&amp;(i=e(f(t,n))),i===""){if(n=document.referrer.toLocaleLowerCase(),!n)return"";t=u(n);t!==""&amp;&amp;(i=e(f(t,n)))}DMAds.PageQueryTerms=i},SetPageTagsAndPixels:function(n){var t,i,r,u;if(JSON){if(DMAds.GetTermsCalled){n&amp;&amp;n();return}DMAds.GetTermsCalled=!0;t=document.URL;t.indexOf("?")&gt;0&amp;&amp;(t=t.substring(0,t.indexOf("?")));try{i=top.document.title}catch(f){i="FAILED TO GET DOCUMENT TITLE"}r={terms:DMAds.PageQueryTerms,title:i,url:t,publisher:DMAds.PublisherCode,DmGlobalUserId:DMUserIdentityHelper&amp;&amp;DMUserIdentityHelper.getGlobalUserId()||0,numberOfAdsOnPage:DMAds.Ads.length};u=function(t){if(t){var i;try{i=JSON.parse(t)}catch(r){}i&amp;&amp;(i.SearchTerms&amp;&amp;(DMAds.PageTags=i.SearchTerms),i.PublisherPageViewGuid&amp;&amp;(DMAds.PublisherPageViewGuid=i.PublisherPageViewGuid),i.aid&amp;&amp;i.aid.length&amp;&amp;i.aid.length&gt;0&amp;&amp;DMAds.InsertAudiencePixels(i.aid))}DMAds.PublisherPageViewGuid||(DMAds.PublisherPageViewGuid=1);n&amp;&amp;n()};DMAds.POSTJson(SearchTermUrl,r,u,!0,500)}},InsertAudiencePixels:function(n){var t,i;try{for(t=0,i=n.length;t&lt;i;t++){var r=Math.random()+"",u=r*1e13,f=new Image;f.src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord="+u+";dc_seg="+n[t]+"?"}}catch(e){}},GetRandom:function(n,t){for(var u,i="",r=0;r&lt;n;r++)u=Math.floor(Math.random()*t).toString(t).toUpperCase(),i=i+u;return i},POSTJson:function(n,t,i,r,u){var f;if(JSON&amp;&amp;(f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),f)){var s=!1,o=function(n){s||(s=!0,i&amp;&amp;i(n))},e=null;r&amp;&amp;(e=setTimeout(function(){try{f.abort()}catch(n){}o(null)},u));f.onreadystatechange=function(){try{f.readyState===4&amp;&amp;(e&amp;&amp;clearTimeout(e),f.status===200?o(f.responseText):o(null))}catch(n){e&amp;&amp;clearTimeout(e);o(null)}};try{f.open("POST",n,!0);f.setRequestHeader("Content-Type","application/json");f.send(JSON.stringify(t))}catch(h){e&amp;&amp;clearTimeout(e);o(null)}}},SignalSuccess:function(n){window.top&amp;&amp;window.top.postMessage&amp;&amp;setTimeout(function(){window.top.postMessage(n?"DM-enabled":"DM-disabled","*")},1e3)},CreateAds:function(n){this.PageRandomNumber=DMAds.GetRandom(32,16);var e=function(n){var t=DMAds.Ads[n];t.rendered=!0;DMAds.GPTRenderingMode==="weLoadedGPT"?DMAds.BuildGPTTag(t):DMAds.BuildInlineGPTTag(t)},l=function(n){var e=DMAds.Ads[n],h=e.theAdDiv,u=!1,i=0,r=0,t,f,o,s;try{t=h.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&amp;&amp;(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&amp;&amp;(document.body.clientWidth||document.body.clientHeight)&amp;&amp;(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&amp;&amp;(f+=e.height*-1);o=t.top&gt;=0&amp;&amp;t.top-200&lt;=r||t.top&lt;=0&amp;&amp;t.top&gt;=f;s=i&gt;t.left&amp;&amp;t.right&gt;=0;u=o&amp;&amp;s}catch(c){u=!0}return u},t=function(){for(var t,i=0,n=0;n&lt;DMAds.Ads.length;n++)t=DMAds.Ads[n],!t.rendered&amp;&amp;l(n)&amp;&amp;u(n)&amp;&amp;e(n),t.rendered&amp;&amp;(i++,t.sticky&amp;&amp;!t.stickySettings&amp;&amp;(t.stickySettings=s(t)),c(n));i===DMAds.Ads.length&amp;&amp;clearInterval(f)},o=function(){var n=function(){for(var c,i,r,o,s=EnableViewOnScroll,n=0;n&lt;DMAds.Ads.length;n++)c=DMAds.Ads[n],c.rendered=!1,i=c.displayOverride,i==="onscroll"||i==="true"?s=!0:(i==="always"||i==="false")&amp;&amp;(s=!1),!s&amp;&amp;u(n)&amp;&amp;e(n);if(t(),window.addEventListener)window.addEventListener("resize",function(){t();h()},!1),window.addEventListener("scroll",t,!1);else try{window.attachEvent("onresize",function(){t();h()});window.attachEvent("onscroll",t)}catch(l){}for(a(),r=!1,o=0;o&lt;DMAds.Ads.length&amp;&amp;!r;o++)if(r=!u(o),r)break;r&amp;&amp;(f=setInterval(t,100))};DMAds.GPTRenderingMode==="loading"?googletag.cmd.push(function(){n()}):n()},a=function(){var n=null;typeof document.hidden!="undefined"?n="visibilitychange":typeof document.mozHidden!="undefined"?n="mozvisibilitychange":typeof document.msHidden!="undefined"?n="msvisibilitychange":typeof document.webkitHidden!="undefined"&amp;&amp;(n="webkitvisibilitychange");n&amp;&amp;document.addEventListener&amp;&amp;document.addEventListener(n,t,!1)},s=function(n){var u=null,i,t;return n.adContainer&amp;&amp;(i=r(n.adContainer),t={},t.isStickyRequired=n.sticky&amp;&amp;n.sticky==="top",t.absoluteTop=i.y,t.absoluteLeft=i.x,t.absoluteTop!==-1&amp;&amp;(t.originalPosition=n.theAdDiv.style.position,u=t)),u},h=function(){for(i=0;i&lt;DMAds.Ads.length;i++){var n=DMAds.Ads[i];n.stickySettings&amp;&amp;n.adContainer&amp;&amp;(n.adContainer.style.position=n.stickySettings.originalPosition,n.stickySettings=s(n),c(i))}},c=function(n){var t=DMAds.Ads[n].adContainer,i=DMAds.Ads[n].stickySettings,f=DMAds.Ads[n].theAdDiv,u,h,s;if(i&amp;&amp;i.isStickyRequired&amp;&amp;t.getBoundingClientRect&amp;&amp;document.getElementsByClassName){u=document.getElementsByClassName("sticky-stop")[0];u&amp;&amp;(h=r(u),s=u.getBoundingClientRect());var c=r(t),e=t.getBoundingClientRect(),o,l=c.y+e.height+Math.abs(e.top)&gt;h.y;u&amp;&amp;l&amp;&amp;s.top&lt;e.height?o=s.top-e.height+"px":window.pageYOffset+10&gt;=i.absoluteTop&amp;&amp;(o="10px");o?(t.style.position="fixed",t.style.top=o,t.style.left=i.absoluteLeft-window.pageXOffset+"px",f.clientHeight===0&amp;&amp;(f.style.height=t.clientHeight+"px"),f.clientWidth===0&amp;&amp;(f.style.width=t.clientWidth+"px")):t.style.position=i.originalPosition}},r=function(n){var t={};if(t.x=-1,t.y=-1,n.getBoundingClientRect){var r=n.getBoundingClientRect(),i=document.documentElement,u=window.pageYOffset||i.scrollTop||document.body.scrollTop||0,f=window.pageXOffset||i.scrollLeft||document.body.scrollLeft||0,e=i.clientTop||document.body.clientTop||0,o=i.clientLeft||document.body.clientLeft||0;t.y=r.top+u-e;t.x=r.left+f-o}return t},u=function(n){var t=DMAds.Ads[n].theAdDiv,i=!1,r;return t&amp;&amp;t.style.position!=="fixed"&amp;&amp;t.offsetParent?i=!0:t&amp;&amp;t.style.position==="fixed"&amp;&amp;(r=window.getComputedStyle(t),i=r&amp;&amp;r.display!=="none"),i&amp;&amp;v()},v=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&amp;&amp;(n="webkitHidden"),n!==null&amp;&amp;document[n]&amp;&amp;(t=!1),t},f=f||null;n||DMAds.CreateAdsCalled?n&amp;&amp;(DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n,DMAds.Ads.length-1),DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)):(DMAds.CreateAdsCalled=!0,DMAds.SetAdRequestData(),DMAds.Ads.length&gt;0&amp;&amp;(DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)))},ShowAd:function(n){var t=DMAds.Ads,i;if(n&amp;&amp;(DMAds.GPTRenderingMode!=="weLoadedGPT"||!DMAds.PublisherPageViewGuid))t.push(n),DMAds.GetTermsCalled||(DMAds.PublisherCode=n.sitename,DMAds.SetPageTagsAndPixels(DMAds.ShowAd));else if(DMAds.GPTRenderingMode==="weLoadedGPT"&amp;&amp;DMAds.PublisherPageViewGuid){while(t&amp;&amp;t.length&gt;0)i=t.pop(),DMAds.RequestQueuedAd(i);n&amp;&amp;DMAds.RequestQueuedAd(n)}},InitGPTLibrary:function(){if(googletag){var n=function(){if(googletag.pubadsReady)DMAds.GPTRenderingMode!=="weLoadedGPT"&amp;&amp;(DMAds.GPTRenderingMode="gptAlreadyLoaded");else{if(googletag.pubads().enableSingleRequest(),googletag.pubads().disableInitialLoad(),DMAds.Ads&amp;&amp;DMAds.Ads[0]&amp;&amp;typeof DMAds.Ads[0].cookieConsent!="undefined"){var n=DMAds.Ads[0].cookieConsent?1:0;googletag.pubads().setRequestNonPersonalizedAds(n?0:1)}googletag.pubads().enableAsyncRendering();googletag.enableServices();DMAds.GPTRenderingMode="weLoadedGPT";googletag.pubads().addEventListener("slotRenderEnded",function(n){DMAds.OnSlotRendered(n)})}};googletag.apiReady?n():googletag.cmd.push(function(){n()})}},BuildIFrameTag:function(n){var t=document.createElement("IFRAME"),i;return t.allowtransparency=!1,t.id="dm-gpt-iframe-"+n.tile,t.width=n.width,t.height=n.height,t.marginWidth=0,t.marginHeight=0,t.frameBorder=0,t.scrolling="no",i=encodeURIComponent(location.href),i.length&lt;2048&amp;&amp;(t.dc_ref=i),t},BuildInlineGPTTagScript:function(n){var t="div-gpt-ad-"+n.publisher+"-"+n.zone+"-"+n.tile,i="/6839/"+n.publisher+"/"+n.zone,r="["+n.width+", "+n.height+"]",u=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),f=n.cookieConsent!==undefined,e=n.cookieConsent?1:0,o="&lt;div id='"+t+"'&gt;     &lt;script type='text/javascript'&gt;         googletag.cmd.push(function() {             if ( "+f+" &amp;&amp; typeof googletag.pubads == 'function') {               googletag.pubads().setRequestNonPersonalizedAds("+e+" ? 0 : 1);            }            googletag.defineSlot('"+i+"', "+r+",'"+t+"')                 .addService(googletag.pubads())                 .setTargeting('kw', '"+u+"');             googletag.enableServices();             googletag.display('"+t+"');         });     &lt;\/script&gt; &lt;\/div&gt;";return"&lt;script type='text/javascript'&gt; var googletag = googletag || {}; googletag.cmd = googletag.cmd || []; (function() {     var gads = document.createElement('script');     gads.async = true;     gads.type = 'text/javascript';     var useSSL = 'https:' == document.location.protocol;     gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';     var node =document.getElementsByTagName('script')[0];     node.parentNode.insertBefore(gads, node); })(); &lt;\/script&gt;"+o},BuildGPTTag:function(n){var t=document.createElement("DIV"),i;t.style.height=n.height+"px";t.style.width=n.width+"px";t.style.boxSizing="border-box";t.style.border="0px";t.style.fontSize="0px";i="div-gpt-ad-"+n.publisher+"/"+n.zone+"-"+n.tile;t.id=i;t.adIndex=n.index;n.theAdDiv.appendChild(t);n.adContainer=t;googletag.cmd.push(function(){var u="/6839/"+n.publisher+"/"+n.zone,r=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),t;r=DMAds.EscapeSpecialCharacters({tags:r});t=googletag.defineSlot(u,[n.width,n.height],i).setTargeting("kw",r);n.articleid&amp;&amp;n.articleid&gt;0&amp;&amp;t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&amp;&amp;t.setCollapseEmptyDiv(!0,!0);googletag.display(i);googletag.pubads().refresh([t],{changeCorrelator:!1})})},RequestQueuedAd:function(n){googletag.cmd.push(function(){var r="/6839/"+n.sitename+"/"+n.zonename,i=(n.tags||"")+","+(DMAds.PageSearchTerms||""),t;i=DMAds.EscapeSpecialCharacters({tags:i});t=googletag.defineSlot(r,[n.width,n.height],n.targetDivId).setTargeting("kw",i);n.articleid&amp;&amp;n.articleid&gt;0&amp;&amp;t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&amp;&amp;t.setCollapseEmptyDiv(!0,!0);googletag.display(n.targetDivId);googletag.pubads().refresh([t],{changeCorrelator:!1})})},BuildInlineGPTTag:function(n){var t=DMAds.BuildIFrameTag(n),i;n.theAdDiv.appendChild(t);i=t.contentDocument||t.contentWindow.document||t.contentWindow.window.document;i.write(DMAds.BuildInlineGPTTagScript(n))},EscapeSpecialCharacters:function(n){var t=n.tags,i;t=t.replace(/\+/gi,"{plus}");t=t.replace(/\#/gi,"{sharp}");t=t.replace(/\./gi,"{dot}");t=t.replace(/[\#\*\.\(\)\+\&lt;\&gt;\[\]]/gi,"");for(var r=t.split(","),u=[];r.length&gt;0;)i=r.shift(),/[^\u0020-\u007f]/.test(i)||u.push(i);return u.join(",")},GetArticleId:function(n){var t=0,i,r;if(n&amp;&amp;n===CodeProjectPublisherId)try{i="Articles";r=window.location.href.indexOf(i);r&gt;=0&amp;&amp;(t=window.location.href.substring(r+i.length+1),t=t.substring(0,t.indexOf("/")),t=parseInt(t),isNaN(t)&amp;&amp;(t=0))}catch(u){t=0}return t},IsPagePIICompliant:function(){var t=!0,i,n,r;try{for(i=window.location.href.toLowerCase(),n=0,r=DMAds.PIIViolatingUrls.length;n&lt;r&amp;&amp;t;n++)t=!(i.indexOf(DMAds.PIIViolatingUrls[n])&gt;=0)}catch(u){console.log("Error in IsPagePIICompliant: "+u)}return t},OnSlotRendered:function(n){if(window.location.href&amp;&amp;window.location.href.includes("show_creative_id=1")&amp;&amp;n&amp;&amp;n.creativeId&amp;&amp;console.log(n.creativeId),EnableMutableAds&amp;&amp;n&amp;&amp;!n.isEmpty&amp;&amp;(!n.lineItemId||n.lineItemId&amp;&amp;n.lineItemId===0))DMAdXHelper.showAdReportingInterface(n.slot.getSlotElementId());else if(n&amp;&amp;n.isEmpty){var t=document.getElementById(n.slot.getSlotElementId());t.style.width="0px";t.style.height="0px";t.style.display="none"}DMAds.SignalSuccess(!0)},DetermineTagSize:function(n){if(n.format){var t=n.format.split("x");t.length===2&amp;&amp;(n.width=parseInt(t[0]),n.height=parseInt(t[1]))}},GetElementsByAttr:function(n,t,i,r){var o=[],u,e;i||(i=document);r||(r="*");var f=i.getElementsByTagName(r),s=f.length,h=new RegExp("(^|\\s)"+t+"(\\s|$)");for(u=0,e=0;u&lt;s;u++)h.test(f[u].getAttribute(n))&amp;&amp;(o[e]=f[u],e++);return o},GetElementsByClass:function(n,t,i){var e=[],r,f;t||(t=document);i||(i="*");var u=t.getElementsByTagName(i),o=u.length,s=new RegExp("(^|\\s)"+n+"(\\s|$)");for(r=0,f=0;r&lt;o;r++)s.test(u[r].className)&amp;&amp;(e[f]=u[r],f++);return e},SetAdRequestData:function(){var n=DMAds.GetElementsByAttr("data-type","ad",document,"div"),t;for((n===null||n.length&lt;=0)&amp;&amp;(n=DMAds.GetElementsByClass("lqm_ad",document,"div")),t=0;t&lt;n.length;t++)DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n[t],t)},GetDivRequestData:function(n,t){for(var u,f,r,o=n.attributes,s=o.length,i={},e=0;e&lt;s;e++)u=o.item(e),u.nodeName.indexOf("lqm_")===0&amp;&amp;(f=u.nodeName.slice(4),i[f]=u.value||u.nodeValue),u.nodeName.indexOf("data-")===0&amp;&amp;(f=u.nodeName.slice(5),i[f]=u.value||u.nodeValue);return r={height:0,width:0,publisher:i.publisher,zone:i.zone||"ros",site:i.site,tags:i.tags,sitename:undefined,zonename:undefined,target:"_blank",format:i.format,index:t,tile:t+1,type:i.type,noadx:i.noadx,collapse_empty:i.collapse_empty,displayOverride:i.display||i.loadOnView,sticky:i.sticky,charity:i.charity,cookieConsent:i.cookieconsent,theAdDiv:n},r.tags&amp;&amp;(r.tags=decodeURIComponent(r.tags)),DMAds.DetermineTagSize(r),r.publisher&amp;&amp;r.publisher===CodeProjectPublisherId&amp;&amp;(r.articleid=DMAds.GetArticleId(r.publisher)),r},SetupAds:function(){DMAds.IsPagePIICompliant()&amp;&amp;(DMAds.InitGPTLibrary(),DMAds.SetQueryTerms(),DMAdXHelper.init(DMAds.Ads,{DownvoteUrl:DownvoteUrl,UndoDownvoteUrl:UndoDownvoteUrl,ReportAdUrl:ReportAdUrl,CloseAdImageUrl:CloseAdImageUrl,UndoCloseAdImageUrl:UndoCloseAdImageUrl,DmLogoImageUrl:DmLogoImageUrl}),DMUserIdentityHelper.init(GlobalIdUrl),DMAds.CreateAds())},Initialise:function(){if(DMAds.IsPagePIICompliant())if(window.googletag)DMAds.SetupAds();else{var t="https:"===document.location.protocol,n=document.createElement("script");n.async=!0;n.type="text/javascript";n.src=(t?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";n.onload=this.SetupAds;document.body.appendChild(n)}}};window.DMAds=DMAds}if(DMAds.IsPagePIICompliant())if(window.addEventListener)window.addEventListener("load",function(){DMAds.Initialise()},!1);else try{window.attachEvent("onload",function(){DMAds.Initialise()})}catch(e){DMAds.Initialise()}</script><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><script async="" type="text/javascript" src="https://www.googletagservices.com/tag/js/gpt.js"></script><script async="" type="text/javascript" src="https://www.googletagservices.com/tag/js/gpt.js"></script></body></html>