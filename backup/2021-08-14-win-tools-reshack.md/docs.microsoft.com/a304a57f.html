<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" class="hasSidebar hasPageActions hasBreadcrumb conceptual has-default-focus js-focus-visible theme-light" lang="en-us" dir="ltr" data-css-variable-support="true" data-authenticated="false" data-auth-status-determined="true" data-target="docs" x-ms-format-detection="none" data-js-focus-visible=""><head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta property="og:title" content="Icons" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://docs.microsoft.com/en-us/previous-versions/ms997538(v=msdn.10)" />

	<meta name="twitter:card" content="summary" />

	<meta name="twitter:site" content="@docsmsft" />

	<meta name="color-scheme" content="light dark" />


	<meta name="author" content="Archiveddocs" />
<meta name="breadcrumb_path" content="/previous-versions/" />
<meta name="current_version_url" content="/" />
<meta name="depot_name" content="MSDN.previous-versions-root" />
<meta name="document_id" content="8617f605-9896-1b60-d819-ed104c0f31eb" />
<meta name="document_version_independent_id" content="8617f605-9896-1b60-d819-ed104c0f31eb" />
<meta name="gitcommit" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/previous-versions-root/commit/ef95e6adf22652ceb139bf09a6467aa32b11813f?path=/MSDN10-buildsystem/ms997538(v=msdn.10).md&amp;_a=contents" />
<meta name="is_archived" content="true" />
<meta name="locale" content="en-us" />
<meta name="ms.author" content="Archiveddocs" />
<meta name="ms.date" content="06/30/2010" />
<meta name="ms.prod" content="msdn" />
<meta name="ms.topic" content="archived" />
<meta name="ms:assetid" content="MSDN|dnwui|~\html\msdn_icons.htm" />
<meta name="ms:contentKeyID" content="3627091" />
<meta name="ms:mtpsurl" content="https://msdn.microsoft.com/en-us/library/ms997538(v=MSDN.10)" />
<meta name="mtps_version" content="v=MSDN.10" />
<meta name="original_content_git_url" content="https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/previous-versions-root?path=/MSDN10-buildsystem/ms997538(v=msdn.10).md&amp;version=GBlive&amp;_a=contents" />
<meta name="ROBOTS" content="NOINDEX,FOLLOW" />
<meta name="schema" content="Conceptual" />
<meta name="site_name" content="Docs" />
<meta name="TOCTitle" content="Icons" />
<meta name="uhfHeaderId" content="MSDocsHeader-Archive" />
<meta name="updated_at" content="2021-12-02 01:53 AM" />
<meta name="page_type" content="conceptual" />
<meta name="word_count" content="3680" />


<link href="https://docs.microsoft.com/en-us/previous-versions/ms997538(v=msdn.10)" rel="canonical" />
	<title>Icons | Microsoft Docs</title>

		<link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/styles/72764e6f.site-ltr.css " />

	

	<script id="msdocs-script">
	var msDocs = {
		data: {
			timeOrigin: Date.now(),
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pageTemplate: 'Conceptual',
			brand: '',
			context: {

			},
			hasBinaryRating: false,
			hasGithubIssues: false,
			showFeedbackReport: false,
			enableTutorialFeedback: false,
			feedbackSystem: 'None',
			feedbackGitHubRepo: '',
			feedbackProductUrl: '',
			contentGitUrl: 'https://docs-archive.visualstudio.com/DefaultCollection/docs-archive-project/_git/previous-versions-root?path=/MSDN10-buildsystem/ms997538(v=msdn.10).md&amp;version=GBlive&amp;_a=contents',
			extendBreadcrumb: true,
			isEditDisplayable: false,
			hideViewSource: false,
			hasPageActions: true,
			hasBookmark: true,
			hasShare: true,
			hasRecommendations: true,
		},
		functions:{}
	};
	</script>
	<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
	<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-3.min.js"></script>

	<script src="/_themes/docs.theme/master/en-us/_themes/global/5cce29c0.deprecation.js"></script>
		<script src="/_themes/docs.theme/master/en-us/_themes/scripts/68408b14.index-docs.js"></script><style></style>
</head>

<body lang="en-us" dir="ltr">
	<div class="header-holder has-default-focus">
		<a href="#main" class="skip-to-main-link has-outline-color-text visually-hidden-until-focused position-fixed has-inner-focus focus-visible top-0 left-0 right-0 padding-xs has-text-centered has-body-background" tabindex="1">Skip to main content</a>

		<div hidden="" id="cookie-consent-holder"></div>

		<div id="unsupported-browser" style="&#10;&#9;&#9;&#9;background-color: white;&#10;&#9;&#9;&#9;color: black;&#10;&#9;&#9;&#9;padding: 16px;&#10;&#9;&#9;&#9;border-bottom: 1px solid grey;" hidden="">
			<div style="max-width: 800px; margin: 0 auto;">
				<p style="font-size: 24px">This browser is no longer supported.</p>
				<p style="font-size: 16px; margin-top: 16px;">Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.</p>
				<div style="margin-top: 12px;">
					<a href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 " style="&#10;&#9;&#9;&#9;&#9;&#9;&#9;background-color: #0078d4;&#10;&#9;&#9;&#9;&#9;&#9;&#9;border: 1px solid #0078d4;&#10;&#9;&#9;&#9;&#9;&#9;&#9;color: white;&#10;&#9;&#9;&#9;&#9;&#9;&#9;padding: 6px 12px;&#10;&#9;&#9;&#9;&#9;&#9;&#9;border-radius: 2px;&#10;&#9;&#9;&#9;&#9;&#9;&#9;display: inline-block;&#10;&#9;&#9;&#9;&#9;&#9;&#9;">
Download Microsoft Edge					</a>
					<a href="https://docs.microsoft.com/en-US/lifecycle/faq/internet-explorer-microsoft-edge" style="&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;background-color: white;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;padding: 6px 12px;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;border: 1px solid #505050;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;color: #171717;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;border-radius: 2px;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;display: inline-block;&#10;&#9;&#9;&#9;&#9;&#9;&#9;&#9;">
More info					</a>
				</div>
			</div>

		</div>
		<!-- liquid-tag banners global -->
		<div id="headerAreaHolder" data-bi-name="header">
<header role="banner" itemscope="itemscope" itemtype="http://schema.org/Organization"><!----> <div class="nav-bar"><!---->  <div class="nav-bar-brand">
		<a class="nav-bar-button" itemprop="url" href="https://www.microsoft.com" aria-label="Microsoft">
			 <div class="nav-bar-logo" role="presentation" aria-hidden="true" itemprop="logo" itemscope="itemscope">
		<svg xmlns="http://www.w3.org/2000/svg" width="108" height="23" viewBox="72 72 337 74" preserveAspectRatio="xMidYMin slice">
			<g data-name="MS-symbol">
				<clipPath>
					<path transform="matrix(1 0 0 -1 0 216)" d="M0 216h482V0H0z"/>
				</clipPath>
				<g clip-path="url(#a)">
					<path class="fill-current-color color-text-subtle" d="M394.942 104.59h-10.858v25.003h-7.38V104.59h-5.182v-5.965h5.182v-4.308c0-3.254 1.06-5.92 3.178-7.998 2.12-2.079 4.835-3.118 8.15-3.118.882 0 1.666.045 2.35.135a9.37 9.37 0 011.806.407v6.296c-.24-.14-.663-.31-1.265-.512-.603-.2-1.296-.3-2.078-.3-1.528 0-2.702.476-3.526 1.43-.824.954-1.235 2.365-1.235 4.232v3.736h10.858v-6.959l7.321-2.229v9.188h7.381v5.965h-7.38v14.49c0 1.91.345 3.254 1.038 4.037.693.783 1.782 1.175 3.27 1.175.42 0 .927-.1 1.52-.3a7.178 7.178 0 001.552-.724v6.025c-.463.261-1.23.502-2.305.723a15.742 15.742 0 01-3.178.331c-3.073 0-5.378-.817-6.914-2.455-1.537-1.637-2.305-4.102-2.305-7.396zm-48.407 9.73c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.45-2.545-6.04-2.545-2.67 0-4.745.888-6.22 2.666-1.477 1.777-2.215 4.313-2.215 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.892-2.993 6.91-4.489 12.05-4.489 4.841 0 8.621 1.441 11.343 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.447 9.018-4.338 11.99-2.892 2.973-6.829 4.458-11.81 4.458-4.8 0-8.61-1.41-11.432-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-16.417-7.802c0 1.045.331 1.863.994 2.456.662.592 2.128 1.34 4.398 2.243 2.912 1.166 4.956 2.476 6.131 3.932 1.175 1.456 1.762 3.22 1.762 5.287 0 2.912-1.12 5.252-3.359 7.02-2.24 1.767-5.267 2.65-9.083 2.65-1.285 0-2.706-.155-4.263-.467-1.556-.31-2.877-.707-3.96-1.19v-7.169a17.945 17.945 0 004.277 2.198c1.526.543 2.911.814 4.157.814 1.647 0 2.862-.23 3.645-.693.784-.46 1.175-1.235 1.175-2.319 0-1.005-.406-1.853-1.22-2.546-.813-.693-2.355-1.492-4.624-2.395-2.69-1.125-4.599-2.39-5.724-3.796-1.125-1.406-1.687-3.193-1.687-5.362 0-2.792 1.11-5.086 3.33-6.884 2.217-1.797 5.095-2.696 8.63-2.696 1.084 0 2.3.12 3.645.361 1.346.242 2.47.553 3.374.934v6.93c-.964-.644-2.089-1.195-3.374-1.658-1.286-.462-2.56-.693-3.826-.693-1.386 0-2.465.271-3.238.813-.774.543-1.16 1.286-1.16 2.23m-35.066 7.562c0 3.233.733 5.703 2.2 7.411 1.465 1.707 3.564 2.56 6.295 2.56 2.652 0 4.67-.853 6.055-2.56 1.386-1.708 2.08-4.238 2.08-7.592 0-3.334-.719-5.849-2.155-7.547-1.436-1.697-3.449-2.545-6.039-2.545-2.672 0-4.745.888-6.222 2.666-1.476 1.777-2.214 4.313-2.214 7.607m-7.592.24c0-5.12 1.446-9.177 4.338-12.17 2.893-2.993 6.91-4.489 12.051-4.489 4.84 0 8.621 1.441 11.342 4.323 2.721 2.883 4.082 6.774 4.082 11.674 0 5.021-1.446 9.018-4.338 11.99-2.892 2.973-6.828 4.458-11.809 4.458-4.8 0-8.61-1.41-11.433-4.232-2.822-2.82-4.233-6.673-4.233-11.554m-3.136-16.448c.582 0 1.105.041 1.567.121.462.08.853.18 1.175.301v7.38c-.382-.28-.939-.546-1.672-.798-.733-.25-1.622-.376-2.666-.376-1.788 0-3.299.753-4.534 2.26-1.235 1.505-1.853 3.825-1.853 6.958v15.635h-7.29V98.624h7.29v4.88h.12c.663-1.687 1.667-3.007 3.013-3.96 1.346-.954 2.962-1.432 4.85-1.432m-27.956 26.18c1.084 0 2.28-.25 3.585-.754a15.06 15.06 0 003.615-1.988v6.778c-1.165.663-2.485 1.165-3.962 1.506-1.475.342-3.098.512-4.865.512-4.559 0-8.265-1.44-11.116-4.323-2.852-2.88-4.278-6.562-4.278-11.04 0-4.98 1.456-9.083 4.37-12.307 2.91-3.224 7.037-4.835 12.38-4.835 1.366 0 2.746.176 4.143.527 1.395.352 2.504.758 3.328 1.22v6.99c-1.125-.824-2.274-1.462-3.45-1.914a9.966 9.966 0 00-3.599-.678c-2.872 0-5.192.934-6.959 2.802-1.768 1.868-2.652 4.388-2.652 7.562 0 3.132.85 5.573 2.546 7.32 1.697 1.748 4.002 2.621 6.914 2.621m-22.112 5.302h-7.29V98.624h7.29zm-8.044-39.916c0-1.205.437-2.214 1.311-3.028.874-.813 1.913-1.22 3.118-1.22 1.285 0 2.35.417 3.193 1.25.844.834 1.266 1.833 1.266 2.998 0 1.185-.432 2.18-1.296 2.982-.864.804-1.918 1.205-3.163 1.205-1.246 0-2.295-.406-3.148-1.219-.854-.815-1.28-1.803-1.28-2.968m-6.274-3.284v43.2h-7.5v-33.86h-.12l-13.408 33.86h-4.97l-13.738-33.86h-.09v33.86h-6.929v-43.2h10.755l12.412 32.024h.18l13.105-32.024z"/>
					<path d="M106.214 106.214H71.996V71.996h34.218z" fill="#f25022"/>
					<path d="M143.993 106.214h-34.218V71.996h34.218z" fill="#7fba00"/>
					<path d="M106.214 143.993H71.996v-34.218h34.218z" fill="#00a4ef"/>
					<path d="M143.993 143.993h-34.218v-34.218h34.218z" fill="#ffb900"/>
				</g>
			</g>
		</svg>
	</div>
		</a>
	</div> 
				
		<div class="nav-bar-item is-hidden-tablet">
			<div class="nav-bar-menu">
				<button class="nav-bar-button is-title" title="Global navigation" aria-expanded="false">
					<span class="nav-bar-menu-title"><!---->Documentation<!----></span>
					<div class="nav-bar-burger">
						<span></span>
						<span></span>
						<span></span>
						<span class="nav-bar-burger-label"><!---->Global navigation<!----></span>
					</div>
				</button>
			</div>
		</div>
	
				
		<nav class="nav-bar-nav" role="navigation" aria-label="Global">
			<ul class="nav-bar-nav-list">
				
		<li class="nav-bar-item is-category">
			<a class="nav-bar-button is-title has-hover-underline" itemprop="url" href="/en-us/">
				<span><!---->Docs<!----></span>
			</a>
		</li>
	
				<!----> <li class="nav-bar-item">
				<a class=" nav-bar-button has-hover-underline is-active" href="/en-us/documentation">
					<span><!---->Documentation<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class=" nav-bar-button has-hover-underline " href="/en-us/learn/">
					<span><!---->Learn<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class=" nav-bar-button has-hover-underline " href="/en-us/answers/products/">
					<span><!---->Q&amp;A<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class=" nav-bar-button has-hover-underline " href="/en-us/samples/browse/">
					<span><!---->Code Samples<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class=" nav-bar-button has-hover-underline " href="/en-us/shows/">
					<span><!---->Shows<!----></span>
				</a>
		  </li><!----> <li class="nav-bar-item">
				<a class=" nav-bar-button has-hover-underline " href="/en-us/events/">
					<span><!---->Events<!----></span>
				</a>
		  </li><!----> <li class="dropdown nav-bar-item" hidden="">
		<button aria-expanded="false" class="dropdown-trigger nav-bar-button  has-hover-underline" aria-controls="ax-47">
			<span><!---->More<!----></span>
			<span class="nav-bar-button-chevron" aria-hidden="true">
				<span class="docon docon-chevron-down-light expanded-indicator"></span>
			</span>
		</button>
		<ul class="dropdown-menu" id="ax-47" aria-label="More">
			<!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button is-active" href="/en-us/documentation"><!---->Documentation<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="/en-us/learn/"><!---->Learn<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="/en-us/answers/products/"><!---->Q&amp;A<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="/en-us/samples/browse/"><!---->Code Samples<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="/en-us/shows/"><!---->Shows<!----></a>
				</li>
		  <!---->
				<li class="nav-bar-item" hidden="">
					<a class=" nav-bar-button " href="/en-us/events/"><!---->Events<!----></a>
				</li>
		  <!---->
		</ul>
	</li><!---->
			</ul>
		</nav>
	
				<span class="nav-bar-spacer"></span>
				
		<div class="nav-bar-search " id="ax-48" hidden="">
			
		<form class="nav-bar-search-form" method="GET" name="nav-bar-search-form" role="search" id="nav-bar-search-form" aria-label="Search" aria-expanded="false" action="/en-us/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!----> <div class="control ">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="site-search-input" class="autocomplete-input input   is-small" type="search" name="terms" aria-expanded="false" aria-owns="ax-49-listbox" aria-activedescendant="" aria-label="Search" placeholder="Search previous versions" />

				<span aria-hidden="true" class="icon is-small is-left" hidden="">
					<span class="has-text-primary docon docon-undefined"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-49-listbox" aria-label="site-search-input-suggestions" hidden="">
				
				
			</ul><!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="" />
			
			<input name="dataSource" hidden="" value="previousVersions" />
			
		</form>
	
		</div>
		
					<div class="nav-bar-search" hidden="">
						<!-- hidden when the width drops to tablet -->
						
		<form class="nav-bar-search-form" method="GET" name="nav-bar-search-form" role="search" id="nav-bar-search-form-desktop" aria-label="Search" aria-expanded="false" action="/en-us/search/">
			<div class="autocomplete" data-bi-name="autocomplete"><!----> <div class="control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-50" class="autocomplete-input input control has-icons-left  is-small" type="search" name="terms" aria-expanded="false" aria-owns="ax-51-listbox" aria-activedescendant="" aria-label="Search" placeholder="Search previous versions" />

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-search"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-51-listbox" aria-label="ax-50-suggestions" hidden="">
				
				
			</ul><!----></div>
			<!-- mobile safari will not dispatch submit event unless there's a submit button that is not display:none -->
			<button type="submit" class="visually-hidden" tabindex="-1" aria-hidden="true"></button>
			<input name="category" hidden="" value="" />
			
			<input name="dataSource" hidden="" value="previousVersions" />
			
		</form>
	
					</div>
			  
		<div class="nav-bar-search ">
			<div class="nav-bar-search-form-expander">
				<button id="form-expander" class="nav-bar-button has-hover-underline " title="Search" aria-expanded="false" aria-controls="ax-48">
					
		<span class="is-visually-hidden-mobile"><!---->Search<!----></span>
		<span class="icon margin-left-xxs" aria-hidden="true">
			<span class="docon docon-search"></span>
		</span>
	
				</button>
			</div>
		</div>
	
				
		<div class="nav-bar-profile">
			
		<a class="docs-sign-in auth-status-determined not-authenticated" href="#"> Sign in </a>
	 
		<div class="dropdown has-caret auth-status-determined authenticated">
			<button class="dropdown-trigger button-reset" aria-controls="user-menu" aria-expanded="false" aria-label="Your Account">
				<figure class="image is-36x36">
					<img class="has-body-background-medium is-rounded" alt="" data-profile-property="avatarUrl" />
				</figure>
			</button>
			<div class="dropdown-menu box justify-content-flex-start has-body-background" id="user-menu" role="menu">
				<div class="media is-user-dir">
					<div class="media-left">
						<figure class="image is-48x48" aria-hidden="true">
							<img class="has-body-background-medium is-rounded" aria-labelledby="displayName" data-profile-property="avatarUrl" />
						</figure>
					</div>
					<div class="media-content">
						<h2 class="title font-size-lg">
							<span id="displayName" class="is-inline-truncated has-max-width-200" data-profile-property="displayName"></span>
						</h2>
						<p class="subtitle font-size-sm margin-bottom-none">
							<span class="is-inline-truncated has-max-width-200" data-profile-property="upn"></span>
						</p>
					</div>
				</div>
				<ul class="padding-top-xs padding-bottom-xs">
					<li class="padding-bottom-xs">
						<a data-profile-property="profileUrl" href="https://docs.microsoft.com/en-us/users/me/activity/"><!---->Profile<!----></a>
					</li>
					<li>
						<a data-profile-property="settingsUrl" href="https://docs.microsoft.com/en-us/users/me/settings/"><!---->Settings<!----></a>
					</li>
				</ul>
				<div class="border-top padding-top-xs">
					<a class="docs-sign-out" href="#"><!---->Sign out<!----></a>
				</div>
			</div>
		</div>
	
		</div>
	
			 <!----></div>  <!----></header>		</div>

						<div class="content-header uhf-container has-padding has-default-focus border-bottom-none" data-bi-name="content-header">
					<nav class="breadcrumb-holder has-padding-none has-padding-left-medium-tablet has-padding-right-medium-tablet has-padding-left-none-uhf-tablet has-padding-left-none-uhf-tablet has-padding-none-desktop flex-grow-1" data-bi-name="breadcrumb" itemscope="" itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
						<ul id="page-breadcrumbs" class="breadcrumbs-deprecated"><!----><!---->
			<li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
				
							<a itemprop="item" href="https://docs.microsoft.com/en-us/">
								<span itemprop="name"><!---->Docs<!----></span>
							</a>
					  
				<meta itemprop="position" content="1" />
			</li>
		<!---->
			<li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem">
				<span itemprop="name"><!---->Icons<!----></span>
				<meta itemprop="position" content="2" />
			</li>
		<!----><!----></ul>
					</nav>
				<div class="content-header-controls">
					<button type="button" class="contents-button button" data-bi-name="contents-expand" aria-haspopup="true">
						<span class="icon"><span class="docon docon-menu" aria-hidden="true"></span></span>
						<span class="contents-expand-title">Contents</span>
					</button>
					<button type="button" class="ap-collapse-behavior ap-expanded button" data-bi-name="ap-collapse" aria-controls="action-panel">
						<span class="icon"><span class="docon docon-exit-mode" aria-hidden="true"></span></span>
						<span>Exit focus mode</span>
					</button>
				</div>
				<div class="has-padding-none-tablet padding-xs font-size-sm display-flex justify-content-space-between flex-grow-1 page-action-holder">
					<ul class="is-hidden-mobile action-list justify-content-flex-start justify-content-flex-end-tablet display-flex flex-wrap-wrap flex-grow-1 is-unstyled">
						<li hidden="">
							<a id="lang-link" class="button button button-clear button-sm" title="Read in English" data-bi-name="language-toggle" href="https://docs.microsoft.com/en-us/previous-versions/ms997538%28v=msdn.10%29" data-bi="{&quot;cN&quot;:&quot;language-toggle&quot;,&quot;value&quot;:&quot;off&quot;}">
								<span id="lang-link-icon" class="icon docon docon-locale-globe" aria-hidden="true"></span>
								<span id="lang-link-text" class="is-visually-hidden-touch is-hidden-portrait" title="Read in English">Read in English</span>
							</a>
						</li>
						<li>
							<button type="button" class="collection button button-clear button-sm has-inner-focus" data-list-type="collection" data-bi-name="collection" title="Add Icons | Microsoft Docs to a collection" aria-pressed="false">
								<span class="icon" aria-hidden="true">
									<span class="docon docon-circle-addition has-text-primary"></span>
								</span>
								<span class="collection-status is-visually-hidden-touch is-hidden-portrait">Save</span>
							</button>
						</li>
						<li>
<div class="sharing dropdown has-caret">
	<button class="dropdown-trigger button button-clear button-sm button-block justify-content-flex-start has-inner-focus" aria-controls="sharing-menu" aria-expanded="false" title="Share This Document" data-bi-name="share">
		<span class="icon" aria-hidden="true">
			<span class="docon docon-sharing"></span>
		</span>
		<span class="is-visually-hidden-touch is-hidden-portrait">Share</span>
	</button>
	<div class="dropdown-menu has-padding-small" id="sharing-menu">
		<ul data-bi-name="share-links">
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-twitter" data-bi-name="twitter" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fprevious-versions%2Fms997538%2528v%3Dmsdn.10%2529%3FWT.mc_id%3Dtwitter&amp;text=Icons%20%7C%20Microsoft%20Docs&amp;tw_p=tweetbutton&amp;url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fprevious-versions%2Fms997538%2528v%3Dmsdn.10%2529%3FWT.mc_id%3Dtwitter">
					<span class="icon">
						<span class="docon docon-brand-twitter has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Twitter</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-linkedin" data-bi-name="linkedin" href="https://www.linkedin.com/cws/share?url=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fprevious-versions%2Fms997538%2528v%3Dmsdn.10%2529%3FWT.mc_id%3Dlinkedin">
					<span class="icon">
						<span class="docon docon-brand-linkedin has-text-primary" aria-hidden="true"></span>
					</span>
					<span>LinkedIn</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-facebook" data-bi-name="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fprevious-versions%2Fms997538%2528v%3Dmsdn.10%2529%3FWT.mc_id%3Dfacebook">
					<span class="icon">
						<span class="docon docon-brand-facebook has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Facebook</span>
				</a>
			</li>
			<li>
				<a class="button button-clear button-sm button-block justify-content-flex-start has-inner-focus share-email" data-bi-name="email" href="mailto:?subject=%5BShared%20Article%5D%20Icons%20%7C%20Microsoft%20Docs&amp;body=Icons%20%7C%20Microsoft%20Docs%0A%0Ahttps%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fprevious-versions%2Fms997538%2528v%3Dmsdn.10%2529%3FWT.mc_id%3Demail">
					<span class="icon">
						<span class="docon docon-mail-message-fill has-text-primary" aria-hidden="true"></span>
					</span>
					<span>Email</span>
				</a>
			</li>
		</ul>
	</div>
</div>						</li>
					</ul>
					<button type="button" class="border contents-button  button button-clear button-sm is-hidden-tablet has-inner-focus" aria-label="Contents" data-bi-name="contents-expand">
						<span class="icon">
							<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
						</span>
						<span class="contents-expand-title">Table of contents</span>
					</button>
					<div class="is-invisible"></div>
					<div class="is-hidden-tablet level-item is-flexible level-right">
						<button type="button" class="page-actions-button  button button-clear button-sm is-hidden-tablet has-inner-focus border is-full-height  has-margin-left-small" aria-label="Page Actions" data-bi-name="pageactions">
							<span class="icon">
								<span class="docon docon-more-vertical" aria-hidden="true"></span>
							</span>
						</button>
					</div>
				</div>
			</div>



		<div id="disclaimer-holder" class="has-overflow-hidden has-default-focus"><!----> <section data-dismissable="disappearing" class="is-info alert is-banner">
			<div class="uhf-container">
				<button data-dismiss="" type="button" class="delete position-absolute top-0 right-0 margin-xxs delete-lg">
					<span class="visually-hidden"><!---->Dismiss alert<!----></span>
				</button>
				<div class="columns">
					<div class="column is-12">
						<div class="level justify-content-flex-start">
							<div class="level-left flex-shrink-1">
								<div class="level-item flex-shrink-1">
									<p class="has-text-white-static disclaimer-title has-margin-top-extra-small margin-right-xs has-line-height-reset">
										<span class="icon">
											<span class="docon docon-status-error-outline" aria-hidden="true"></span>
										</span>
										<span><!---->We're no longer updating this content regularly. Check the <a href="https://docs.microsoft.com/en-us/lifecycle/products">Microsoft Product Lifecycle</a> for information about how this product, service, technology, or API is supported.<!----></span>
									</p>
								</div>
							</div>
							 <div class="level-right margin-xxs margin-none-tablet">
				<div class="level-item justify-content-flex-start has-padding-small-tablet">
					 <a href="/" class="button button-info button-sm has-margin-left-extra-small has-margin-right-extra-small">
					<span><!---->Recommended Version<!----></span>
			  </a>
				</div>
		  </div>
						</div>
					</div>
				</div>
			</div>
		</section><!----></div>
	</div>

	<div class="mainContainer  uhf-container has-top-padding  has-default-focus" data-bi-name="body">

		<div class="columns has-large-gaps is-gapless-mobile ">

			<div id="left-container" class="left-container is-hidden-mobile column is-one-third-tablet is-one-quarter-desktop">
				<nav id="affixed-left-container" class="position-fixed display-flex flex-direction-column" role="navigation" aria-label="Primary" data-bi-name="left toc" style="width: 261.328px; top: 189.094px; bottom: 24px;"><form action="javascript:" role="search" aria-label="Search" class="has-margin-bottom-small"><label class="visually-hidden" for="ax-45">Search</label><div class="autocomplete display-block" data-bi-name="autocomplete"><!----> <div class="control has-icons-left">
				<input role="combobox" maxlength="100" aria-autocomplete="list" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" id="ax-45" class="autocomplete-input input control has-icons-left is-full-width is-small" type="text" aria-expanded="false" aria-owns="ax-46-listbox" aria-activedescendant="" placeholder="Filter by title" />

				<span aria-hidden="true" class="icon is-small is-left">
					<span class="has-text-primary docon docon-filter-settings"></span>
				</span>

				<span aria-hidden="true" class="autocomplete-loader loader has-text-primary " hidden=""></span>
			</div>

			<ul class="autocomplete-suggestions is-vertically-scrollable" role="listbox" id="ax-46-listbox" aria-label="ax-45-suggestions" hidden="">
				
				
			</ul><!----></div></form><ul class="tree is-vertically-scrollable flex-grow-1 flex-shrink-1" role="tree" aria-label="Table of contents" data-bi-name="tree" data-is-collapsible="true"><li role="none"><a aria-setsize="1" aria-level="1" aria-posinset="1" role="treeitem" tabindex="0" class="tree-item is-leaf has-external-link-indicator is-selected" data-bi-name="tree-leaf" href="https://docs.microsoft.com/en-us/previous-versions/ms997538(v=msdn.10)" aria-current="page">Icons</a></li></ul></nav>
			</div>

			<!-- .primary-holder -->
			<section class="primary-holder column is-two-thirds-tablet is-three-quarters-desktop">
				<!--div.columns -->
				<div class="columns is-gapless-mobile has-large-gaps ">


					<div id="main-column" class="column  is-full is-8-desktop">

						<main id="main" role="main" class="content " data-bi-name="content" lang="en-us" dir="ltr">



							<h1 id="icons">Icons</h1>



									<div class="display-flex-tablet justify-content-space-between-tablet page-metadata-container">

										<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
													<li>
Article													</li>
													<li>
														<time class="" data-article-date="" aria-label="Article review date" datetime="2010-06-30T00:00:00.000Z" data-article-date-source="ms.date">06/30/2010</time>
													</li>
															<li class="readingTime">18 minutes to read</li>
										</ul>
										</div>


										<nav id="center-doc-outline" class="doc-outline is-hidden-desktop" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
											<h3>In this article</h3>
										<ol><li><a href="#abstract">Abstract</a></li><li><a href="#introduction">Introduction</a></li><li><a href="#whats-in-an-icon">What's in an Icon?</a></li><li><a href="#when-in-windows">When in Windows</a></li><li><a href="#the-icon-api">The Icon API</a></li><li><a href="#a-word-on-cursors">A Word on Cursors</a></li><li><a href="#conclusion">Conclusion</a></li></ol></nav>



							<!-- <content> -->
								<p> </p>
<p>John Hornick<br />
Microsoft Corporation</p>
<p>Created: September 29, 1995</p>
<p>Download <a href="https://download.microsoft.com/download/win95/utility/1.0/w9xxp/en-us/4493.exe" data-linktype="external">4493.exe</a>.</p>
<h2 id="abstract" class="heading-anchor"><a class="anchor-link docon docon-link" href="#abstract" aria-labelledby="abstract"></a>Abstract</h2>
<p>This article describes, in detail, the format and use of icons in Windows. The following topics are covered; the format of icon resources in ICO, DLL and EXE files, the format of icon images in memory, Windows' use of icons, Windows' selection of an icon image from an icon resource, and the API provided to manipulate icon images. To follow the discussion, the reader should be familiar with Device Independent Bitmaps (DIBs) and their format. For more information about DIBs, please refer to the following sources:</p>
<ul>
<li>Documentation for the BITMAPINFO structure</li>
<li>Knowledge Base article Q81498 SAMPLE: DIBs and Their Uses</li>
<li>Knowledge Base article Q94326 SAMPLE: 16 and 32 Bits-Per-Pel Bitmap Formats</li>
</ul>
<p>Sample code dealing with some of the topics in this article is available in the Platform SDK sample tree in the IconPro project.</p>
<blockquote>
<p><strong>Disclaimer</strong></p>
<p>   </p>
<p>Internal details discussed in this article are subject to change without notice in future versions of Windows.</p>
</blockquote>
<h2 id="introduction" class="heading-anchor"><a class="anchor-link docon docon-link" href="#introduction" aria-labelledby="introduction"></a>Introduction</h2>
<p>Icons are a varied lot—they come in many sizes and color depths. A single icon resource—an ICO file, or an icon resource in an EXE or DLL file—can contain multiple icon images, each with a different size and/or color depth. Windows 95 and future versions of Windows NT (collectively referred to as "Windows" from here on) extract the appropriate size/color depth image from the resource depending on the context of the icon's use. Windows also provides a collection of functions for accessing and displaying icons and icon images.</p>
<h2 id="whats-in-an-icon" class="heading-anchor"><a class="anchor-link docon docon-link" href="#whats-in-an-icon" aria-labelledby="whats-in-an-icon"></a>What's in an Icon?</h2>
<p>An icon resource can contain multiple icon images. For example, one icon resource—in this case, a single .ICO file—can contain images in several sizes and color depths:</p>
<div class="table-scroll-wrapper has-inner-focus" tabindex="0" role="group" aria-label="Horizontally scrollable data"><table class="table"><caption class="visually-hidden">What's in an Icon?</caption>
<colgroup>
<col />
<col />
<col />
</colgroup>
<tbody>
<tr class="odd">
<td aria-label="No value"><p><img src="images/ms997538.icons_1(en-us,msdn.10).gif" alt="ms997538.icons_1(en-us,MSDN.10).gif" data-linktype="relative-path" /></p></td>
<td aria-label="No value"><p><img src="images/ms997538.icons_2(en-us,msdn.10).gif" alt="ms997538.icons_2(en-us,MSDN.10).gif" data-linktype="relative-path" /></p></td>
<td aria-label="No value"><p><img src="images/ms997538.icons_3(en-us,msdn.10).gif" alt="ms997538.icons_3(en-us,MSDN.10).gif" data-linktype="relative-path" /></p><p></p></td>
</tr>
<tr class="even">
<td>16 x 16  16 colors</td>
<td>32 x 32  16 colors</td>
<td>72 x 72  256 colors</td>
</tr>
</tbody>
</table></div>
<h3 id="the-ico-file" class="heading-anchor"><a class="anchor-link docon docon-link" href="#the-ico-file" aria-labelledby="the-ico-file"></a>The ICO File</h3>
<p>An Icon file, which usually has the ICO extension, contains one icon resource. Given that an icon resource can contain multiple images, it is no surprise that the file begins with an icon directory:</p>
<div class="codeHeader" id="code-try-0" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="typedef struct&#10;{&#10;    WORD           idReserved;   // Reserved (must be 0)&#10;    WORD           idType;       // Resource Type (1 for icons)&#10;    WORD           idCount;      // How many images?&#10;    ICONDIRENTRY   idEntries[1]; // An entry for each image (idCount of 'em)&#10;} ICONDIR, *LPICONDIR;&#10;">typedef struct
{
    WORD           idReserved;   // Reserved (must be 0)
    WORD           idType;       // Resource Type (1 for icons)
    WORD           idCount;      // How many images?
    ICONDIRENTRY   idEntries[1]; // An entry for each image (idCount of 'em)
} ICONDIR, *LPICONDIR;
</code></pre>
<p>The <strong>idCount</strong> member indicates how many images are present in the icon resource. The size of the <strong>idEntries</strong> array is determined by <strong>idCount</strong>. There exists one ICONDIRENTRY for each icon image in the file, providing details about its location in the file, size and color depth. The ICONDIRENTRY structure is defined as:</p>
<div class="codeHeader" id="code-try-1" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="typedef struct&#10;{&#10;    BYTE        bWidth;          // Width, in pixels, of the image&#10;    BYTE        bHeight;         // Height, in pixels, of the image&#10;    BYTE        bColorCount;     // Number of colors in image (0 if &gt;=8bpp)&#10;    BYTE        bReserved;       // Reserved ( must be 0)&#10;    WORD        wPlanes;         // Color Planes&#10;    WORD        wBitCount;       // Bits per pixel&#10;    DWORD       dwBytesInRes;    // How many bytes in this resource?&#10;    DWORD       dwImageOffset;   // Where in the file is this image?&#10;} ICONDIRENTRY, *LPICONDIRENTRY;&#10;">typedef struct
{
    BYTE        bWidth;          // Width, in pixels, of the image
    BYTE        bHeight;         // Height, in pixels, of the image
    BYTE        bColorCount;     // Number of colors in image (0 if &gt;=8bpp)
    BYTE        bReserved;       // Reserved ( must be 0)
    WORD        wPlanes;         // Color Planes
    WORD        wBitCount;       // Bits per pixel
    DWORD       dwBytesInRes;    // How many bytes in this resource?
    DWORD       dwImageOffset;   // Where in the file is this image?
} ICONDIRENTRY, *LPICONDIRENTRY;
</code></pre>
<p>For each ICONDIRENTRY, the file contains an icon image. The <strong>dwBytesInRes</strong> member indicates the size of the image data. This image data can be found <strong>dwImageOffset</strong> bytes from the beginning of the file, and is stored in the following format:</p>
<div class="codeHeader" id="code-try-2" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="typdef struct&#10;{&#10;   BITMAPINFOHEADER   icHeader;      // DIB header&#10;   RGBQUAD         icColors[1];   // Color table&#10;   BYTE            icXOR[1];      // DIB bits for XOR mask&#10;   BYTE            icAND[1];      // DIB bits for AND mask&#10;} ICONIMAGE, *LPICONIMAGE;&#10;">typdef struct
{
   BITMAPINFOHEADER   icHeader;      // DIB header
   RGBQUAD         icColors[1];   // Color table
   BYTE            icXOR[1];      // DIB bits for XOR mask
   BYTE            icAND[1];      // DIB bits for AND mask
} ICONIMAGE, *LPICONIMAGE;
</code></pre>
<p>The <strong>icHeader</strong> member has the form of a DIB BITMAPINFOHEADER. Only the following members are used: <strong>biSize</strong>, <strong>biWidth</strong>, <strong>biHeight</strong>, <strong>biPlanes</strong>, <strong>biBitCount</strong>, <strong>biSizeImage</strong>. All other members must be 0. The <strong>biHeight</strong> member specifies the combined height of the XOR and AND masks. The members of <strong>icHeader</strong> define the contents and sizes of the other elements of the ICONIMAGE structure in the same way that the BITMAPINFOHEADER structure defines a CF_DIB format DIB.</p>
<p>The <strong>icColors</strong> member is an array of RGBQUADs. The number of elements in this array is determined by examining the <strong>icHeader</strong> member.</p>
<p>The <strong>icXOR</strong> member contains the DIB bits for the XOR mask of the image. The number of bytes in this array is determined by examining the <strong>icHeader</strong> member. The XOR mask is the color portion of the image and is applied to the destination using the XOR operation after the application of the AND mask.</p>
<p>The icAND member contains the bits for the monochrome AND mask. The number of bytes in this array is determined by examining the icHeader member, and assuming 1bpp. The dimensions of this bitmap must be the same as the dimensions of the XOR mask. The AND mask is applied to the destination using the AND operation, to preserve or remove destination pixels before applying the XOR mask.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>   </p>
<p>The <strong>biHeight</strong> member of the <strong>icHeader</strong> structure represents the combined height of the XOR and AND masks. Remember to divide this number by two before using it to perform calculations for either of the XOR or AND masks. Also remember that the AND mask is a monochrome DIB, with a color depth of 1 bpp.</p>
</blockquote>
<p>The following is an incomplete code fragment for reading an .ICO file:</p>
<div class="codeHeader" id="code-try-3" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="// We need an ICONDIR to hold the data&#10;pIconDir = malloc( sizeof( ICONDIR ) );&#10;// Read the Reserved word&#10;ReadFile( hFile, &amp;(pIconDir-&gt;idReserved), sizeof( WORD ), &amp;dwBytesRead, NULL );&#10;// Read the Type word - make sure it is 1 for icons&#10;ReadFile( hFile, &amp;(pIconDir-&gt;idType), sizeof( WORD ), &amp;dwBytesRead, NULL );&#10;// Read the count - how many images in this file?&#10;ReadFile( hFile, &amp;(pIconDir-&gt;idCount), sizeof( WORD ), &amp;dwBytesRead, NULL );&#10;// Reallocate IconDir so that idEntries has enough room for idCount elements&#10;pIconDir = realloc( pIconDir, ( sizeof( WORD ) * 3 ) +&#10;                              ( sizeof( ICONDIRENTRY ) * pIconDir-&gt;idCount ) );&#10;// Read the ICONDIRENTRY elements&#10;ReadFile( hFile, pIconDir-&gt;idEntries, pIconDir-&gt;idCount * sizeof(ICONDIRENTRY),&#10;          &amp;dwBytesRead, NULL );&#10;// Loop through and read in each image&#10;for(i=0;i&lt;pIconDir-&gt;idCount;i++)&#10;{&#10;  // Allocate memory to hold the image&#10;  pIconImage = malloc( pIconDir-&gt;idEntries[i].dwBytesInRes );&#10;  // Seek to the location in the file that has the image&#10;  SetFilePointer( hFile, pIconDir-&gt;idEntries[i].dwImageOffset, &#10;                  NULL, FILE_BEGIN );&#10;  // Read the image data&#10;  ReadFile( hFile, pIconImage, pIconDir-&gt;idEntries[i].dwBytesInRes,&#10;            &amp;dwBytesRead, NULL );&#10;  // Here, pIconImage is an ICONIMAGE structure. Party on it :)&#10;  // Then, free the associated memory&#10;  free( pIconImage );&#10;}&#10;// Clean up the ICONDIR memory&#10;free( pIconDir );&#10;">// We need an ICONDIR to hold the data
pIconDir = malloc( sizeof( ICONDIR ) );
// Read the Reserved word
ReadFile( hFile, &amp;(pIconDir-&gt;idReserved), sizeof( WORD ), &amp;dwBytesRead, NULL );
// Read the Type word - make sure it is 1 for icons
ReadFile( hFile, &amp;(pIconDir-&gt;idType), sizeof( WORD ), &amp;dwBytesRead, NULL );
// Read the count - how many images in this file?
ReadFile( hFile, &amp;(pIconDir-&gt;idCount), sizeof( WORD ), &amp;dwBytesRead, NULL );
// Reallocate IconDir so that idEntries has enough room for idCount elements
pIconDir = realloc( pIconDir, ( sizeof( WORD ) * 3 ) +
                              ( sizeof( ICONDIRENTRY ) * pIconDir-&gt;idCount ) );
// Read the ICONDIRENTRY elements
ReadFile( hFile, pIconDir-&gt;idEntries, pIconDir-&gt;idCount * sizeof(ICONDIRENTRY),
          &amp;dwBytesRead, NULL );
// Loop through and read in each image
for(i=0;i&lt;pIconDir-&gt;idCount;i++)
{
  // Allocate memory to hold the image
  pIconImage = malloc( pIconDir-&gt;idEntries[i].dwBytesInRes );
  // Seek to the location in the file that has the image
  SetFilePointer( hFile, pIconDir-&gt;idEntries[i].dwImageOffset, 
                  NULL, FILE_BEGIN );
  // Read the image data
  ReadFile( hFile, pIconImage, pIconDir-&gt;idEntries[i].dwBytesInRes,
            &amp;dwBytesRead, NULL );
  // Here, pIconImage is an ICONIMAGE structure. Party on it :)
  // Then, free the associated memory
  free( pIconImage );
}
// Clean up the ICONDIR memory
free( pIconDir );
</code></pre>
<p>Complete code can be found in the Icons.C module of IconPro, in a function named <strong>ReadIconFromICOFile</strong>.</p>
<h3 id="dll-and-exe-files" class="heading-anchor"><a class="anchor-link docon docon-link" href="#dll-and-exe-files" aria-labelledby="dll-and-exe-files"></a>DLL and EXE Files</h3>
<p>Icons can also be stored in .DLL and .EXE files. The structures used to store icon images in .EXE and .DLL files differ only slightly from those used in .ICO files.</p>
<p>Analogous to the ICONDIR data in the ICO file is the RT_GROUP_ICON resource. In fact, one RT_GROUP_ICON resource is created for each ICO file bound to the EXE or DLL with the resource compiler/linker. The RT_GROUP_ICON resource is simply a GRPICONDIR structure:</p>
<div class="codeHeader" id="code-try-4" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="// #pragmas are used here to insure that the structure's&#10;// packing in memory matches the packing of the EXE or DLL.&#10;#pragma pack( push )&#10;#pragma pack( 2 )&#10;typedef struct &#10;{&#10;   WORD            idReserved;   // Reserved (must be 0)&#10;   WORD            idType;       // Resource type (1 for icons)&#10;   WORD            idCount;      // How many images?&#10;   GRPICONDIRENTRY   idEntries[1]; // The entries for each image&#10;} GRPICONDIR, *LPGRPICONDIR;&#10;#pragma pack( pop )&#10;">// #pragmas are used here to insure that the structure's
// packing in memory matches the packing of the EXE or DLL.
#pragma pack( push )
#pragma pack( 2 )
typedef struct 
{
   WORD            idReserved;   // Reserved (must be 0)
   WORD            idType;       // Resource type (1 for icons)
   WORD            idCount;      // How many images?
   GRPICONDIRENTRY   idEntries[1]; // The entries for each image
} GRPICONDIR, *LPGRPICONDIR;
#pragma pack( pop )
</code></pre>
<p>The <strong>idCount</strong> member indicates how many images are present in the icon resource. The size of the <strong>idEntries</strong> array is determined by <strong>idCount</strong>. There exists one GRPICONDIRENTRY for each icon image in the resource, providing details about its size and color depth. The GRPICONDIRENTRY structure is defined as:</p>
<div class="codeHeader" id="code-try-5" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="#pragma pack( push )&#10;#pragma pack( 2 )&#10;typedef struct&#10;{&#10;   BYTE   bWidth;               // Width, in pixels, of the image&#10;   BYTE   bHeight;              // Height, in pixels, of the image&#10;   BYTE   bColorCount;          // Number of colors in image (0 if &gt;=8bpp)&#10;   BYTE   bReserved;            // Reserved&#10;   WORD   wPlanes;              // Color Planes&#10;   WORD   wBitCount;            // Bits per pixel&#10;   DWORD   dwBytesInRes;         // how many bytes in this resource?&#10;   WORD   nID;                  // the ID&#10;} GRPICONDIRENTRY, *LPGRPICONDIRENTRY;&#10;#pragma pack( pop )&#10;">#pragma pack( push )
#pragma pack( 2 )
typedef struct
{
   BYTE   bWidth;               // Width, in pixels, of the image
   BYTE   bHeight;              // Height, in pixels, of the image
   BYTE   bColorCount;          // Number of colors in image (0 if &gt;=8bpp)
   BYTE   bReserved;            // Reserved
   WORD   wPlanes;              // Color Planes
   WORD   wBitCount;            // Bits per pixel
   DWORD   dwBytesInRes;         // how many bytes in this resource?
   WORD   nID;                  // the ID
} GRPICONDIRENTRY, *LPGRPICONDIRENTRY;
#pragma pack( pop )
</code></pre>
<p>The <strong>dwBytesInRes</strong> member indicates the total size of the RT_ICON resource referenced by the <strong>nID</strong> member. <strong>nID</strong> is the RT_ICON identifier that can be passed to <strong>FindResource</strong>, <strong>LoadResource</strong> and <strong>LockResource</strong> to obtain a pointer to the ICONIMAGE structure (defined above) for this image.</p>
<p>The following is an incomplete code fragment for reading icons from a .DLL or .EXE file:</p>
<div class="codeHeader" id="code-try-6" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="// Load the DLL/EXE without executing its code&#10;hLib = LoadLibraryEx( szFileName, NULL, LOAD_LIBRARY_AS_DATAFILE );&#10;// Find the group resource which lists its images&#10;hRsrc = FindResource( hLib, MAKEINTRESOURCE( nId ), RT_GROUP_ICON );&#10;// Load and Lock to get a pointer to a GRPICONDIR&#10;hGlobal = LoadResource( hLib, hRsrc );&#10;lpGrpIconDir = LockResource( hGlobal );&#10;// Using an ID from the group, Find, Load and Lock the RT_ICON&#10;hRsrc = FindResource( hLib, MAKEINTRESOURCE( lpGrpIconDir-&gt;idEntries[0].nID ),&#10;                      RT_ICON );&#10;hGlobal = LoadResource( hLib, hRsrc );&#10;lpIconImage = LockResource( hGlobal );&#10;// Here, lpIconImage points to an ICONIMAGE structure&#10;">// Load the DLL/EXE without executing its code
hLib = LoadLibraryEx( szFileName, NULL, LOAD_LIBRARY_AS_DATAFILE );
// Find the group resource which lists its images
hRsrc = FindResource( hLib, MAKEINTRESOURCE( nId ), RT_GROUP_ICON );
// Load and Lock to get a pointer to a GRPICONDIR
hGlobal = LoadResource( hLib, hRsrc );
lpGrpIconDir = LockResource( hGlobal );
// Using an ID from the group, Find, Load and Lock the RT_ICON
hRsrc = FindResource( hLib, MAKEINTRESOURCE( lpGrpIconDir-&gt;idEntries[0].nID ),
                      RT_ICON );
hGlobal = LoadResource( hLib, hRsrc );
lpIconImage = LockResource( hGlobal );
// Here, lpIconImage points to an ICONIMAGE structure
</code></pre>
<p>Complete code can be found in the Icons.C module of IconPro, in a function named <strong>ReadIconFromEXEFile</strong>.</p>
<h3 id="in-memory" class="heading-anchor"><a class="anchor-link docon docon-link" href="#in-memory" aria-labelledby="in-memory"></a>In Memory</h3>
<p>When dealing with icon resources in memory, the format is identical to the format used in .EXE and .DLL files. Functions such as <strong>CreateIconFromResource</strong> expect to be passed an ICONIMAGE structure. This is very convenient since <strong>FindResource</strong>, <strong>LoadResource</strong> and <strong>LockResource</strong> can be used to load the RT_ICON resource in that format.</p>
<p>An HICON handle is a handle to a single icon image, or RT_ICON resource. In previous versions of Windows, the size of an HICON image could be determined by calling <strong>GetSystemMetrics</strong> with the SM_CYICON and SM_CXICON flags. It is now possible, however, to have HICON handles for icons with non-standard sizes. HICON icons always have the same color format as the display device. See the discussion of functions below for more details on how to handle icons of different sizes and color depths using HICON handles.</p>
<h2 id="when-in-windows" class="heading-anchor"><a class="anchor-link docon docon-link" href="#when-in-windows" aria-labelledby="when-in-windows"></a>When in Windows</h2>
<p>In Windows, the system maintains the concept of two sizes of icons, small and large. Further, the shell also has a concept of small and large icons. This means that in total, Windows is aware of four different icon sizes—System Small, System Large, Shell Small, and Shell Large.</p>
<p>The System Small size is derived from the size of window captions. The caption size can be adjusted from the "Appearance" tab in the Display Properties dialog. Adjustments made to the caption size are immediately reflected in the System Small icon size. The System Small size can be queried by calling <strong>GetSystemMetrics</strong> with the SM_CXSMICON and SM_CYSMICON parameters.</p>
<p>The System Large size is defined by the video driver and therefore cannot be changed dynamically. The System Large size can be queried by calling <strong>GetSystemMetrics</strong> with the SM_CXICON and SM_CYICON parameters.</p>
<p>The Shell Small size is defined by Windows, and currently Windows does not support changing this value, nor is there currently a direct way to query this value.</p>
<p>The Shell Large size is stored in the registry under the following key:</p>
<div class="codeHeader" id="code-try-7" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="HKEY_CURRENT_USER\Control Panel\desktop\WindowMetrics\Shell Icon Size&#10;">HKEY_CURRENT_USER\Control Panel\desktop\WindowMetrics\Shell Icon Size
</code></pre>
<p>The Shell Large size can be changed by modifying the registry or from the "Appearance" tab in the Display Properties dialog, which allows values from 16 to 72. Following is an example of code that can be used to change the Shell Large icon size by accessing the registry:</p>
<div class="codeHeader" id="code-try-8" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="DWORD SetShellLargeIconSize( DWORD dwNewSize )&#10;{&#10;   #define MAX_LENGTH   512&#10;   DWORD   dwOldSize, dwLength = MAX_LENGTH, dwType = REG_SZ;&#10;   TCHAR   szBuffer[MAX_LENGTH];&#10;   HKEY   hKey;&#10;&#10;   // Get the Key&#10;   RegOpenKey( HKEY_CURRENT_USER, &quot;Control Panel\\desktop\\WindowMetrics&quot;,                   &amp;hKey);&#10;   // Save the last size&#10;   RegQueryValueEx( hKey, &quot;Shell Icon Size&quot;, NULL, &amp;dwType, szBuffer, &#10;               &amp;dwLength );&#10;   dwOldSize = atol( szBuffer );&#10;   // We will allow only values &gt;=16 and &lt;=72&#10;   if( (dwNewSize&gt;=16) || (dwNewSize&lt;=72) )&#10;   {&#10;      wsprintf( szBuffer, &quot;%d&quot;, dwNewSize );&#10;      RegSetValueEx( hKey, &quot;Shell Icon Size&quot;, 0, REG_SZ, szBuffer,&#10;                  lstrlen(szBuffer) + 1 );&#10;   }&#10;   // Clean up&#10;   RegCloseKey( hKey );&#10;   // Let everyone know that things changed&#10;   SendMessage( HWND_BROADCAST, WM_SETTINGCHANGE, SPI_SETICONMETRICS,&#10;               (LPARAM)(&quot;WindowMetrics&quot;) );&#10;   return dwOldSize;&#10;   #undef MAX_LENGTH&#10;}&#10;">DWORD SetShellLargeIconSize( DWORD dwNewSize )
{
   #define MAX_LENGTH   512
   DWORD   dwOldSize, dwLength = MAX_LENGTH, dwType = REG_SZ;
   TCHAR   szBuffer[MAX_LENGTH];
   HKEY   hKey;

   // Get the Key
   RegOpenKey( HKEY_CURRENT_USER, "Control Panel\\desktop\\WindowMetrics",                   &amp;hKey);
   // Save the last size
   RegQueryValueEx( hKey, "Shell Icon Size", NULL, &amp;dwType, szBuffer, 
               &amp;dwLength );
   dwOldSize = atol( szBuffer );
   // We will allow only values &gt;=16 and &lt;=72
   if( (dwNewSize&gt;=16) || (dwNewSize&lt;=72) )
   {
      wsprintf( szBuffer, "%d", dwNewSize );
      RegSetValueEx( hKey, "Shell Icon Size", 0, REG_SZ, szBuffer,
                  lstrlen(szBuffer) + 1 );
   }
   // Clean up
   RegCloseKey( hKey );
   // Let everyone know that things changed
   SendMessage( HWND_BROADCAST, WM_SETTINGCHANGE, SPI_SETICONMETRICS,
               (LPARAM)("WindowMetrics") );
   return dwOldSize;
   #undef MAX_LENGTH
}
</code></pre>
<p><strong>Table 1. Where Windows Uses Different Sized Icons</strong></p>
<div class="table-scroll-wrapper has-inner-focus" tabindex="0" role="group" aria-label="Horizontally scrollable data"><table class="table"><caption class="visually-hidden">Table 2</caption>
<thead>
<tr class="header">
<th>Location</th>
<th>Icon Size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Desktop</td>
<td>Shell Large</td>
</tr>
<tr class="even">
<td>TitleBar of Windows</td>
<td>System Small</td>
</tr>
<tr class="odd">
<td>&lt;Alt&gt;&lt;Tab&gt; Dialog</td>
<td>System Large</td>
</tr>
<tr class="even">
<td>Start Menu</td>
<td>Shell Small / Shell Large</td>
</tr>
</tbody>
</table></div>
<p>While Windows imposes no restrictions on the sizes of icons, common sizes include 16, 32, and 48 pixels square. For this reason, developers are encouraged to include a minimum of the following sizes and color depths in their icon resources:</p>
<div class="table-scroll-wrapper has-inner-focus" tabindex="0" role="group" aria-label="Horizontally scrollable data"><table class="table"><caption class="visually-hidden">Table 3</caption>
<tbody>
<tr class="odd">
<td>16 x 16</td>
<td>16 colors</td>
</tr>
<tr class="even">
<td>32 x 32</td>
<td>16 colors</td>
</tr>
<tr class="odd">
<td>48 x 48</td>
<td>256 colors</td>
</tr>
</tbody>
</table></div>
<h3 id="choosing-an-icon" class="heading-anchor"><a class="anchor-link docon docon-link" href="#choosing-an-icon" aria-labelledby="choosing-an-icon"></a>Choosing an Icon</h3>
<p>When Windows prepares to display an icon, a desktop shortcut for example, it must parse the .EXE or .DLL file and extract the appropriate icon image. This selection is a two step process starting with the selection of the appropriate RT_GROUP_ICON resource, and ending with the selection of the proper RT_ICON image from that RT_GROUP_ICON.</p>
<h4 id="which-icon" class="heading-anchor"><a class="anchor-link docon docon-link" href="#which-icon" aria-labelledby="which-icon"></a>Which Icon?</h4>
<p>If an .EXE or .DLL file has only one RT_GROUP_ICON resource, the first step is trivial; Windows simply uses that resource. However, if more than one such group resource exists in the file, Windows must decide which one to use. Windows NT simply chooses the first resource listed in the application's RC script. On the other hand, Windows 95's algorithm is to choose the alphabetically first named group icon if one exists. If one such group resource does not exist, Windows chooses the icon with the numerically lowest identifier. So, to be sure that a particular icon is used for an application, the developer should insure that both of the following criteria are met:</p>
<ol>
<li>The icon is placed before all other icons in the RC file.</li>
<li>If the icon is named, its name is alphabetically before any other named icon, otherwise its resource identifier is numerically smaller than any other icon.</li>
</ol>
<h4 id="which-image" class="heading-anchor"><a class="anchor-link docon docon-link" href="#which-image" aria-labelledby="which-image"></a>Which Image?</h4>
<p>Once an RT_GROUP_ICON is chosen, the individual icon image, or RT_ICON resource, must be selected and extracted. Again, if there exists only one RT_ICON resource for the group in question, the choice is trivial. However, if multiple images are present in the group, the following selection rules are applied:</p>
<ol>
<li>The image closest in size to the requested size is chosen.</li>
<li>If two or more images of that size are present, the one that matches the color depth of the display is chosen.</li>
<li>If none exactly match the color depth of the display, Windows chooses the image with the greatest color depth without exceeding the color depth of the display.</li>
<li>If all the size-matched images exceed the color depth of the display, the one with the lowest color depth is chosen.</li>
<li>Windows treats all color depths of 8 or more bpp as equal. For example, it is pointless to have a 16x16 256 color image and a 16x16 16bpp image in the same resource—Windows will simply choose the first one it encounters.</li>
<li>When the display is in 8bpp mode, Windows will prefer a 16 color icon over a 256 color icon, and will display all icons using the system default palette.</li>
</ol>
<h2 id="the-icon-api" class="heading-anchor"><a class="anchor-link docon docon-link" href="#the-icon-api" aria-labelledby="the-icon-api"></a>The Icon API</h2>
<p>When dealing with icons, the developer can choose to manipulate the raw resource bytes, or let Windows handle the low level details and simply use HICON handles. The advantage of handling the raw resource bytes is a gain in control, while the advantage of using the HICON handles is that of simplicity. For most purposes, the HICON interface is sufficient—it is likely that handling the raw resource bytes will be necessary only in the development of an icon handling program.</p>
<h3 id="raw-resource-bytes" class="heading-anchor"><a class="anchor-link docon docon-link" href="#raw-resource-bytes" aria-labelledby="raw-resource-bytes"></a>Raw Resource Bytes</h3>
<p>The standard Windows API functions for manipulating resources—<strong>FindResource</strong>, <strong>LoadResource</strong> and <strong>LockResource</strong>—can, of course, be used to handle icon resources.</p>
<p><strong>EnumResourceNames</strong> can be used, passing in RT_GROUP_ICON, to find the available group icon resources. Once the appropriate group resource is chosen, it can be loaded using <strong>FindResource</strong>, <strong>LoadResource</strong> and <strong>LockResource</strong>. This will yield a pointer to a GRPICONDIR structure.</p>
<p>The <strong>idEntries</strong> array is the searched for a match on the desired color depth and size. The <strong>nID</strong> member of that array element is then used as an argument to <strong>FindResource</strong>, passing in RT_ICON. <strong>LoadResource</strong> and <strong>LockResource</strong> then yield a pointer to an ICONIMAGE structure for that icon image.</p>
<p>To allow Windows to perform the color depth and size selection, the GRPICONDIR structure can be passed to <strong>LookUpIconIdFromDirectory</strong> or L<strong>ookUpIconIdFromDirectoryEx</strong>. Both of these functions return an id that can be used with RT_ICON and FindResource, the latter providing a way to specify a desired size to match against.</p>
<p>The ICONIMAGE structure contains pointers to the DIB bits for the masks. These pointers can be used in DIB functions for direct manipulation. The ICONIMAGE structure is also conveniently suitable to be passed to <strong>CreateIconFromResource</strong> or <strong>CreateIconFromResourceEx</strong> to yield an HICON handle. The former of the two functions creates an icon that is System Large size. The latter provides a way to specify a desired size, and Windows performs the appropriate conversions.</p>
<h3 id="hicon-handles" class="heading-anchor"><a class="anchor-link docon docon-link" href="#hicon-handles" aria-labelledby="hicon-handles"></a>HICON Handles</h3>
<p>An HICON handle is a handle to a single icon image. This is analogous to a single RT_ICON resource. The image is stored internally using device dependent bitmaps (DDBs). This implies that all HICON icons have the same color format as the display device. The size of the icon depends on its origin and the system defined icon sizes.</p>
<p>The available icon handling functions can be thought of in two groups—those that handle System Large size icons and those that handle any size icons. The functions that handle only System Large size icons are typically left over from 16 bit days, when the system defined only one icon size. The newer functions, those that handle any size icon, accept as a parameter the desired size of the icon.</p>
<h4 id="one-size-fits-all" class="heading-anchor"><a class="anchor-link docon docon-link" href="#one-size-fits-all" aria-labelledby="one-size-fits-all"></a>One Size Fits All</h4>
<p>The original icon handling functions were designed for a system that defined only one icon size. Therefore, most of those functions are unaware of the possibility of more than one icon size and assume all icons are System Large size.</p>
<p><strong>LoadIcon</strong>, <strong>ExtractIcon</strong> and <strong>DrawIcon</strong> fall into this category. <strong>LoadIcon</strong> and <strong>ExtractIcon</strong> always search for a match for System Large size. If an exact match cannot be found, these two functions stretch the closest match to that size. They always return an icon of System Large size. Similarly, <strong>DrawIcon</strong> always draws the icon at System Large size. If a different size icon is passed to <strong>DrawIcon</strong>, it is stretched and displayed at System Large size.</p>
<p><strong>CreateIconFromResource</strong> also exhibits this behavior. It returns a handle to a System Large size icon, stretching the RT_ICON resource it was passed as necessary.</p>
<h4 id="to-each-their-own" class="heading-anchor"><a class="anchor-link docon docon-link" href="#to-each-their-own" aria-labelledby="to-each-their-own"></a>To Each Their Own</h4>
<p>Now that Windows has the ability to handle different sized icons, new functions were added to handle them. In some cases, old functions were expanded and "Ex" was added to their name. In other cases, whole new functions were added. The net result is that there is now full support for different sized icons in the Windows API.</p>
<p>Several different functions are available to get an HICON handle to a different sized icon. <strong>LoadImage</strong> can be used to extract an icon from an EXE or DLL file without the hassle of manually loading the resource bytes. <strong>CreateIconFromResourceEx</strong> is available if the resource bytes have been loaded.</p>
<p><strong>CreateIcon</strong> and <strong>CreateIconIndirect</strong>, even though they have their roots in 16-bit land, do facilitate creating icons of different sizes. <strong>CreateIcon</strong> accept a desired width and height as parameters, while <strong>CreateIconIndirect</strong> creates an icon based on the bitmaps in the ICONINFO parameter. Note that both of these functions work with DDBs, not DIBs.</p>
<p><strong>SHGetFileInfo</strong> can also be used to get icons from files, providing the icon that the shell would display for the file. <strong>SHGetFileInfo</strong> works on any type of file, and can extract any of the four icons sizes, as shown below:</p>
<div class="codeHeader" id="code-try-9" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="// Load a System Large icon image&#10;SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), &#10;               SHGFI_ICON | SHGFI_LARGEICON);&#10;&#10;// Load a System Small icon image&#10;SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), &#10;               SHGFI_ICON | SHGFI_SMALLICON);&#10;&#10;// Load a Shell Large icon image&#10;SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), &#10;               SHGFI_ICON | SHGFI_SHELLICONSIZE);&#10;&#10;// Load a Shell Small icon image&#10;SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), &#10;               SHGFI_ICON | SHGFI_SHELLICONSIZE | SHGFI_SMALLICON);&#10;">// Load a System Large icon image
SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), 
               SHGFI_ICON | SHGFI_LARGEICON);

// Load a System Small icon image
SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), 
               SHGFI_ICON | SHGFI_SMALLICON);

// Load a Shell Large icon image
SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), 
               SHGFI_ICON | SHGFI_SHELLICONSIZE);

// Load a Shell Small icon image
SHGetFileInfo( szFileName, 0, &amp;shfi, sizeof( SHFILEINFO ), 
               SHGFI_ICON | SHGFI_SHELLICONSIZE | SHGFI_SMALLICON);
</code></pre>
<p>Given an HICON handle, DrawIconEx can be used to display it—at its normal size, at the System Large size, or at any other size:</p>
<div class="codeHeader" id="code-try-10" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="// Draw it at its native size&#10;DrawIconEx( hDC, nLeft, nTop, hIcon, 0, 0, 0, NULL, DI_NORMAL );&#10;&#10;// Draw it at the System Large size&#10;DrawIconEx( hDC, nLeft, nTop, hIcon, 0, 0, 0, &#10;            NULL, DI_DEFAULTSIZE | DI_NORMAL );&#10;&#10;// Draw it at some other size (40x40 in this example)&#10;DrawIconEx( hDC, nLeft, nTop, hIcon, 40, 40, 0, NULL, DI_NORMAL );&#10;">// Draw it at its native size
DrawIconEx( hDC, nLeft, nTop, hIcon, 0, 0, 0, NULL, DI_NORMAL );

// Draw it at the System Large size
DrawIconEx( hDC, nLeft, nTop, hIcon, 0, 0, 0, 
            NULL, DI_DEFAULTSIZE | DI_NORMAL );

// Draw it at some other size (40x40 in this example)
DrawIconEx( hDC, nLeft, nTop, hIcon, 40, 40, 0, NULL, DI_NORMAL );
</code></pre>
<p>Note that DrawIconEx will stretch the icon as necessary to make it fit the desired output size.</p>
<h4 id="whats-in-there" class="heading-anchor"><a class="anchor-link docon docon-link" href="#whats-in-there" aria-labelledby="whats-in-there"></a>What's in There?</h4>
<p>The Windows API provides a function for determining the characteristics of an icon, given its HICON handle. This function is <strong>GetIconInfo</strong>. <strong>GetIconInfo</strong> fills out an ICONINFO structure with the information pertaining to the HICON. The ICONINFO structure contains the following information:</p>
<div class="codeHeader" id="code-try-11" data-bi-name="code-header"><span class="language"></span><button type="button" class="action position-relative" data-bi-name="copy" aria-label="Copy code">
				<span class="icon margin-right-xxs">
					<span class="docon docon-edit-copy" role="presentation"></span>
				</span>
				<span>Copy</span>
				<div class="successful-copy-alert position-absolute right-0 top-0 left-0 bottom-0 display-flex align-items-center justify-content-center has-text-success-invert has-background-success is-transparent" aria-hidden="true">
					<span class="icon font-size-lg">
						<span class="docon docon-check-mark" role="presentation"></span>
					</span>
				</div>
			</button></div><pre tabindex="0" class="has-inner-focus"><code data-author-content="typedef struct _ICONINFO { // ii  &#10;&#10;   BOOL    fIcon;   // TRUE for icon, FALSE for cursor&#10;   DWORD   xHotspot;   // the x hotspot coordinate for cursor&#10;   DWORD   yHotspot;   // the y hotspot coordinate for cursor&#10;   HBITMAP hbmMask;   // handle to monochrome AND mask bitmap&#10;   HBITMAP hbmColor;   // handle to device dependent XOR mask bitmap&#10;} ICONINFO;&#10;">typedef struct _ICONINFO { // ii  

   BOOL    fIcon;   // TRUE for icon, FALSE for cursor
   DWORD   xHotspot;   // the x hotspot coordinate for cursor
   DWORD   yHotspot;   // the y hotspot coordinate for cursor
   HBITMAP hbmMask;   // handle to monochrome AND mask bitmap
   HBITMAP hbmColor;   // handle to device dependent XOR mask bitmap
} ICONINFO;
</code></pre>
<p>Given this information, an application can calculate the information needed to write the icon to a file. The AND mask and XOR mask DIB bits can be obtained with calls to <strong>GetDIBits</strong> on the two bitmaps in this structure.</p>
<h2 id="a-word-on-cursors" class="heading-anchor"><a class="anchor-link docon docon-link" href="#a-word-on-cursors" aria-labelledby="a-word-on-cursors"></a>A Word on Cursors</h2>
<p>Cursors are very similar to icons. In fact, by changing only one line in the source code for IconPro, that sample can read .CUR files. IconPro currently tests the <strong>idType</strong> member of the ICONDIR structure to make sure the file is an icon file. This check can be relaxed to allow the type for cursors (2) as well. Also, HCURSOR handles can be used interchangeably with HICON handles in most icon functions.</p>
<h2 id="conclusion" class="heading-anchor"><a class="anchor-link docon docon-link" href="#conclusion" aria-labelledby="conclusion"></a>Conclusion</h2>
<p>Although the icon specification has long been able to handle icons of odd sizes and color depths, only recently has Windows responded with inherent support for such images. Developers now have the option of dealing directly with the bits of an icon, or allowing Windows to handle all the details. Windows even provides API support for loading and displaying icons of non-standard sizes and different color depths.</p>

							<!-- </content> -->

						</main>




						<!-- recommendations section -->
							<section id="recommendations-section" data-bi-name="recommendations"></section>
						<!-- end recommendations section -->

						<!-- feedback section -->
						<!-- end feedback section -->

						<!-- feedback report section -->
						<!-- end feedback report section -->

						<div class="border-top is-visible-interactive has-default-focus has-margin-top-large ">



	<footer id="footer-interactive" data-bi-name="footer" class="footer-layout">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link button button-clear flex-shrink-0" href="/en-us/locale?target=https://docs.microsoft.com/en-us/previous-versions/ms997538%28v=msdn.10%29" data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text">English (United States)</span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu-interactive" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu-interactive" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme display-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start is-selected" data-theme-to="light" aria-pressed="true">
					<span class="theme-light has-margin-right-small">
						<span class="theme-selector-icon css-variable-support border display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme display-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="dark" aria-pressed="false">
					<span class="theme-dark has-margin-right-small">
						<span class="border theme-selector-icon css-variable-support display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme display-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast has-margin-right-small">
						<span class="border theme-selector-icon css-variable-support display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>
		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden=""></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>© Microsoft 2022</li>
	</ul>
</footer>
						</div>
					</div>

						<div class="font-size-sm right-container column is-4-desktop display-none display-block-desktop" data-bi-name="pageactions" role="complementary" aria-label="Page Actions">

							<div id="affixed-right-container" class="doc-outline is-vertically-scrollable" style="top: 189.094px; bottom: 24px; position: fixed;">
								<nav id="side-doc-outline" data-bi-name="intopic toc" role="navigation" aria-label="Article Outline">
									<h3>In this article</h3>
								<ol><li class="selected"><a href="#abstract">Abstract</a></li><li><a href="#introduction">Introduction</a></li><li><a href="#whats-in-an-icon">What's in an Icon?</a></li><li><a href="#when-in-windows">When in Windows</a></li><li><a href="#the-icon-api">The Icon API</a></li><li><a href="#a-word-on-cursors">A Word on Cursors</a></li><li><a href="#conclusion">Conclusion</a></li></ol></nav>
							</div>
						</div>

				</div>
				<!--end of div.columns -->

			</section>
			<!--end of .primary-holder -->

			<!-- interactive container -->
			<aside id="interactive-container" class="interactive-container is-visible-interactive column has-body-background-dark ">
			</aside>
			<!-- end of interactive container -->
		</div>

	</div>
	<!--end of .mainContainer -->

	<section class="border-top has-default-focus is-hidden-interactive margin-top-sm ">



	<footer id="footer" data-bi-name="footer" class="footer-layout uhf-container has-padding" role="contentinfo">
	<div class="display-flex is-full-height has-padding-right-extra-large-desktop">
			<a data-mscc-ic="false" class="locale-selector-link button button-clear flex-shrink-0" href="/en-us/locale?target=https://docs.microsoft.com/en-us/previous-versions/ms997538%28v=msdn.10%29" data-bi-name="select-locale">
					<span class="icon" aria-hidden="true">
						<span class="docon docon-world"></span>
					</span>
					<span class="local-selector-link-text">English (United States)</span></a>
		<div class="margin-inline-xs flex-shrink-0">
<div class="dropdown has-caret-up">
	<button class="dropdown-trigger button button-clear button-sm has-inner-focus theme-dropdown-trigger" aria-controls="theme-menu" aria-expanded="false" title="Theme" data-bi-name="theme">
		<span class="icon">
			<span class="docon docon-sun" aria-hidden="true"></span>
		</span>
		<span>Theme</span>
	</button>
	<div class="dropdown-menu" id="theme-menu" role="menu">
		<ul class="theme-selector has-padding-small">
			<li class="theme display-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start is-selected" data-theme-to="light" aria-pressed="true">
					<span class="theme-light has-margin-right-small">
						<span class="theme-selector-icon css-variable-support border display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Light					</span>
				</button>
			</li>
			<li class="theme display-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="dark" aria-pressed="false">
					<span class="theme-dark has-margin-right-small">
						<span class="border theme-selector-icon css-variable-support display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
Dark					</span>
				</button>
			</li>
			<li class="theme display-block">
				<button class="button button-clear button-sm theme-control button-block justify-content-flex-start" data-theme-to="high-contrast" aria-pressed="false">
					<span class="theme-high-contrast has-margin-right-small">
						<span class="border theme-selector-icon css-variable-support display-inline-block has-body-background" aria-hidden="true">
							<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
								<rect width="22" height="14" class="has-fill-body-background"/>
								<rect x="5" y="5" width="12" height="4" class="has-fill-secondary"/>
								<rect x="5" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="8" y="2" width="2" height="1" class="has-fill-secondary"/>
								<rect x="11" y="2" width="3" height="1" class="has-fill-secondary"/>
								<rect x="1" y="1" width="2" height="2" class="has-fill-secondary"/>
								<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary"/>
								<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary"/>
							</svg>
						</span>
					</span>
					<span role="menuitem">
High contrast					</span>
				</button>
			</li>
		</ul>
	</div>
</div>
		</div>
	</div>
	<ul class="links" data-bi-name="footerlinks">
		<li class="manage-cookies-holder" hidden=""></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/previous-versions/" data-bi-name="archivelink">Previous Version Docs</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/teamblog" data-bi-name="bloglink">Blog</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/contribute" data-bi-name="contributorGuide">Contribute</a></li>
					<li><a data-mscc-ic="false" href="https://go.microsoft.com/fwlink/?LinkId=521839" data-bi-name="privacy">Privacy &amp; Cookies</a></li>
				<li><a data-mscc-ic="false" href="https://docs.microsoft.com/en-us/legal/termsofuse" data-bi-name="termsofuse">Terms of Use</a></li>
				<li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" data-bi-name="trademarks">Trademarks</a></li>
		<li>© Microsoft 2022</li>
	</ul>
</footer>
	</section>

	<div id="action-panel" role="region" aria-label="Action Panel" class="action-panel has-default-focus" tabindex="-1"></div>


</body></html>