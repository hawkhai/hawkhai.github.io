---
title : 自动快照存档
---

* TIME: 2021-08-12 00:02:04
* URL: <https://github.com/trendmicro/tlsh>

-----

Skip to content

[ ](https://github.com/)

[ Sign up
](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-
name%3E%2F%3Crepo-name%3E&source=header-repo)

  * Why GitHub? 

[Features →](/features)

    * [Mobile →](/mobile)
    * [Actions →](/features/actions)
    * [Codespaces →](/features/codespaces)
    * [Packages →](/features/packages)
    * [Security →](/features/security)
    * [Code review →](/features/code-review/)
    * [Issues →](/features/issues/)
    * [Integrations →](/features/integrations)
    * [GitHub Sponsors →](/sponsors)
    * [Customer stories→](/customer-stories)

  * [Team](/team)
  * [Enterprise](/enterprise)
  * Explore 

    * [Explore GitHub →](/explore)

#### Learn and contribute

    * [Topics →](/topics)
    * [Collections →](/collections)
    * [Trending →](/trending)
    * [Learning Lab →](https://lab.github.com/)
    * [Open source guides →](https://opensource.guide)

#### Connect with others

    * [The ReadME Project →](https://github.com/readme)
    * [Events →](https://github.com/events)
    * [Community forum →](https://github.community)
    * [GitHub Education →](https://education.github.com)
    * [GitHub Stars program →](https://stars.github.com)

  * [Marketplace](/marketplace)
  * Pricing 

[Plans →](/pricing)

    * [Compare plans →](/pricing#feature-comparison)
    * [Contact Sales →](https://enterprise.github.com/contact)
    * [Education →](https://education.github.com)

  * [ ![]() In this repository  All GitHub  ↵ Jump to ↵ ]()

  * No suggested jump to results

  * [ ![]() In this repository  All GitHub  ↵ Jump to ↵ ]()
  * [ ![]() In this organization  All GitHub  ↵ Jump to ↵ ]()
  * [ ![]() In this repository  All GitHub  ↵ Jump to ↵ ]()

[ Sign in ](/login?return_to=%2Ftrendmicro%2Ftlsh)

[ Sign up
](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-
name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=trendmicro%2Ftlsh)

{{ message }}

#  [trendmicro](/trendmicro) / **[tlsh](/trendmicro/tlsh) **

  * [ Notifications ](/login?return_to=%2Ftrendmicro%2Ftlsh)
  * [ Star ](/login?return_to=%2Ftrendmicro%2Ftlsh) [ 501 ](/trendmicro/tlsh/stargazers)
  * [ Fork ](/login?return_to=%2Ftrendmicro%2Ftlsh) [ 86 ](/trendmicro/tlsh/network/members)

[ View license ](/trendmicro/tlsh/blob/master/LICENSE)

[ 501 stars ](/trendmicro/tlsh/stargazers) [ 86 forks
](/trendmicro/tlsh/network/members)

[ Star ](/login?return_to=%2Ftrendmicro%2Ftlsh)

[ Notifications ](/login?return_to=%2Ftrendmicro%2Ftlsh)

  * [ Code ](/trendmicro/tlsh)
  * [ Issues 12 ](/trendmicro/tlsh/issues)
  * [ Pull requests 4 ](/trendmicro/tlsh/pulls)
  * [ Actions ](/trendmicro/tlsh/actions)
  * [ Projects 0 ](/trendmicro/tlsh/projects)
  * [ Wiki ](/trendmicro/tlsh/wiki)
  * [ Security ](/trendmicro/tlsh/security)
  * [ Insights ](/trendmicro/tlsh/pulse)

More

  * [ Code ](/trendmicro/tlsh)
  * [ Issues ](/trendmicro/tlsh/issues)
  * [ Pull requests ](/trendmicro/tlsh/pulls)
  * [ Actions ](/trendmicro/tlsh/actions)
  * [ Projects ](/trendmicro/tlsh/projects)
  * [ Wiki ](/trendmicro/tlsh/wiki)
  * [ Security ](/trendmicro/tlsh/security)
  * [ Insights ](/trendmicro/tlsh/pulse)

master

Switch branches/tags

Branches Tags

Could not load branches

Nothing to show

[ {{ refName }} default ](https://github.com/trendmicro/tlsh/tree/{{
urlEncodedRefName }}) [View all branches](/trendmicro/tlsh/branches)

Could not load tags

Nothing to show

[ {{ refName }} default ](https://github.com/trendmicro/tlsh/tree/{{
urlEncodedRefName }})

[View all tags](/trendmicro/tlsh/tags)

[ **3** branches ](/trendmicro/tlsh/branches) [ **15** tags
](/trendmicro/tlsh/tags)

[ Go to file ](/trendmicro/tlsh/find/master) Code

[ ](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone

HTTPS  GitHub CLI

Use Git or checkout with SVN using the web URL.

Work fast with our official CLI. [Learn more](https://cli.github.com).

  * [ Open with GitHub Desktop ](https://desktop.github.com)
  * [ Download ZIP ](/trendmicro/tlsh/archive/refs/heads/master.zip)

#### Launching GitHub Desktop

If nothing happens, [download GitHub Desktop](https://desktop.github.com/) and
try again.

Go back

#### Launching GitHub Desktop

If nothing happens, [download GitHub Desktop](https://desktop.github.com/) and
try again.

Go back

#### Launching Xcode

If nothing happens, [download Xcode](https://developer.apple.com/xcode/) and
try again.

Go back

#### Launching Visual Studio Code

Your codespace will open once ready.

There was a problem preparing your codespace, please try again.

## Latest commit

Jono and Jono
[**4.7.2**](/trendmicro/tlsh/commit/d842e7505573e9de7b7fe61775e412c040d4a3e8
"**4.7.2**

02/07/2021

        Release updated package py-tlsh on Pypi.org
        regression tests for C++ and Python functions for:
                lvalue, q1ratio, q2ratio, checksum, bucket_value
        resolve issue #95 - allow Requires-Python: >=2.7")

…

Loading status checks…

[ d842e75 ](/trendmicro/tlsh/commit/d842e7505573e9de7b7fe61775e412c040d4a3e8)
[ on 2 Jul ](/trendmicro/tlsh/commit/d842e7505573e9de7b7fe61775e412c040d4a3e8)

[**4.7.2**](/trendmicro/tlsh/commit/d842e7505573e9de7b7fe61775e412c040d4a3e8)

    
    
    02/07/2021
            Release updated package py-tlsh on Pypi.org
            regression tests for C++ and Python functions for:
                    lvalue, q1ratio, q2ratio, checksum, bucket_value
            resolve issue [#95](https://github.com/trendmicro/tlsh/issues/95) - allow Requires-Python: >=2.7

`d842e75`

## Git stats

  * [ **297** commits  ](/trendmicro/tlsh/commits/master)

## Files

[Permalink](/trendmicro/tlsh/tree/d842e7505573e9de7b7fe61775e412c040d4a3e8)

Failed to load latest commit information.

Type

Name

Latest commit message

Commit time

[Testing](/trendmicro/tlsh/tree/master/Testing "Testing")

[**4.7.1**](/trendmicro/tlsh/commit/23e7a9baddb42d14168b5b32574aca7dbbfab732
"**4.7.1**

02/07/2021

        Release updated package py-tlsh on Pypi.org
        regression tests for C++ and Python functions for:
                lvalue, q1ratio, q2ratio, checksum, bucket_value")

last month

[Windows](/trendmicro/tlsh/tree/master/Windows "Windows")

[resolve
issue](/trendmicro/tlsh/commit/60e8cdc90d3aa9b49be7dcaff08588f21e724be3
"resolve issue #58 version-specific tlsh solution files not found for Windows

**3.13.0**

31/May/2019

.vcproj files and instructions for builing TLSH on Windows using Visual Studio

Thanks Jayson Pryde! :-\)")
[#58](https://github.com/trendmicro/tlsh/issues/58) [version-specific tlsh
solution files not found for
…](/trendmicro/tlsh/commit/60e8cdc90d3aa9b49be7dcaff08588f21e724be3 "resolve
issue #58 version-specific tlsh solution files not found for Windows

**3.13.0**

31/May/2019

.vcproj files and instructions for builing TLSH on Windows using Visual Studio

Thanks Jayson Pryde! :-\)")

2 years ago

[docs](/trendmicro/tlsh/tree/master/docs "docs")

[make tlsh.org main
website](/trendmicro/tlsh/commit/1d3dd560f7001576be3ad100b3c9c5c5415c9e5c
"make tlsh.org main website")

8 months ago

[include](/trendmicro/tlsh/tree/master/include "include")

[**4.7.2**](/trendmicro/tlsh/commit/d842e7505573e9de7b7fe61775e412c040d4a3e8
"**4.7.2**

02/07/2021

        Release updated package py-tlsh on Pypi.org
        regression tests for C++ and Python functions for:
                lvalue, q1ratio, q2ratio, checksum, bucket_value
        resolve issue #95 - allow Requires-Python: >=2.7")

last month

[java](/trendmicro/tlsh/tree/master/java "java")

[Java fix for
issue](/trendmicro/tlsh/commit/0034af2b817dea883e88c8e18cda99cfbc25207d "Java
fix for issue #99

* Update TLSH Java implementation to understand new TLSH version data
* Partial fix for issue #84 to allow TLSH on files up to 4GiB
* Fix unit tests to work with new test data files
* Remove bintray hosting as it is being shut down") [#99](https://github.com/trendmicro/tlsh/issues/99)

4 months ago

[js_ext](/trendmicro/tlsh/tree/master/js_ext "js_ext")

[Fix tmpArray is
undefined](/trendmicro/tlsh/commit/7ff1d9d0fdade3a8d09910a2981ec9f00c4f7108
"Fix tmpArray is undefined

When running this in the latest chrome I got an undefined error for tmpArray.
Defining it with let resolves the error.")

11 months ago

[mingw](/trendmicro/tlsh/tree/master/mingw "mingw")

[**4.2.0**](/trendmicro/tlsh/commit/a2ca14c3008d40805dabcfd48991fff1fc7d915e
"**4.2.0**

26/March/2020

        Windows version using minGW")

17 months ago

[py_ext](/trendmicro/tlsh/tree/master/py_ext "py_ext")

[**4.7.2**](/trendmicro/tlsh/commit/d842e7505573e9de7b7fe61775e412c040d4a3e8
"**4.7.2**

02/07/2021

        Release updated package py-tlsh on Pypi.org
        regression tests for C++ and Python functions for:
                lvalue, q1ratio, q2ratio, checksum, bucket_value
        resolve issue #95 - allow Requires-Python: >=2.7")

last month

[register](/trendmicro/tlsh/tree/master/register "register")

[add registering
script](/trendmicro/tlsh/commit/29d6bfd25713fc03c6bb6e4744e5ee9501a6356c "add
registering script")

4 years ago

[src](/trendmicro/tlsh/tree/master/src "src")

[**4.3.0**](/trendmicro/tlsh/commit/258f4d878e215186564331d3a80a1a762c907ada
"**4.3.0**

26/June/2020

        issue #79 - divide by 0 if q3 == 0
                solution. if \(q3 == 0\) return invalid hash")

14 months ago

[test](/trendmicro/tlsh/tree/master/test "test")

[**4.7.1**](/trendmicro/tlsh/commit/23e7a9baddb42d14168b5b32574aca7dbbfab732
"**4.7.1**

02/07/2021

        Release updated package py-tlsh on Pypi.org
        regression tests for C++ and Python functions for:
                lvalue, q1ratio, q2ratio, checksum, bucket_value")

last month

[tlsh_bh_tool](/trendmicro/tlsh/tree/master/tlsh_bh_tool "tlsh_bh_tool")

[remove .DS_Store (should never have been checked
in)](/trendmicro/tlsh/commit/33f0bf62293bd1cdfca2956f2ff6b0bbeb9a4ae7 "remove
.DS_Store \(should never have been checked in\)")

2 years ago

[utils](/trendmicro/tlsh/tree/master/utils "utils")

[**4.0.0**](/trendmicro/tlsh/commit/dc3f047fbc3e78f587ed63c31cbe788acd9d1aac
"**4.0.0**

26/March/2020

version 4: adding version identifier to each digest: 'T1'

        adding command line option -old to generate old style digests
        In this version - the showvers is defaulted to off - so this will pass the old regression tests")

17 months ago

[.gitignore](/trendmicro/tlsh/blob/master/.gitignore ".gitignore")

[(1) clean up the python library as
well](/trendmicro/tlsh/commit/0ba91c44040b4748fd8853d73d41a346dab2e55e "\(1\)
clean up the python library as well

\(2\) add a newline to the last line of the .gitignore file")

4 years ago

[.travis.yml](/trendmicro/tlsh/blob/master/.travis.yml ".travis.yml")

[Add architecture ppc64le to travis
build](/trendmicro/tlsh/commit/3979f01925cd9bd511468078019188b54759cc64 "Add
architecture ppc64le to travis build")

8 months ago

[2015_Euro_DFRWS_Criteria_Sim_Digests.pdf](/trendmicro/tlsh/blob/master/2015_Euro_DFRWS_Criteria_Sim_Digests.pdf
"2015_Euro_DFRWS_Criteria_Sim_Digests.pdf")

[added
2015_Euro_DFRWS_Criteria_Sim_Digests.pdf](/trendmicro/tlsh/commit/f57ffc20164a23bedd4f0158f2dd29c89a23c349
"added 2015_Euro_DFRWS_Criteria_Sim_Digests.pdf")

17 months ago

[Attacking_LSH_and_Sim_Dig.pdf](/trendmicro/tlsh/blob/master/Attacking_LSH_and_Sim_Dig.pdf
"Attacking_LSH_and_Sim_Dig.pdf")

[Update TLSH
documents](/trendmicro/tlsh/commit/f1b495384be4f0b50760db5b6fb8ed649eba9586
"Update TLSH documents")

6 years ago

[CMakeLists.txt](/trendmicro/tlsh/blob/master/CMakeLists.txt "CMakeLists.txt")

[**4.7.2**](/trendmicro/tlsh/commit/d842e7505573e9de7b7fe61775e412c040d4a3e8
"**4.7.2**

02/07/2021

        Release updated package py-tlsh on Pypi.org
        regression tests for C++ and Python functions for:
                lvalue, q1ratio, q2ratio, checksum, bucket_value
        resolve issue #95 - allow Requires-Python: >=2.7")

last month

[Change_History.md](/trendmicro/tlsh/blob/master/Change_History.md
"Change_History.md")

[**4.7.2**](/trendmicro/tlsh/commit/d842e7505573e9de7b7fe61775e412c040d4a3e8
"**4.7.2**

02/07/2021

        Release updated package py-tlsh on Pypi.org
        regression tests for C++ and Python functions for:
                lvalue, q1ratio, q2ratio, checksum, bucket_value
        resolve issue #95 - allow Requires-Python: >=2.7")

last month

[DFRWS_Similarity_Digests.pdf](/trendmicro/tlsh/blob/master/DFRWS_Similarity_Digests.pdf
"DFRWS_Similarity_Digests.pdf")

[add DFRWS](/trendmicro/tlsh/commit/944619b7e2bbfafac2219a5943ecfd207f06f1e6
"add DFRWS")

5 years ago

[LICENSE](/trendmicro/tlsh/blob/master/LICENSE "LICENSE")

[**3.9.2**](/trendmicro/tlsh/commit/e0fe484ca081791e2e5cca77db3c6298179ec30a
"**3.9.2**

18/Mar/2019

Also merged the contents of NOTICE.txt into LICENSE.

This was done because NOTICE.txt is sometimes accidently removed when people
clone this repository.

And the LICENSE specifically states that NOTICE.txt should NOT be removed.

Also added command line option -notice which displays the NOTICE.txt file")

2 years ago

[NOTICE.txt](/trendmicro/tlsh/blob/master/NOTICE.txt "NOTICE.txt")

[**3.9.2**](/trendmicro/tlsh/commit/e0fe484ca081791e2e5cca77db3c6298179ec30a
"**3.9.2**

18/Mar/2019

Also merged the contents of NOTICE.txt into LICENSE.

This was done because NOTICE.txt is sometimes accidently removed when people
clone this repository.

And the LICENSE specifically states that NOTICE.txt should NOT be removed.

Also added command line option -notice which displays the NOTICE.txt file")

2 years ago

[PUBLIC.txt](/trendmicro/tlsh/blob/master/PUBLIC.txt "PUBLIC.txt")

[now released as
public](/trendmicro/tlsh/commit/417d899b282aac87bf275e872f9ff8f7588ceea2 "now
released as public")

8 years ago

[README.md](/trendmicro/tlsh/blob/master/README.md "README.md")

[**4.7.2**](/trendmicro/tlsh/commit/d842e7505573e9de7b7fe61775e412c040d4a3e8
"**4.7.2**

02/07/2021

        Release updated package py-tlsh on Pypi.org
        regression tests for C++ and Python functions for:
                lvalue, q1ratio, q2ratio, checksum, bucket_value
        resolve issue #95 - allow Requires-Python: >=2.7")

last month

[README.mingw](/trendmicro/tlsh/blob/master/README.mingw "README.mingw")

[**4.2.0**](/trendmicro/tlsh/commit/a2ca14c3008d40805dabcfd48991fff1fc7d915e
"**4.2.0**

26/March/2020

        Windows version using minGW")

17 months ago

[README.python](/trendmicro/tlsh/blob/master/README.python "README.python")

[**3.13.1**](/trendmicro/tlsh/commit/cc164247fec45f0f21a6256d29a98d82d9f6d84e
"**3.13.1**

31/May/2019

fixing setup.py so that you can install Python Extension on Windows")

2 years ago

[README.windows](/trendmicro/tlsh/blob/master/README.windows "README.windows")

[resolve
issue](/trendmicro/tlsh/commit/60e8cdc90d3aa9b49be7dcaff08588f21e724be3
"resolve issue #58 version-specific tlsh solution files not found for Windows

**3.13.0**

31/May/2019

.vcproj files and instructions for builing TLSH on Windows using Visual Studio

Thanks Jayson Pryde! :-\)")
[#58](https://github.com/trendmicro/tlsh/issues/58) [version-specific tlsh
solution files not found for
…](/trendmicro/tlsh/commit/60e8cdc90d3aa9b49be7dcaff08588f21e724be3 "resolve
issue #58 version-specific tlsh solution files not found for Windows

**3.13.0**

31/May/2019

.vcproj files and instructions for builing TLSH on Windows using Visual Studio

Thanks Jayson Pryde! :-\)")

2 years ago

[TLSH_CTC_final.pdf](/trendmicro/tlsh/blob/master/TLSH_CTC_final.pdf
"TLSH_CTC_final.pdf")

[fixed minor formatting
error](/trendmicro/tlsh/commit/fc10c054f34f0cb233a5497396e6d8756391e645 "fixed
minor formatting error")

4 years ago

[TLSH_Introduction.pdf](/trendmicro/tlsh/blob/master/TLSH_Introduction.pdf
"TLSH_Introduction.pdf")

[Jon: fixed typo in introduction
PPT](/trendmicro/tlsh/commit/938778e5e7ebfa1ab44eaab5d6e7fd7ec44f91d5 "Jon:
fixed typo in introduction PPT")

8 years ago

[clean.sh](/trendmicro/tlsh/blob/master/clean.sh "clean.sh")

[**4.2.0**](/trendmicro/tlsh/commit/a2ca14c3008d40805dabcfd48991fff1fc7d915e
"**4.2.0**

26/March/2020

        Windows version using minGW")

17 months ago

[clean_mingw.bat](/trendmicro/tlsh/blob/master/clean_mingw.bat
"clean_mingw.bat")

[**4.2.0**](/trendmicro/tlsh/commit/a2ca14c3008d40805dabcfd48991fff1fc7d915e
"**4.2.0**

26/March/2020

        Windows version using minGW")

17 months ago

[make.sh](/trendmicro/tlsh/blob/master/make.sh "make.sh")

[**4.7.1**](/trendmicro/tlsh/commit/23e7a9baddb42d14168b5b32574aca7dbbfab732
"**4.7.1**

02/07/2021

        Release updated package py-tlsh on Pypi.org
        regression tests for C++ and Python functions for:
                lvalue, q1ratio, q2ratio, checksum, bucket_value")

last month

[make_mingw.bat](/trendmicro/tlsh/blob/master/make_mingw.bat "make_mingw.bat")

[**4.2.0**](/trendmicro/tlsh/commit/a2ca14c3008d40805dabcfd48991fff1fc7d915e
"**4.2.0**

26/March/2020

        Windows version using minGW")

17 months ago

View code

TLSH - Trend Micro Locality Sensitive Hash What's New in TLSH 4.x.x Dedication
Minimum byte stream length Computed hash Executables and library Ports
Downloading TLSH Building TLSH Linux Windows (MinGW) Windows (Visual Studio)
Using TLSH in Python Python Package Python Extension Python Usage Python
Example Python Extra Options Python Backwards Compatibility Options Design
Choices Publications Current Version Change History

##  README.md

[![Build
Status](https://camo.githubusercontent.com/24ee62a2c3a1183f0b2bb98a5213ce50a9d8bfe1c9c7cc86d9af670f8a40f58d/68747470733a2f2f7472617669732d63692e6f72672f7472656e646d6963726f2f746c73682e7376673f6272616e63683d6d6173746572)](https://travis-
ci.org/trendmicro/tlsh/)

# TLSH - Trend Micro Locality Sensitive Hash

TLSH is a fuzzy matching library. Given a byte stream with a minimum length of
50 bytes TLSH generates a hash value which can be used for similarity
comparisons. Similar objects will have similar hash values which allows for
the detection of similar objects by comparing their hash values. Note that the
byte stream should have a sufficient amount of complexity. For example, a byte
stream of identical bytes will not generate a hash value.

## What's New in TLSH 4.x.x

02/July/2021  
Release version 4.7.1 Updated Python realease with additional functions:

  * lvalue
  * q1ratio
  * q2ratio
  * checksum
  * bucket_value
  * is_valid

23/April/2021  
Release version 4.6.0 Issue 99 raised issues about what to do when evaluating
the TLSH for files over 4GB We decided to define that TLSH is the TLSH of the
first 4GB of a file

14/April/2021  
We have written technical material that focuses on 2 topics at
[https://tlsh.org](https://tlsh.org/)

  * fast nearest neighbour search and scalable clustering
  * robustness to attack

2020

  * adopted by [Virus Total](https://developers.virustotal.com/v3.0/reference#files-tlsh)
  * adopted by [Malware Bazaar](https://bazaar.abuse.ch/api/#tlsh)

26/March/2020

  * adding version identifier to the digest
  * added output options (-o)
  * added json object output (-ojson)
  * added null digest (TNULL)

TLSH has gained some traction. It has been included in STIX 2.1 and been
ported to a number of langauges.

We are adding a version identifier ("T1") to the start of the digest so that
we can cleary distinguish between different variants of the digest (such as
non-standard choices of 3 byte checksum). This means that we do not rely on
the length of the hex string to determine if a hex string is a TLSH digest
(this is a brittle method for identifying TLSH digests). We are doing this to
enable compatibility, especially backwards compatibility of the TLSH approach.

This release will add "T1" to the start of TLSH digests. The code is backwards
compatible, it can still read and interpret 70 hex character strings as TLSH
digests. And data sets can include mixes of the old and new digests. If you
need old style TLSH digests to be outputted, then use the command line option
'-old'

## Dedication

Thanks to Chun Cheng, who was a humble and talented engineer.

## Minimum byte stream length

The program in default mode requires an input byte stream with a minimum
length of 50 bytes (and a minimum amount of randomness - see note in Python
extension below).

For consistency with older versions, there is a -conservative option which
enforces a 256 byte limit. See notes for version 3.17.0 of TLSH

## Computed hash

The computed hash is 35 bytes of data (output as 'T1' followed 70 hexidecimal
characters. Total length 72 characters). The 'T1' has been added as a version
number for the hash - so that we can adapt the algorithm and still maintain
backwards compatibility. To get the old style 70 hex hashes, use the -old
command line option.

Bytes 3,4,5 are used to capture the information about the file as a whole
(length, ...), while the last 32 bytes are used to capture information about
incremental parts of the file. (Note that the length of the hash can be
increased by changing build parameters described below in
[CMakeLists.txt](/trendmicro/tlsh/blob/master/CMakeLists.txt), which will
increase the information stored in the hash. For some applications this might
increase the accuracy in predicting similarities between files.)

## Executables and library

Building TLSH (see below) will create a static library in the `lib` directory,
and the `tlsh` executable (a symbolic link to `tlsh_unittest`). 'tlsh' links
to the static library, in the `bin` directory. The library has functionality
to generate the hash value from a given file, and to compute the similarity
between two hash values.

`tlsh` is a utility for generating TLSH hash values and comparing TLSH hash
values to determine similarity. Run it with no parameters for detailed usage.

## Ports

  * A JavaScript port available in the `js_ext` directory.
  * A Java port is available in the `java` directory.
  * Another Java port is available [here](https://github.com/idealista/tlsh).
  * A Golang port is available [here](https://github.com/glaslos/tlsh).
  * A Ruby port is available [here](https://github.com/adamliesko/tlsh)

# Downloading TLSH

Download TLSH as follows:

    
    
    wget https://github.com/trendmicro/tlsh/archive/master.zip -O master.zip
    unzip master.zip
    cd tlsh-master
    

**or**

    
    
    git clone git://github.com/trendmicro/tlsh.git
    cd tlsh
    git checkout master
    

# Building TLSH

Edit [CMakeLists.txt](/trendmicro/tlsh/blob/master/CMakeLists.txt) to build
TLSH with different options.

  * TLSH_BUCKETS: determines using 128 or 256 buckets use the default 128 buckets unless you are an expert and know you need 256 buckets
  * TLSH_CHECKSUM_1B: determines checksum length, longer means less collision use the default 1 byte unless you are an expert and know you need a larger checksum

## Linux

Execute:

    
    
    make.sh
    

**Note:** _Building TLSH on Linux depends upon`cmake` to create the `Makefile`
and then `make` the project, so the build will fail if `cmake` is not
installed._

## Windows (MinGW)

Added in March 2020. See the instructions in README.mingw

## Windows (Visual Studio)

Use the version-specific tlsh solution files
([tlsh.VC2005.sln](/trendmicro/tlsh/blob/master/Windows/tlsh.VC2005.sln),
[tlsh.VC2008.sln](/trendmicro/tlsh/blob/master/Windows/tlsh.VC2008.sln), ...)
under the Windows directory.

See [tlsh.h](/trendmicro/tlsh/blob/master/include/tlsh.h) for the tlsh library
interface and
[tlsh_unittest.cpp](/trendmicro/tlsh/blob/master/test/tlsh_unittest.cpp) and
[simple_unittest.cpp](/trendmicro/tlsh/blob/master/test/simple_unittest.cpp)
under the `test` directory for example code.

## Using TLSH in Python

### Python Package

We have recently created a Python package on PyPi:
<https://pypi.org/project/py-tlsh/>  
The py-tlsh replaces the python-tlsh package. For details see [issue
94](https://github.com/trendmicro/tlsh/issues/94)  
To install this package

    
    
    	$  pip install py-tlsh
    

### Python Extension

If you need to build your own Python package, then there is a README.python
with notes about the python version

    
    
    (1) compile the C++ code
    	$./make.sh
    (2) build the python version
    	$ cd py_ext/
    	$ python ./setup.py build
    (3) install - possibly - sudo, run as root or administrator
    	$ python ./setup.py install
    (4) test it
    	$ cd ../Testing
    	$ ./python_test.sh
    

#### Python Usage

    
    
    import tlsh
    
    tlsh.hash(data)

Note data needs to be bytes - not a string. This is because TLSH is for binary
data and binary data can contain a NULL (zero) byte.

In default mode the data must contain at least 50 bytes to generate a hash
value and that it must have a certain amount of randomness. To get the hash
value of a file, try

    
    
    tlsh.hash(open(file, 'rb').read())

Note: the open statement has opened the file in binary mode.

#### Python Example

    
    
    import tlsh
    
    h1 = tlsh.hash(data)
    h2 = tlsh.hash(similar_data)
    score = tlsh.diff(h1, h2)
    
    h3 = tlsh.Tlsh()
    with open('file', 'rb') as f:
        for buf in iter(lambda: f.read(512), b''):
            h3.update(buf)
        h3.final()
    # this assertion is stating that the distance between a TLSH and itself must be zero
    assert h3.diff(h3) == 0
    score = h3.diff(h1)

#### Python Extra Options

The `diffxlen` function removes the file length component of the tlsh header
from the comparison.

    
    
    tlsh.diffxlen(h1, h2)

If a file with a repeating pattern is compared to a file with only a single
instance of the pattern, then the difference will be increased if the file
lenght is included. But by using the `diffxlen` function, the file length will
be removed from consideration.

#### Python Backwards Compatibility Options

If you use the "conservative" option, then the data must contain at least 256
characters. For example,

    
    
    import os
    tlsh.conservativehash(os.urandom(256))

should generate a hash, but

    
    
    tlsh.conservativehash(os.urandom(100))

will generate TNULL as it is less than 256 bytes.

If you need to generate old style hashes (without the "T1" prefix) then use

    
    
    tlsh.oldhash(os.urandom(100))

The old and conservative options may be combined:

    
    
    tlsh.oldconservativehash(os.urandom(500))

# Design Choices

  * To improve comparison accuracy, TLSH tracks counting bucket height distribution in quartiles. Bigger quartile difference results in higher difference score.
  * Use specially 6 trigrams to give equal representation of the bytes in the 5 byte sliding window which produces improved results.
  * Pearson hash is used to distribute the trigram counts to the counting buckets.
  * The global similarity score distances objects with significant size difference. Global similarity can be disabled. It also distances objects with different quartile distributions.
  * TLSH can be compiled to generate 70 or 134 characters hash strings. The longer version has been created to use of the 70 char hash strings is not working for your application.

TLSH similarity is expressed as a difference score:

  * A score of 0 means the objects are almost identical.
  * For the 72 characters hash, there is a detailed table of experimental Detection rates and False Positive rates based on the threshhold. see [Table II on page 5](https://github.com/trendmicro/tlsh/blob/master/TLSH_CTC_final.pdf)

# Publications

  * Jonathan Oliver, Chun Cheng, and Yanggui Chen, [TLSH - A Locality Sensitive Hash](https://github.com/trendmicro/tlsh/blob/master/TLSH_CTC_final.pdf). 4th Cybercrime and Trustworthy Computing Workshop, Sydney, November 2013
  * Jonathan Oliver, Scott Forman, and Chun Cheng, [Using Randomization to Attack Similarity Digests](https://github.com/trendmicro/tlsh/blob/master/Attacking_LSH_and_Sim_Dig.pdf). ATIS 2014, November, 2014, pages 199-210

# Current Version

**4.7.2**

    
    
    02/07/2021
    	Release updated package py-tlsh on Pypi.org
    	regression tests for C++ and Python functions for:
    		lvalue, q1ratio, q2ratio, checksum, bucket_value
    	resolve issue #95 - allow Requires-Python: >=2.7
    

# Change History

see [Change_History.md](/trendmicro/tlsh/blob/master/Change_History.md)

## About

No description, website, or topics provided.

### Resources

Readme

### License

[ View license ](/trendmicro/tlsh/blob/master/LICENSE)

##  [ Releases 15 ](/trendmicro/tlsh/releases)

[ 4.2.1 release (also includes tlsh.exe for Windows) Latest  on 27 Mar 2020
](/trendmicro/tlsh/releases/tag/4.2.1)

[ \+ 14 releases ](/trendmicro/tlsh/releases)

##  [ Packages 0 ](/orgs/trendmicro/packages?repo_name=tlsh)

No packages published  

##  [ Used by 12
](/trendmicro/tlsh/network/dependents?package_id=UGFja2FnZS00NDczNjQ1NTE%3D)

[

  * ![@FRidh](https://avatars.githubusercontent.com/u/2129135?s=88&v=4)
  * ![@BuildForSDGCohort2](https://avatars.githubusercontent.com/u/68904251?s=88&v=4)
  * ![@rami0208](https://avatars.githubusercontent.com/u/64422842?s=88&v=4)
  * ![@Sharmelen](https://avatars.githubusercontent.com/u/33871504?s=88&v=4)
  * ![@crazyzete](https://avatars.githubusercontent.com/u/45296698?s=88&u=911baae646b1d4be4122154b72741c9d22485486&v=4)
  * ![@vibhu18116](https://avatars.githubusercontent.com/u/43749855?s=88&v=4)
  * ![@liuyanqi](https://avatars.githubusercontent.com/u/7076268?s=88&u=ec78b00bd22dcdb54d4af15b1b62bf9d89680379&v=4)
  * ![@bnewbold](https://avatars.githubusercontent.com/u/130077?s=88&v=4)

\+ 4
](/trendmicro/tlsh/network/dependents?package_id=UGFja2FnZS00NDczNjQ1NTE%3D)

##  [ Contributors 22 ](/trendmicro/tlsh/graphs/contributors)

  * [ ![@vichargrave](https://avatars.githubusercontent.com/u/260028?v=4) ](https://github.com/vichargrave)
  * [ ![@chuncheng](https://avatars.githubusercontent.com/u/4064113?v=4) ](https://github.com/chuncheng)
  * [ ![@jonjoliver](https://avatars.githubusercontent.com/u/4505330?v=4) ](https://github.com/jonjoliver)
  * [ ![@Scott4man](https://avatars.githubusercontent.com/u/1845212?v=4) ](https://github.com/Scott4man)
  * [ ![@jaysonpryde](https://avatars.githubusercontent.com/u/4818451?v=4) ](https://github.com/jaysonpryde)
  * [ ![@yan99ui](https://avatars.githubusercontent.com/u/2982731?v=4) ](https://github.com/yan99ui)
  * [ ![@mrpolyonymous](https://avatars.githubusercontent.com/u/12860442?v=4) ](https://github.com/mrpolyonymous)
  * [ ![@anthraxx](https://avatars.githubusercontent.com/u/203012?v=4) ](https://github.com/anthraxx)
  * [ ![@Rafiot](https://avatars.githubusercontent.com/u/248875?v=4) ](https://github.com/Rafiot)
  * [ ![@sschuberth](https://avatars.githubusercontent.com/u/349154?v=4) ](https://github.com/sschuberth)
  * [ ![@peteroptional](https://avatars.githubusercontent.com/u/12720574?v=4) ](https://github.com/peteroptional)

[ \+ 11 contributors ](/trendmicro/tlsh/graphs/contributors)

## Languages

  * [ C++ 58.1% ](/trendmicro/tlsh/search?l=c%2B%2B)
  * [ Java 11.8% ](/trendmicro/tlsh/search?l=java)
  * [ Roff 10.8% ](/trendmicro/tlsh/search?l=roff)
  * [ Shell 5.9% ](/trendmicro/tlsh/search?l=shell)
  * [ Python 3.0% ](/trendmicro/tlsh/search?l=python)
  * [ JavaScript 2.9% ](/trendmicro/tlsh/search?l=javascript)
  * Other 7.5%

  * © 2021 GitHub, Inc.
  * [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
  * [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
  * [Security](https://github.com/security)
  * [Status](https://www.githubstatus.com/)
  * [Docs](https://docs.github.com)

[ ](https://github.com "GitHub")

  * [Contact GitHub](https://support.github.com)
  * [Pricing](https://github.com/pricing)
  * [API](https://docs.github.com)
  * [Training](https://services.github.com)
  * [Blog](https://github.blog)
  * [About](https://github.com/about)

You can’t perform that action at this time.

You signed in with another tab or window. [Reload]() to refresh your session.
You signed out in another tab or window. [Reload]() to refresh your session.

