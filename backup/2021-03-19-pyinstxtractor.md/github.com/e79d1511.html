---
title : Ëá™Âä®Âø´ÁÖßÂ≠òÊ°£
---

* TIME: 2022-10-11 12:06:09
* URL: <https://github.com/chriskiehl/Gooey/issues/520>

-----

Skip to content Toggle navigation

[ ](https://github.com/)

[ Sign up
](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-
name%3E%2F%3Crepo-
name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo)

  * Product 

    * [ Actions Automate any workflow  ](/features/actions)
    * [ Packages Host and manage packages  ](/features/packages)
    * [ Security Find and fix vulnerabilities  ](/features/security)
    * [ Codespaces Instant dev environments  ](/features/codespaces)
    * [ Copilot Write better code with AI  ](/features/copilot)
    * [ Code review Manage code changes  ](/features/code-review)
    * [ Issues Plan and track work  ](/features/issues)
    * [ Discussions Collaborate outside of code  ](/features/discussions)
    * Explore
    * [ All features ](/features)
    * [ Documentation  ](https://docs.github.com)
    * [ GitHub Skills  ](https://skills.github.com/)
    * [ Blog  ](https://github.blog)

  * Solutions 

    * By Plan
    * [ Enterprise ](/enterprise)
    * [ Teams ](/team)
    * [ Compare all ](/pricing#compare-features)
    * By Solution
    * [ CI/CD & Automation  ](https://resources.github.com/ci-cd/)
    * [ DevOps  ](https://resources.github.com/devops/)
    * [ DevSecOps  ](https://resources.github.com/devops/fundamentals/devsecops/)
    * Case Studies
    * [ Customer Stories ](/customer-stories)
    * [ Resources  ](https://resources.github.com/)

  * Open Source 

    * [ GitHub Sponsors Fund open source developers  ](/sponsors)
    * [ The ReadME Project GitHub community articles  ](/readme)
    * Repositories
    * [ Topics ](/topics)
    * [ Trending ](/trending)
    * [ Collections ](/collections)

  * [Pricing](/pricing)

  * [ ![]() In this repository  All GitHub  ‚Üµ Jump to ‚Üµ ]()

  * No suggested jump to results

  * [ ![]() In this repository  All GitHub  ‚Üµ Jump to ‚Üµ ]()
  * [ ![]() In this user  All GitHub  ‚Üµ Jump to ‚Üµ ]()
  * [ ![]() In this repository  All GitHub  ‚Üµ Jump to ‚Üµ ]()

[ Sign in
](/login?return_to=https%3A%2F%2Fgithub.com%2Fchriskiehl%2FGooey%2Fissues%2F520)

[ Sign up
](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-
name%3E%2F%3Crepo-
name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-
repo&source_repo=chriskiehl%2FGooey)

{{ message }}

[chriskiehl](/chriskiehl) / **[Gooey](/chriskiehl/Gooey) ** Public

  * [ Notifications ](/login?return_to=%2Fchriskiehl%2FGooey)
  * [ Fork 913 ](/login?return_to=%2Fchriskiehl%2FGooey)
  * [ Star  16.8k ](/login?return_to=%2Fchriskiehl%2FGooey)

  * [ Code ](/chriskiehl/Gooey)
  * [ Issues 110 ](/chriskiehl/Gooey/issues)
  * [ Pull requests 25 ](/chriskiehl/Gooey/pulls)
  * [ Discussions ](/chriskiehl/Gooey/discussions)
  * [ Actions ](/chriskiehl/Gooey/actions)
  * [ Projects 0 ](/chriskiehl/Gooey/projects)
  * [ Wiki ](/chriskiehl/Gooey/wiki)
  * [ Security ](/chriskiehl/Gooey/security)
  * [ Insights ](/chriskiehl/Gooey/pulse)

More

  * [ Code ](/chriskiehl/Gooey)
  * [ Issues ](/chriskiehl/Gooey/issues)
  * [ Pull requests ](/chriskiehl/Gooey/pulls)
  * [ Discussions ](/chriskiehl/Gooey/discussions)
  * [ Actions ](/chriskiehl/Gooey/actions)
  * [ Projects ](/chriskiehl/Gooey/projects)
  * [ Wiki ](/chriskiehl/Gooey/wiki)
  * [ Security ](/chriskiehl/Gooey/security)
  * [ Insights ](/chriskiehl/Gooey/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to
open an issue and contact its maintainers and the community.

Pick a username

    

Email Address

    

Password

    
Sign up for GitHub

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of
service](https://docs.github.com/terms) and [privacy
statement](https://docs.github.com/privacy). We‚Äôll occasionally send you
account related emails.

Already on GitHub? [Sign
in](/login?return_to=%2Fchriskiehl%2FGooey%2Fissues%2Fnew) to your account

Jump to bottom

#  Non-ASCII output hangs execution in PyInstaller packaged app #520

Closed

[simplynail](/simplynail) opened this issue on 4 Jan 2020 ¬∑ 11 comments

Closed

#  Non-ASCII output hangs execution in PyInstaller packaged app  #520

[simplynail](/simplynail) opened this issue on 4 Jan 2020 ¬∑ 11 comments

## Comments

[![@simplynail](https://avatars.githubusercontent.com/u/13271756?s=80&u=1f83623f4c1a4ff4dc371db595c5fef8798cc17c&v=4)](/simplynail)

Copy link

###  **[simplynail](/simplynail) ** commented on 4 Jan 2020

  * [Windows 10] OS
  * [3.7.3 ] Python Version
  * [1.0.3] Gooey Version
  * [3.5] PyInstaller

Hi,  
I'm having problem with running Gooey app packaged with PyInstaller. App
prints some outputs to multi line textbox in "execution screen" but then
hangs.  
App runs with no issues when running it non-packaged.  
I dug into it and appears the problem is with further printing to multi line
box.

Traceback:

    
    
    Exception in thread Thread-1:
    Traceback (most recent call last):
      File "threading.py", line 917, in _bootstrap_inner
      File "threading.py", line 865, in run
      File "lib\site-packages\gooey\gui\processor.py", line 71, in _forward_stdout
      File "lib\site-packages\gooey\gui\processor.py", line 84, in _extract_progress
    UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 16: invalid continuation byte
    

Changing `stdout` to the following fixed the problem:

    
    
    utf8_stdout = os.fdopen(sys.stdout.fileno(), mode='w', encoding='utf-8', closefd=False)
    sys.stdout = utf8_stdout
    

The issue seems to be related to this closed issue
[#230](https://github.com/chriskiehl/Gooey/issues/230)  
  
---  
  
The text was updated successfully, but these errors were encountered:

  
  
All reactions

[![@simplynail](https://avatars.githubusercontent.com/u/13271756?s=80&u=1f83623f4c1a4ff4dc371db595c5fef8798cc17c&v=4)](/simplynail)

Copy link

Author

###  **[simplynail](/simplynail) ** commented on 6 Jan 2020

actually the problem still stands, as I would like to package app to one file
with no console.  
applying the fix to sys.stdout (mentioned above) helps just for building
`--onefile` without `--noconsole` flag  
however with `--noconsole` flag, Gooey doesn't even start because I get

> Fatal error: failed to execute script  
  
---  
  
üëç 2 maxhaz and Podolyan98 reacted with thumbs up emoji All reactions

  * üëç 2 reactions

Sorry, something went wrong.

[![@maxhaz](https://avatars.githubusercontent.com/u/8924271?s=80&u=5d99e152639dbc1e88de1d0918caf793032edab2&v=4)](/maxhaz)

Copy link

###  **[maxhaz](/maxhaz) ** commented on 17 Jan 2020

I have a similar issue here.  
I package my application on a **Windows 10 'utf-8'** and the gooey GUI hangs
(freeze without display) if run on a **Windows 10 'cp932'** computer
(Japanese).

(note that to know the Windows system encoding, you can type in a powershell
terminal `[System.Text.Encoding]::Default `)  
  
---  
  
All reactions

Sorry, something went wrong.

[![@maxhaz](https://avatars.githubusercontent.com/u/8924271?s=80&u=5d99e152639dbc1e88de1d0918caf793032edab2&v=4)](/maxhaz)

Copy link

###  **[maxhaz](/maxhaz) ** commented on 20 Jan 2020

For what it worth, here is the work around I found.

In `Lib>site-packages>gooey>gui>processor.py`, I added `import local` near the
top of the file, and I replaced in `__init__`:

`self.encoding = encoding`

by

`self.encoding = locale.getpreferredencoding()`.

The purpose is to by-pass the Gooey encoding setting and force to use the
local system encoding for stdin and stdout when creating the subprocess.

(Note that other ways to get the system encoding, namely
`sys.getdefaultencoding(), sys.getfilesystemencoding(), sys.stdout.encoding,
sys.stdin.encoding` do not seem to work when used with `pyinstaller`, probably
because pyinstaller freeze their value to the 'dev machine' system encoding
instead of allowing to use the target machine system encoding)  
  
---  
  
üëç 2 Jakkwj and clausjuhl reacted with thumbs up emoji All reactions

  * üëç 2 reactions

Sorry, something went wrong.

[![@simplynail](https://avatars.githubusercontent.com/u/13271756?s=80&u=1f83623f4c1a4ff4dc371db595c5fef8798cc17c&v=4)](/simplynail)

Copy link

Author

###  **[simplynail](/simplynail) ** commented on 20 Jan 2020

Thanks, I'll give it a go soon, sounds like a solution.  
Till now I needed to walk it around andrun gooey with console and hide its
window just after program starts  
  
---  
  
All reactions

Sorry, something went wrong.

[![@simplynail](https://avatars.githubusercontent.com/u/13271756?s=80&u=1f83623f4c1a4ff4dc371db595c5fef8798cc17c&v=4)](/simplynail)

Copy link

Author

###  **[simplynail](/simplynail) ** commented on 20 Jan 2020

I'm using Eng version of Windows but with Polish keyboard and localisation
settings, so sounds like it can be a similar case. Will check
System.Text.Encoding  
  
---  
  
All reactions

Sorry, something went wrong.

[![@maxhaz](https://avatars.githubusercontent.com/u/8924271?s=80&u=5d99e152639dbc1e88de1d0918caf793032edab2&v=4)](/maxhaz)

Copy link

###  **[maxhaz](/maxhaz) ** commented on 22 Jan 2020 ‚Ä¢

edited

The solution I proposed has an important limitation though:  
It does not allow to display character in the 'status text box' that does not
exist in the locale system encoding.

A solution similar to your original one is to reconfigure the system encoding:

    
    
    sys.stdout.reconfigure(encoding='utf-8')
    sys.stdin.reconfigure(encoding='utf-8')
    

but still, it does not allow to use pyinstaller in `--windowed` mode.  
  
---  
  
üëç 1 123lujiaqiang reacted with thumbs up emoji All reactions

  * üëç 1 reaction

Sorry, something went wrong.

[![@maxhaz](https://avatars.githubusercontent.com/u/8924271?s=80&u=5d99e152639dbc1e88de1d0918caf793032edab2&v=4)](/maxhaz)

Copy link

###  **[maxhaz](/maxhaz) ** commented on 24 Jan 2020

Following this [great
resource](http://www.macfreek.nl/memory/Encoding_of_Python_stdout), it seems
that using the `codecs` module to redirect `stdout` and `stderr` works.

  1. Forget about the modification of `processor.py`
  2. Add near the top of your (main) script:

    
    
    import codecs
    
    if sys.stdout.encoding != 'UTF-8':
        sys.stdout = codecs.getwriter('utf-8')(sys.stdout.buffer, 'strict')
    if sys.stderr.encoding != 'UTF-8':
        sys.stderr = codecs.getwriter('utf-8')(sys.stderr.buffer, 'strict')
    

If this works for you, that could be the solution.  
  
---  
  
üëç 9 allenyllee, soleil0-0, ManuelFort, zllebron3wade, nattofriends, kangvcar,
tisswb, dually8, and 123lujiaqiang reacted with thumbs up emoji ‚ù§Ô∏è 1 kangvcar
reacted with heart emoji All reactions

  * üëç 9 reactions
  * ‚ù§Ô∏è 1 reaction

Sorry, something went wrong.

[![@maxhaz](https://avatars.githubusercontent.com/u/8924271?s=40&u=5d99e152639dbc1e88de1d0918caf793032edab2&v=4)](/maxhaz)
[maxhaz](/maxhaz) mentioned this issue  on 24 Jan 2020

[ Gooey encoding when running with pyinstaller #438
](/chriskiehl/Gooey/issues/438)

Open

[![@simplynail](https://avatars.githubusercontent.com/u/13271756?s=80&u=1f83623f4c1a4ff4dc371db595c5fef8798cc17c&v=4)](/simplynail)

Copy link

Author

###  **[simplynail](/simplynail) ** commented on 27 Jan 2020

great, thanks - solution with `condecs` works!

I also tried modifying `process` within gooey package, to use
`locale.getpreferredencoding()` , but this didn't work.  
my `[System.Text.Encoding]::Default` output is:

> IsSingleByte : True  
>  BodyName : iso-8859-2  
>  EncodingName : Central European (Windows)  
>  HeaderName : windows-1250  
>  WebName : windows-1250  
>  WindowsCodePage : 1250  
>  IsBrowserDisplay : True  
>  IsBrowserSave : True  
>  IsMailNewsDisplay : True  
>  IsMailNewsSave : True  
>  EncoderFallback : System.Text.InternalEncoderBestFitFallback  
>  DecoderFallback : System.Text.InternalDecoderBestFitFallback  
>  IsReadOnly : True  
>  CodePage : 1250

Thanks for helping out!  
  
---  
  
All reactions

Sorry, something went wrong.

[![@simplynail](https://avatars.githubusercontent.com/u/13271756?s=40&u=1f83623f4c1a4ff4dc371db595c5fef8798cc17c&v=4)](/simplynail)
[simplynail](/simplynail) closed this as
[completed](/chriskiehl/Gooey/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
on 27 Jan 2020

[![@soleil0-0](https://avatars.githubusercontent.com/u/5613251?s=40&v=4)](/soleil0-0)
[soleil0-0](/soleil0-0) mentioned this issue  on 12 Aug 2020

[ gs-gui hanging soleil0-0/GazelleSync#28 ](/soleil0-0/GazelleSync/issues/28)

Closed

[![@ManuelFort](https://avatars.githubusercontent.com/u/37595293?s=80&v=4)](/ManuelFort)

Copy link

###  **[ManuelFort](/ManuelFort) ** commented on 12 Feb 2021

thanks maxhaz!  
  
---  
  
All reactions

Sorry, something went wrong.

1 similar comment

[![@zllebron3wade](https://avatars.githubusercontent.com/u/12986900?s=80&u=c694ee2fac2b9fe1be15b97ab99e84f1dc119f9a&v=4)](/zllebron3wade)

Copy link

###  **[zllebron3wade](/zllebron3wade) ** commented on 7 Mar 2021

thanks maxhaz!  
  
---  
  
All reactions

Sorry, something went wrong.

[![@Jakkwj](https://avatars.githubusercontent.com/u/39725561?s=80&v=4)](/Jakkwj)

Copy link

###  **[Jakkwj](/Jakkwj) ** commented on 3 Jan ‚Ä¢

edited

[#520
(comment)](https://github.com/chriskiehl/Gooey/issues/520#issuecomment-576155188)

> For what it worth, here is the work around I found.
>
> In `Lib>site-packages>gooey>gui>processor.py`, I added `import local` near
> the top of the file, and I replaced in `__init__`:
>
> `self.encoding = encoding`
>
> by
>
> `self.encoding = locale.getpreferredencoding()`.
>
> The purpose is to by-pass the Gooey encoding setting and force to use the
> local system encoding for stdin and stdout when creating the subprocess.
>
> (Note that other ways to get the system encoding, namely
> `sys.getdefaultencoding(), sys.getfilesystemencoding(), sys.stdout.encoding,
> sys.stdin.encoding` do not seem to work when used with `pyinstaller`,
> probably because pyinstaller freeze their value to the 'dev machine' system
> encoding instead of allowing to use the target machine system encoding)

To build one file with `pyinstaller -F -w gui.py`, this is the only way to
solve my problem, as I am using:  
[Windows 7] OS  
[3.8.6 ] Python Version  
[ 1.0.8.1] Gooey Version  
[ 4.7] PyInstaller Version

BTW, it should be `import locale`  
  
---  
  
üëç 2 dually8 and clausjuhl reacted with thumbs up emoji All reactions

  * üëç 2 reactions

Sorry, something went wrong.

[![@simin75simin](https://avatars.githubusercontent.com/u/50899460?s=40&v=4)](/simin75simin)
[simin75simin](/simin75simin) mentioned this issue  on 26 Jul

[ utf-8 error #665 ](/chriskiehl/Gooey/issues/665)

Closed

[Sign up for free](/join?source=comment-repo) **to join this conversation on
GitHub**. Already have an account? [Sign in to
comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fchriskiehl%2FGooey%2Fissues%2F520)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

5 participants

[ ![@maxhaz](https://avatars.githubusercontent.com/u/8924271?s=52&v=4)
](/maxhaz) [
![@zllebron3wade](https://avatars.githubusercontent.com/u/12986900?s=52&v=4)
](/zllebron3wade) [
![@simplynail](https://avatars.githubusercontent.com/u/13271756?s=52&v=4)
](/simplynail) [
![@ManuelFort](https://avatars.githubusercontent.com/u/37595293?s=52&v=4)
](/ManuelFort) [
![@Jakkwj](https://avatars.githubusercontent.com/u/39725561?s=52&v=4)
](/Jakkwj)

## Footer

[ ](https://github.com "GitHub") ¬© 2022 GitHub, Inc.

### Footer navigation

  * [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
  * [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
  * [Security](https://github.com/security)
  * [Status](https://www.githubstatus.com/)
  * [Docs](https://docs.github.com)
  * [Contact GitHub](https://support.github.com?tags=dotcom-footer)
  * [Pricing](https://github.com/pricing)
  * [API](https://docs.github.com)
  * [Training](https://services.github.com)
  * [Blog](https://github.blog)
  * [About](https://github.com/about)

You can‚Äôt perform that action at this time.

You signed in with another tab or window. [Reload]() to refresh your session.
You signed out in another tab or window. [Reload]() to refresh your session.

