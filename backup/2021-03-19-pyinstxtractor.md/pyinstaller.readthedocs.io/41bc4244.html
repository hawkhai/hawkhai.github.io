<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" class="writer-html5" lang="en"><head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Advanced Topics — PyInstaller 4.9 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/pyinstaller.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/pyinstaller-draft1a.ico" />
  

  
  

  
    <link rel="canonical" href="https://pyinstaller.readthedocs.io/en/stable/advanced-topics.html" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Understanding PyInstaller Hooks" href="hooks.html" />
    <link rel="prev" title="When Things Go Wrong" href="when-things-go-wrong.html" /> 

<!-- RTD Extra Head -->

<link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "build_date": "2022-02-04T09:10:10Z", "builder": "sphinx", "canonical_url": null, "commit": "d006b364", "docroot": "/doc/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "advanced-topics", "programming_language": "py", "project": "pyinstaller", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "", "version": "stable"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
<script src="https://www.googletagmanager.com/gtag/js?id=UA-17997319-1" type="text/javascript" async=""></script><script src="https://media.ethicalads.io/media/client/beta/ethicalads.min.js" type="text/javascript" async="" id="ethicaladsjs"></script><style>[data-ea-publisher].loaded,[data-ea-type].loaded{font-size:14px;font-family:-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji;font-weight:normal;font-style:normal;leter-spacing:0px;vertical-align:baseline;line-height:1.3em}[data-ea-publisher].loaded a,[data-ea-type].loaded a{text-decoration:none}[data-ea-publisher].loaded .ea-pixel,[data-ea-type].loaded .ea-pixel{display:none}[data-ea-publisher].loaded .ea-content,[data-ea-type].loaded .ea-content{margin:1em 1em 0.5em 1em;padding:1em;background:rgba(0,0,0,0.03);color:#505050}[data-ea-publisher].loaded .ea-content a:link,[data-ea-type].loaded .ea-content a:link{color:#505050}[data-ea-publisher].loaded .ea-content a:visited,[data-ea-type].loaded .ea-content a:visited{color:#505050}[data-ea-publisher].loaded .ea-content a:hover,[data-ea-type].loaded .ea-content a:hover{color:#373737}[data-ea-publisher].loaded .ea-content a:active,[data-ea-type].loaded .ea-content a:active{color:#373737}[data-ea-publisher].loaded .ea-content a strong,[data-ea-publisher].loaded .ea-content a b,[data-ea-type].loaded .ea-content a strong,[data-ea-type].loaded .ea-content a b{color:#088cdb}[data-ea-publisher].loaded .ea-callout a:link,[data-ea-type].loaded .ea-callout a:link{color:#6a6a6a}[data-ea-publisher].loaded .ea-callout a:visited,[data-ea-type].loaded .ea-callout a:visited{color:#6a6a6a}[data-ea-publisher].loaded .ea-callout a:hover,[data-ea-type].loaded .ea-callout a:hover{color:#505050}[data-ea-publisher].loaded .ea-callout a:active,[data-ea-type].loaded .ea-callout a:active{color:#505050}[data-ea-publisher].loaded .ea-callout a strong,[data-ea-publisher].loaded .ea-callout a b,[data-ea-type].loaded .ea-callout a strong,[data-ea-type].loaded .ea-callout a b{color:#088cdb}[data-ea-publisher].loaded .ea-callout a,[data-ea-type].loaded .ea-callout a{font-size:0.8em}[data-ea-publisher].loaded.dark .ea-content,[data-ea-type].loaded.dark .ea-content{background:rgba(255,255,255,0.05);color:#dcdcdc}[data-ea-publisher].loaded.dark .ea-content a:link,[data-ea-type].loaded.dark .ea-content a:link{color:#dcdcdc}[data-ea-publisher].loaded.dark .ea-content a:visited,[data-ea-type].loaded.dark .ea-content a:visited{color:#dcdcdc}[data-ea-publisher].loaded.dark .ea-content a:hover,[data-ea-type].loaded.dark .ea-content a:hover{color:#f6f6f6}[data-ea-publisher].loaded.dark .ea-content a:active,[data-ea-type].loaded.dark .ea-content a:active{color:#f6f6f6}[data-ea-publisher].loaded.dark .ea-content a strong,[data-ea-publisher].loaded.dark .ea-content a b,[data-ea-type].loaded.dark .ea-content a strong,[data-ea-type].loaded.dark .ea-content a b{color:#50baf9}[data-ea-publisher].loaded.dark .ea-callout a:link,[data-ea-type].loaded.dark .ea-callout a:link{color:#c3c3c3}[data-ea-publisher].loaded.dark .ea-callout a:visited,[data-ea-type].loaded.dark .ea-callout a:visited{color:#c3c3c3}[data-ea-publisher].loaded.dark .ea-callout a:hover,[data-ea-type].loaded.dark .ea-callout a:hover{color:#dcdcdc}[data-ea-publisher].loaded.dark .ea-callout a:active,[data-ea-type].loaded.dark .ea-callout a:active{color:#dcdcdc}[data-ea-publisher].loaded.dark .ea-callout a strong,[data-ea-publisher].loaded.dark .ea-callout a b,[data-ea-type].loaded.dark .ea-callout a strong,[data-ea-type].loaded.dark .ea-callout a b{color:#50baf9}@media (prefers-color-scheme: dark){[data-ea-publisher].loaded.adaptive .ea-content,[data-ea-type].loaded.adaptive .ea-content{background:rgba(255,255,255,0.05);color:#dcdcdc}[data-ea-publisher].loaded.adaptive .ea-content a:link,[data-ea-type].loaded.adaptive .ea-content a:link{color:#dcdcdc}[data-ea-publisher].loaded.adaptive .ea-content a:visited,[data-ea-type].loaded.adaptive .ea-content a:visited{color:#dcdcdc}[data-ea-publisher].loaded.adaptive .ea-content a:hover,[data-ea-type].loaded.adaptive .ea-content a:hover{color:#f6f6f6}[data-ea-publisher].loaded.adaptive .ea-content a:active,[data-ea-type].loaded.adaptive .ea-content a:active{color:#f6f6f6}[data-ea-publisher].loaded.adaptive .ea-content a strong,[data-ea-publisher].loaded.adaptive .ea-content a b,[data-ea-type].loaded.adaptive .ea-content a strong,[data-ea-type].loaded.adaptive .ea-content a b{color:#50baf9}[data-ea-publisher].loaded.adaptive .ea-callout a:link,[data-ea-type].loaded.adaptive .ea-callout a:link{color:#c3c3c3}[data-ea-publisher].loaded.adaptive .ea-callout a:visited,[data-ea-type].loaded.adaptive .ea-callout a:visited{color:#c3c3c3}[data-ea-publisher].loaded.adaptive .ea-callout a:hover,[data-ea-type].loaded.adaptive .ea-callout a:hover{color:#dcdcdc}[data-ea-publisher].loaded.adaptive .ea-callout a:active,[data-ea-type].loaded.adaptive .ea-callout a:active{color:#dcdcdc}[data-ea-publisher].loaded.adaptive .ea-callout a strong,[data-ea-publisher].loaded.adaptive .ea-callout a b,[data-ea-type].loaded.adaptive .ea-callout a strong,[data-ea-type].loaded.adaptive .ea-callout a b{color:#50baf9}}[data-ea-publisher].loaded .ea-content,[data-ea-type].loaded .ea-content{border:0px;border-radius:3px;box-shadow:0px 2px 3px rgba(0,0,0,0.15)}[data-ea-publisher].loaded.raised .ea-content,[data-ea-type].loaded.raised .ea-content{border:0px;border-radius:3px;box-shadow:0px 2px 3px rgba(0,0,0,0.15)}[data-ea-publisher].loaded.bordered .ea-content,[data-ea-type].loaded.bordered .ea-content{border:1px solid rgba(0,0,0,0.04);border-radius:3px;box-shadow:none}[data-ea-publisher].loaded.bordered.dark .ea-content,[data-ea-type].loaded.bordered.dark .ea-content{border:1px solid rgba(255,255,255,0.07)}@media (prefers-color-scheme: dark){[data-ea-publisher].loaded.bordered.adaptive .ea-content,[data-ea-type].loaded.bordered.adaptive .ea-content{border:1px solid rgba(255,255,255,0.07)}}[data-ea-publisher].loaded.flat .ea-content,[data-ea-type].loaded.flat .ea-content{border:0px;border-radius:3px;box-shadow:none}[data-ea-type="image"].loaded,[data-ea-publisher]:not([data-ea-type]).loaded,.ea-type-image{display:inline-block}[data-ea-type="image"].loaded .ea-content,[data-ea-publisher]:not([data-ea-type]).loaded .ea-content,.ea-type-image .ea-content{max-width:180px;overflow:auto;text-align:center}[data-ea-type="image"].loaded .ea-content&gt;a&gt;img,[data-ea-publisher]:not([data-ea-type]).loaded .ea-content&gt;a&gt;img,.ea-type-image .ea-content&gt;a&gt;img{width:120px;height:90px;display:inline-block}[data-ea-type="image"].loaded .ea-content&gt;.ea-text,[data-ea-publisher]:not([data-ea-type]).loaded .ea-content&gt;.ea-text,.ea-type-image .ea-content&gt;.ea-text{margin-top:1em;font-size:1em;text-align:center}[data-ea-type="image"].loaded .ea-callout,[data-ea-publisher]:not([data-ea-type]).loaded .ea-callout,.ea-type-image .ea-callout{max-width:180px;margin:0em 1em 1em 1em;padding-left:1em;padding-right:1em;font-style:italic;text-align:right}[data-ea-type="image"].loaded.horizontal .ea-content,[data-ea-publisher]:not([data-ea-type]).loaded.horizontal .ea-content,.ea-type-image.horizontal .ea-content{max-width:320px}[data-ea-type="image"].loaded.horizontal .ea-content&gt;a&gt;img,[data-ea-publisher]:not([data-ea-type]).loaded.horizontal .ea-content&gt;a&gt;img,.ea-type-image.horizontal .ea-content&gt;a&gt;img{float:left;margin-right:1em}[data-ea-type="image"].loaded.horizontal .ea-content .ea-text,[data-ea-publisher]:not([data-ea-type]).loaded.horizontal .ea-content .ea-text,.ea-type-image.horizontal .ea-content .ea-text{margin-top:0em;text-align:left;overflow:auto}[data-ea-type="image"].loaded.horizontal .ea-callout,[data-ea-publisher]:not([data-ea-type]).loaded.horizontal .ea-callout,.ea-type-image.horizontal .ea-callout{max-width:320px;text-align:right}[data-ea-type="text"].loaded,.ea-type-text{font-size:14px}[data-ea-type="text"].loaded .ea-content,.ea-type-text .ea-content{text-align:left}[data-ea-type="text"].loaded .ea-callout,.ea-type-text .ea-callout{margin:0.5em 1em 1em 1em;padding-left:1em;padding-right:1em;text-align:right;font-style:italic}[data-ea-style="stickybox"].loaded .ea-type-image{z-index:10;position:fixed;bottom:20px;right:20px}[data-ea-style="stickybox"].loaded .ea-type-image .ea-stickybox-hide{cursor:pointer;position:absolute;top:0.75em;right:0.75em;background-color:#fefefe;border:1px solid #088cdb;border-radius:50%;color:#088cdb;font-size:1em;text-align:center;height:1.5em;width:1.5em;line-height:1.5em}@media (max-width: 1300px){[data-ea-style="stickybox"].loaded .ea-type-image{position:static;bottom:0;right:0;margin:auto;text-align:center}[data-ea-style="stickybox"].loaded .ea-type-image .ea-stickybox-hide{display:none}}@media (min-width: 1301px){[data-ea-style="stickybox"].loaded .ea-type-image .ea-content{background:#dcdcdc}[data-ea-style="stickybox"].loaded.dark .ea-type-image .ea-content{background:#505050}}@media (min-width: 1301px) and (prefers-color-scheme: dark){[data-ea-style="stickybox"].loaded.adaptive .ea-type-image .ea-content{background:#505050}}
</style><script src="https://server.ethicalads.io/api/v1/decision/?publisher=readthedocs&amp;ad_types=readthedocs-sidebar&amp;div_ids=rtd-sidebar&amp;callback=ad_1644632596432_250080&amp;keywords=bundle%7Cpackage%7Cpython%7Creadthedocs-project-49038%7Creadthedocs-project-pyinstaller%7Cpython&amp;campaign_types=community%7Chouse&amp;format=jsonp&amp;client_version=1.4.0&amp;url=https%3A%2F%2Fpyinstaller.readthedocs.io%2Fen%2Fstable%2Fadvanced-topics.html" type="text/javascript" async=""></script></head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PyInstaller
          

          
            
            <img src="_static/pyinstaller-draft1a-100_trans.png" class="logo" alt="Logo" />
          
          </a>

          
            
            
            
              <div class="version">
                stable
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">How To Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">How to Install <cite>PyInstaller</cite></a></li>
<li class="toctree-l1"><a class="reference internal" href="operating-mode.html">What <cite>PyInstaller</cite> Does and How It Does It</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Using PyInstaller</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime-information.html">Run-time Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="spec-files.html">Using Spec Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-notes.html">Notes about specific Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="when-things-go-wrong.html">When Things Go Wrong</a></li>
<li class="toctree-l1 current"><a class="reference internal current" href="#"><span class="toctree-expand"></span>Advanced Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-bootstrap-process-in-detail"><span class="toctree-expand"></span>The Bootstrap Process in Detail</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bootloader">Bootloader</a></li>
<li class="toctree-l3"><a class="reference internal" href="#python-imports-in-a-bundled-app">Python imports in a bundled app</a></li>
<li class="toctree-l3"><a class="reference internal" href="#splash-screen-startup">Splash screen startup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyi-splash-module-detailed"><span class="toctree-expand"></span><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyi_splash</span></code> Module (Detailed)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyi_splash">Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-toc-and-tree-classes"><span class="toctree-expand"></span>The TOC and Tree Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#toc-class-table-of-contents">TOC Class (Table of Contents)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-tree-class">The Tree Class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inspecting-archives"><span class="toctree-expand"></span>Inspecting Archives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#zlibarchive">ZlibArchive</a></li>
<li class="toctree-l3"><a class="reference internal" href="#carchive">CArchive</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-pyi-archive-viewer">Using pyi-archive_viewer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inspecting-executables">Inspecting Executables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-reproducible-build">Creating a Reproducible Build</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hooks.html">Understanding PyInstaller Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks-config.html">Hook Configuration Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="bootloader-building.html">Building the Bootloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGES.html">Changelog for PyInstaller</a></li>
<li class="toctree-l1"><a class="reference internal" href="CREDITS.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="man-pages.html">Man Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="development/index.html">Development Guide</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyInstaller</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> »</li>
        
      <li>Advanced Topics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/pyinstaller/pyinstaller/blob/d006b364cfabd1ac23f57c28b92d385331987edf/doc/advanced-topics.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr />
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="advanced-topics">
<h1>Advanced Topics<a class="headerlink" href="#advanced-topics" title="Permalink to this headline">¶</a></h1>
<p>The following discussions cover details of <cite>PyInstaller</cite> internal methods.
You should not need this level of detail for normal use,
but such details are helpful if you want to investigate
the <cite>PyInstaller</cite> code and possibly contribute to it,
as described in <a class="reference external" href="https://github.com/pyinstaller/pyinstaller/wiki/How-to-Contribute">How to Contribute</a>.</p>
<div class="section" id="the-bootstrap-process-in-detail">
<span id="id1"></span><h2>The Bootstrap Process in Detail<a class="headerlink" href="#the-bootstrap-process-in-detail" title="Permalink to this headline">¶</a></h2>
<p>There are many steps that must take place before the bundled
script can begin execution.
A summary of these steps was given in the Overview
(<a class="reference internal" href="operating-mode.html#how-the-one-folder-program-works"><span class="std std-ref">How the One-Folder Program Works</span></a> and
<a class="reference internal" href="operating-mode.html#how-the-one-file-program-works"><span class="std std-ref">How the One-File Program Works</span></a>).
Here is more detail to help you understand what the bootloader
does and how to figure out problems.</p>
<div class="section" id="bootloader">
<h3>Bootloader<a class="headerlink" href="#bootloader" title="Permalink to this headline">¶</a></h3>
<p>The bootloader prepares everything for running Python code.
It begins the setup and then returns itself in another process.
This approach of using two processes allows a lot of flexibility
and is used in all bundles except one-folder mode in Windows.
So do not be surprised if you will see your bundled app
as  two processes in your system task manager.</p>
<p>What happens during execution of bootloader:</p>
<ol class="upperalpha">
<li><p>First process: bootloader starts.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>If one-file mode, extract bundled files to
<code class="file docutils literal notranslate"><em><span class="pre">temppath</span></em><span class="pre">/_MEI</span><em><span class="pre">xxxxxx</span></em></code>.</p></li>
<li><p>Modify various environment variables:</p>
<ul class="simple">
<li><p>GNU/Linux: If set, save the original value of LD_LIBRARY_PATH
into LD_LIBRARY_PATH_ORIG.
Prepend our path to LD_LIBRARY_PATH.</p></li>
<li><p>AIX: same thing, but using LIBPATH and LIBPATH_ORIG.</p></li>
<li><p>OSX: unset DYLD_LIBRARY_PATH.</p></li>
</ul>
</li>
<li><p>Set up to handle signals for both processes.</p></li>
<li><p>Run the child process.</p></li>
<li><p>Wait for the child process to finish.</p></li>
<li><p>If one-file mode, delete <code class="file docutils literal notranslate"><em><span class="pre">temppath</span></em><span class="pre">/_MEI</span><em><span class="pre">xxxxxx</span></em></code>.</p></li>
</ol>
</div></blockquote>
</li>
<li><p>Second process: bootloader itself started as a child process.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>On Windows set the <a class="reference external" href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa374153(v=vs.85).aspx">activation context</a>.</p></li>
<li><p>Load the Python dynamic library.
The name of the dynamic library is embedded in the
executable file.</p></li>
<li><p>Initialize Python interpreter: set sys.path, sys.prefix, sys.executable.</p></li>
<li><p>Run python code.</p></li>
</ol>
</div></blockquote>
</li>
</ol>
<p>Running Python code requires several steps:</p>
<ol class="arabic simple">
<li><p>Run the Python initialization code which
prepares everything for running the user’s main script.
The initialization code can use only the Python built-in modules
because the general import mechanism is not yet available.
It sets up the Python import mechanism to load modules
only from archives embedded in the executable.
It also adds the attributes <code class="docutils literal notranslate"><span class="pre">frozen</span></code>
and <code class="docutils literal notranslate"><span class="pre">_MEIPASS</span></code> to the <a class="reference external" href="https://docs.python.org/3/library/sys.html#module-sys" title="(in Python v3.10)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sys</span></code></a> built-in module.</p></li>
<li><p>Execute any run-time hooks: first those specified by the
user, then any standard ones.</p></li>
<li><p>Install python “egg” files.
When a module is part of a zip file (.egg),
it has been bundled into the <code class="file docutils literal notranslate"><span class="pre">./eggs</span></code> directory.
Installing means appending .egg file names to <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.path" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>.
Python automatically detects whether an
item in <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.path" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a> is a zip file or a directory.</p></li>
<li><p>Run the main script.</p></li>
</ol>
</div>
<div class="section" id="python-imports-in-a-bundled-app">
<h3>Python imports in a bundled app<a class="headerlink" href="#python-imports-in-a-bundled-app" title="Permalink to this headline">¶</a></h3>
<p><cite>PyInstaller</cite> embeds compiled python code
(<code class="docutils literal notranslate"><span class="pre">.pyc</span></code> files) within the executable.
<cite>PyInstaller</cite> injects its code into the
normal Python import mechanism.
Python allows this;
the support is described in <span class="target" id="index-0"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0302"><strong>PEP 302</strong></a>  “New Import Hooks”.</p>
<p>PyInstaller implements the PEP 302 specification for
importing built-in modules,
importing “frozen” modules (compiled python code
bundled with the app) and for C-extensions.
The code can be read in <code class="file docutils literal notranslate"><span class="pre">./PyInstaller/loader/pyi_mod03_importers.py</span></code>.</p>
<p>At runtime the PyInstaller <span class="target" id="index-1"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0302"><strong>PEP 302</strong></a> hooks are appended
to the variable <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.meta_path" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.meta_path</span></code></a>.
When trying to import modules the interpreter will
first try PEP 302 hooks in <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.meta_path" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.meta_path</span></code></a>
before searching in <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.path" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>.
As a result, the Python interpreter
loads imported python modules from the archive embedded
in the bundled executable.</p>
<p>This is the resolution order of import statements
in a bundled app:</p>
<ol class="arabic simple">
<li><p>Is it a built-in module?
A list of built-in modules is in variable
<a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.builtin_module_names" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.builtin_module_names</span></code></a>.</p></li>
<li><p>Is it a module embedded in the executable?
Then load it from embedded archive.</p></li>
<li><p>Is it a C-extension?
The app will try to find a file with name
<code class="file docutils literal notranslate"><em><span class="pre">package.subpackage.module</span></em><span class="pre">.pyd</span></code> or
<code class="file docutils literal notranslate"><em><span class="pre">package.subpackage.module</span></em><span class="pre">.so</span></code>.</p></li>
<li><p>Next examine paths in the <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.path" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>.
There could be any additional location with python modules
or <code class="docutils literal notranslate"><span class="pre">.egg</span></code> filenames.</p></li>
<li><p>If the module was not found then
raise <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ImportError" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImportError</span></code></a>.</p></li>
</ol>
</div>
<div class="section" id="splash-screen-startup">
<h3>Splash screen startup<a class="headerlink" href="#splash-screen-startup" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This feature is incompatible with macOS. In the current design, the
splash screen operates in a secondary thread, which is disallowed by
the Tcl/Tk (or rather, the underlying GUI toolkit) on macOS.</p>
</div>
<p>If a splash screen is bundled with the application the
bootloaders startup procedure and threading model is a little
more complex. The following describes the order of operation if
a splash screen is bundled:</p>
<ol class="arabic">
<li><p>The bootloader checks if it runs as the outermost application
(Not the child process which was spawned by the bootloader).</p></li>
<li><p>If splash screen resources are bundled, try to extract them
(onefile mode). The extraction path is inside
<code class="file docutils literal notranslate"><em><span class="pre">temppath</span></em><span class="pre">/_MEI</span><em><span class="pre">xxxxxx</span></em><span class="pre">/__splash</span><em><span class="pre">x</span></em></code>. If in onedir mode,
the application assumes the resources are relative to the
executable.</p></li>
<li><p>Load the tcl and tk shared libraries into the bootloader.</p>
<blockquote>
<div><ul class="simple">
<li><p>Windows: <code class="docutils literal notranslate"><span class="pre">tcl86t.dll</span></code>/<code class="docutils literal notranslate"><span class="pre">tk86t.dll</span></code></p></li>
<li><p>Linux: <code class="docutils literal notranslate"><span class="pre">libtcl.so</span></code>/<code class="docutils literal notranslate"><span class="pre">libtk.so</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p>Prepare a minimal environment for the <a class="reference external" href="http://www.tcl.tk/">Tcl/Tk</a> interpreter
by replacing/modifying the following functions:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">::tclInit</span></code>: This command is called to find the
standard library of tcl. We replace this command to
force tcl to load/execute only the bundled modules.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">::tcl_findLibrary</span></code>: Tk uses this function to source
all its components. The overwritten function sets the
required environment variable and evaluates the requested
file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">::exit</span></code>: This function is modified to ensure a
proper exit of the splash screen thread.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">::source</span></code>: This command executes the contents of a
passed file. Since we run in a minimal environment we
mock the execution of not bundled files and execute
those who are.</p></li>
</ol>
</div></blockquote>
</li>
<li><p>Start the tcl interpreter and execute the splash screen
script which was generated by PyInstaller’s build target
<code class="xref py py-mod docutils literal notranslate"><span class="pre">Splash</span></code> at build time. This script creates the
environment variable <code class="docutils literal notranslate"><span class="pre">_PYIBoot_SPLASH</span></code>, which is also
available to the python interpreter. It also initializes a
tcp server socket to receive commands from python.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The tcl interpreter is started in a separate thread. Only
after the tcl interpreter has executed the splash
screen script, the bootloader thread, which is responsible
for extraction/starting the python interpreter, is
resumed.</p>
</div>
</div>
</div>
<div class="section" id="pyi-splash-module-detailed">
<span id="pyi-splash-module"></span><h2><a class="reference internal" href="#module-pyi_splash" title="pyi_splash"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyi_splash</span></code></a> Module (Detailed)<a class="headerlink" href="#pyi-splash-module-detailed" title="Permalink to this headline">¶</a></h2>
<p>This module connects to the bootloader to send messages to the splash screen.</p>
<p>It is intended to act as an RPC interface for the functions provided by the
bootloader, such as displaying text or closing. This makes the users python
program independent of how the communication with the bootloader is
implemented, since a consistent API is provided.</p>
<p>To connect to the bootloader, it connects to a local tcp server socket whose port
is passed through the environment variable <code class="docutils literal notranslate"><span class="pre">_PYIBoot_SPLASH</span></code>. The bootloader
connects to the socket via the python module <code class="docutils literal notranslate"><span class="pre">_socket</span></code>. Although this socket
is bidirectional, the module is only configured to send data.
Since the os-module, which is needed to request the environment variable,
is not available at boot time, the module does not establish the connection
until initialization.</p>
<p>This module does not support reloads while the splash screen is displayed, i.e.
it cannot be reloaded (such as by <a class="reference external" href="https://docs.python.org/3/library/importlib.html#importlib.reload" title="(in Python v3.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">importlib.reload()</span></code></a>), because the splash
screen closes automatically when the connection to this instance of the
module is lost.</p>
<div class="section" id="module-pyi_splash">
<span id="functions"></span><h3>Functions<a class="headerlink" href="#module-pyi_splash" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that if the <code class="docutils literal notranslate"><span class="pre">_PYIBoot_SPLASH</span></code> environment variable does not exist or an
error occurs during the connection, the module will <strong>not</strong> raise an error, but simply
not initialize itself (i.e. <a class="reference internal" href="#pyi_splash.is_alive" title="pyi_splash.is_alive"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyi_splash.is_alive()</span></code></a> will return <code class="docutils literal notranslate"><span class="pre">False</span></code>). Before
sending commands to the splash screen, one should check if the module was initialized
correctly, otherwise a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> will be raised.</p>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="pyi_splash.is_alive">
<span class="sig-name descname"><span class="pre">is_alive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyi_splash.is_alive" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates whether the module can be used.</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">False</span></code> if the module is either not initialized ot was disabled
by closing the splash screen. Otherwise, the module should be usable.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyi_splash.update_text">
<span class="sig-name descname"><span class="pre">update_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyi_splash.update_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the text on the splash screen window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>msg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the text to be displayed</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ConnectionError" title="(in Python v3.10)"><strong>ConnectionError</strong></a> – If the OS fails to write to the socket</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – If the module is not initialized</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyi_splash.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyi_splash.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the connection to the ipc tcp server socket</p>
<p>This will close the splash screen and renders this module unusable.
After this function is called, no connection can be opened to the splash
screen again and all functions if this module become unusable</p>
</dd></dl>

</div>
</div>
<div class="section" id="the-toc-and-tree-classes">
<span id="id2"></span><h2>The TOC and Tree Classes<a class="headerlink" href="#the-toc-and-tree-classes" title="Permalink to this headline">¶</a></h2>
<p><cite>PyInstaller</cite> manages lists of files using the <code class="docutils literal notranslate"><span class="pre">TOC</span></code>
(Table Of Contents) class.
It provides the <code class="docutils literal notranslate"><span class="pre">Tree</span></code> class as a convenient way to build a <code class="docutils literal notranslate"><span class="pre">TOC</span></code>
from a folder path.</p>
<div class="section" id="toc-class-table-of-contents">
<h3>TOC Class (Table of Contents)<a class="headerlink" href="#toc-class-table-of-contents" title="Permalink to this headline">¶</a></h3>
<p>Objects of the <code class="docutils literal notranslate"><span class="pre">TOC</span></code> class are used as input to the classes created in
a spec file.
For example, the <code class="docutils literal notranslate"><span class="pre">scripts</span></code> member of an Analysis object is a TOC
containing a list of scripts.
The <code class="docutils literal notranslate"><span class="pre">pure</span></code> member is a TOC with a list of modules, and so on.</p>
<p>Basically a <code class="docutils literal notranslate"><span class="pre">TOC</span></code> object contains a list of tuples of the form</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">(</span></code><em>name</em><code class="docutils literal notranslate"><span class="pre">,</span></code><em>path</em><code class="docutils literal notranslate"><span class="pre">,</span></code><em>typecode</em><code class="docutils literal notranslate"><span class="pre">)</span></code></p>
</div></blockquote>
<p>In fact, it acts as an ordered set of tuples;
that is, it contains no duplicates
(where uniqueness is based on the <em>name</em> element of each tuple).
Within this constraint, a TOC preserves the order of tuples added to it.</p>
<p>A TOC behaves like a list and supports the same methods
such as appending, indexing, etc.
A TOC also behaves like a set, and supports taking differences and intersections.
In all of these operations a list of tuples can be used as one argument.
For example, the following expressions are equivalent ways to
add a file to the <code class="docutils literal notranslate"><span class="pre">a.datas</span></code> member:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">datas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span> <span class="p">(</span><span class="s1">'README'</span><span class="p">,</span> <span class="s1">'src/README.txt'</span><span class="p">,</span> <span class="s1">'DATA'</span> <span class="p">)</span> <span class="p">]</span> <span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">datas</span> <span class="o">+=</span> <span class="p">[</span> <span class="p">(</span><span class="s1">'README'</span><span class="p">,</span> <span class="s1">'src/README.txt'</span><span class="p">,</span> <span class="s1">'DATA'</span> <span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
<p>Set-difference makes excluding modules quite easy. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">binaries</span> <span class="o">-</span> <span class="p">[(</span><span class="s1">'badmodule'</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
</pre></div>
</div>
<p>is an expression that produces a new <code class="docutils literal notranslate"><span class="pre">TOC</span></code> that is a copy of
<code class="docutils literal notranslate"><span class="pre">a.binaries</span></code> from which any tuple named <code class="docutils literal notranslate"><span class="pre">badmodule</span></code> has been removed.
The right-hand argument to the subtraction operator
is a list that contains one tuple
in which <em>name</em> is <code class="docutils literal notranslate"><span class="pre">badmodule</span></code> and the <em>path</em> and <em>typecode</em> elements
are <code class="docutils literal notranslate"><span class="pre">None</span></code>.
Because set membership is based on the <em>name</em> element of a tuple only,
it is not necessary to give accurate <em>path</em> and <em>typecode</em> elements when subtracting.</p>
<p>In order to add files to a TOC, you need to know the <em>typecode</em> values
and their related <em>path</em> values.
A <em>typecode</em> is a one-word string.
<cite>PyInstaller</cite> uses a number of <em>typecode</em> values internally,
but for the normal case you need to know only these:</p>
<div class="wy-table-responsive"><table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 33%" />
<col style="width: 20%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>typecode</strong></p></th>
<th class="head"><p><strong>description</strong></p></th>
<th class="head"><p><strong>name</strong></p></th>
<th class="head"><p><strong>path</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>‘DATA’</p></td>
<td><p>Arbitrary files.</p></td>
<td><p>Run-time name.</p></td>
<td><p>Full path name in build.</p></td>
</tr>
<tr class="row-odd"><td><p>‘BINARY’</p></td>
<td><p>A shared library.</p></td>
<td><p>Run-time name.</p></td>
<td><p>Full path name in build.</p></td>
</tr>
<tr class="row-even"><td><p>‘EXTENSION’</p></td>
<td><p>A binary extension to Python.</p></td>
<td><p>Run-time name.</p></td>
<td><p>Full path name in build.</p></td>
</tr>
<tr class="row-odd"><td><p>‘OPTION’</p></td>
<td><p>A Python run-time option.</p></td>
<td><p>Option code</p></td>
<td><p>ignored.</p></td>
</tr>
</tbody>
</table></div>
<p>The run-time name of a file will be used in the final bundle.
It may include path elements, for example <code class="file docutils literal notranslate"><span class="pre">extras/mydata.txt</span></code>.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">BINARY</span></code> file or an <code class="docutils literal notranslate"><span class="pre">EXTENSION</span></code> file is assumed to be loadable, executable code,
for example a dynamic library.
The types are treated the same.
<code class="docutils literal notranslate"><span class="pre">EXTENSION</span></code> is generally used for a Python extension module,
for example a module compiled by <a class="reference external" href="http://www.cython.org/">Cython</a>.
<cite>PyInstaller</cite> will examine either type of file for dependencies,
and if any are found, they are also included.</p>
</div>
<div class="section" id="the-tree-class">
<h3>The Tree Class<a class="headerlink" href="#the-tree-class" title="Permalink to this headline">¶</a></h3>
<p>The Tree class is a way of creating a TOC that describes some or all of the
files within a directory:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Tree(</span></code><em>root</em><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">prefix=</span></code><em>run-time-folder</em><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">excludes=</span></code><em>string_list</em><code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">typecode=</span></code><em>code</em> | <code class="docutils literal notranslate"><span class="pre">'DATA'</span> <span class="pre">)</span></code></p>
</div></blockquote>
<ul class="simple">
<li><p>The <em>root</em> argument is a path string to a directory.
It may be absolute or relative to the spec file directory.</p></li>
<li><p>The <em>prefix</em> argument, if given, is a name for a subfolder
within the run-time folder to contain the tree files.
If you omit <em>prefix</em> or give <code class="docutils literal notranslate"><span class="pre">None</span></code>,
the tree files will be at
the top level of the run-time folder.</p></li>
<li><p>The <em>excludes</em> argument, if given, is a list of one or more
strings that match files in the <em>root</em> that should be omitted from the Tree.
An item in the list can be either:</p>
<ul>
<li><p>a name, which causes files or folders with this basename to be excluded</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*.ext</span></code>, which causes files with this extension to be excluded</p></li>
</ul>
</li>
<li><p>The <em>typecode</em> argument, if given, specifies the TOC typecode string
that applies to all items in the Tree.
If omitted, the default is <code class="docutils literal notranslate"><span class="pre">DATA</span></code>, which is appropriate for most cases.</p></li>
</ul>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">extras_toc</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="s1">'../src/extras'</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">'extras'</span><span class="p">,</span> <span class="n">excludes</span><span class="o">=</span><span class="p">[</span><span class="s1">'tmp'</span><span class="p">,</span><span class="s1">'*.pyc'</span><span class="p">])</span>
</pre></div>
</div>
<p>This creates <code class="docutils literal notranslate"><span class="pre">extras_toc</span></code> as a TOC object that lists
all files from the relative path <code class="file docutils literal notranslate"><span class="pre">../src/extras</span></code>,
omitting those that have the basename (or are in a folder named) <code class="docutils literal notranslate"><span class="pre">tmp</span></code>
or that have the type <code class="docutils literal notranslate"><span class="pre">.pyc</span></code>.
Each tuple in this TOC has:</p>
<ul class="simple">
<li><p>A <em>name</em> composed of <code class="file docutils literal notranslate"><span class="pre">extras/</span><em><span class="pre">filename</span></em></code>.</p></li>
<li><p>A <em>path</em> consisting of a complete, absolute path to that file in the
<code class="file docutils literal notranslate"><span class="pre">../src/extras</span></code> folder (relative to the location of the spec file).</p></li>
<li><p>A <em>typecode</em> of <code class="docutils literal notranslate"><span class="pre">DATA</span></code> (by default).</p></li>
</ul>
<p>An example of creating a TOC listing some binary modules:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cython_mods</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s1">'..src/cy_mods'</span><span class="p">,</span> <span class="n">excludes</span><span class="o">=</span><span class="p">[</span><span class="s1">'*.pyx'</span><span class="p">,</span><span class="s1">'*.py'</span><span class="p">,</span><span class="s1">'*.pyc'</span><span class="p">],</span> <span class="n">typecode</span><span class="o">=</span><span class="s1">'EXTENSION'</span> <span class="p">)</span>
</pre></div>
</div>
<p>This creates a TOC with a tuple for every file in the <code class="file docutils literal notranslate"><span class="pre">cy_mods</span></code> folder,
excluding any with the <code class="docutils literal notranslate"><span class="pre">.pyx</span></code>, <code class="docutils literal notranslate"><span class="pre">.py</span></code> or <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> suffixes
(so presumably collecting the <code class="docutils literal notranslate"><span class="pre">.pyd</span></code> or <code class="docutils literal notranslate"><span class="pre">.so</span></code> modules created by Cython).
Each tuple in this TOC has:</p>
<ul class="simple">
<li><p>Its own filename as <em>name</em> (no prefix; the file will be at the top level of the bundle).</p></li>
<li><p>A <em>path</em> as an absolute path to that file in <code class="file docutils literal notranslate"><span class="pre">../src/cy_mods</span></code>
relative to the spec file.</p></li>
<li><p>A <em>typecode</em> of <code class="docutils literal notranslate"><span class="pre">EXTENSION</span></code> (<code class="docutils literal notranslate"><span class="pre">BINARY</span></code> could be used as well).</p></li>
</ul>
</div>
</div>
<div class="section" id="inspecting-archives">
<span id="id3"></span><h2>Inspecting Archives<a class="headerlink" href="#inspecting-archives" title="Permalink to this headline">¶</a></h2>
<p>An archive is a file that contains other files,
for example a <code class="docutils literal notranslate"><span class="pre">.tar</span></code> file, a <code class="docutils literal notranslate"><span class="pre">.jar</span></code> file, or a <code class="docutils literal notranslate"><span class="pre">.zip</span></code> file.
Two kinds of archives are used in <cite>PyInstaller</cite>.
One is a ZlibArchive, which
allows Python modules to be stored efficiently and,
with some import hooks, imported directly.
The other, a CArchive, is similar to a <code class="docutils literal notranslate"><span class="pre">.zip</span></code> file,
a general way of packing up (and optionally compressing) arbitrary blobs of data.
It gets its name from the fact that it can be manipulated easily from C
as well as from Python.
Both of these derive from a common base class, making it fairly easy to
create new kinds of archives.</p>
<div class="section" id="zlibarchive">
<h3>ZlibArchive<a class="headerlink" href="#zlibarchive" title="Permalink to this headline">¶</a></h3>
<p>A ZlibArchive contains compressed <code class="docutils literal notranslate"><span class="pre">.pyc</span></code> or <code class="docutils literal notranslate"><span class="pre">.pyo</span></code> files.
The <code class="docutils literal notranslate"><span class="pre">PYZ</span></code> class invocation in a spec file creates a ZlibArchive.</p>
<p>The table of contents in a ZlibArchive
is a Python dictionary that associates a key,
which is a member’s name as given in an <code class="docutils literal notranslate"><span class="pre">import</span></code> statement,
with a seek position and a length in the ZlibArchive.
All parts of a ZlibArchive are stored in the
<a class="reference external" href="http://docs.python.org/library/marshal">marshalled</a> format and so are platform-independent.</p>
<p>A ZlibArchive is used at run-time to import bundled python modules.
Even with maximum compression this works  faster than the normal import.
Instead of searching <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.path" title="(in Python v3.10)"><code class="xref py py-data docutils literal notranslate"><span class="pre">sys.path</span></code></a>, there’s a lookup in the dictionary.
There are no directory operations and no
file to open (the file is already open).
There’s just a seek, a read and a decompress.</p>
<p>A Python error trace will point to the source file from which the archive
entry was created (the <code class="docutils literal notranslate"><span class="pre">__file__</span></code> attribute from the time the
<code class="docutils literal notranslate"><span class="pre">.pyc</span></code> was compiled, captured and saved in the archive).
This will not tell your user anything useful,
but if they send you a Python error trace,
you can make sense of it.</p>
<div class="figure align-default" id="id6">
<img alt="Structure of the ZlibArchive" src="_images/ZlibArchive.png" />
<p class="caption"><span class="caption-text">Structure of the ZlibArchive</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="carchive">
<h3>CArchive<a class="headerlink" href="#carchive" title="Permalink to this headline">¶</a></h3>
<p>A CArchive can contain any kind of file.
It’s very much like a <code class="docutils literal notranslate"><span class="pre">.zip</span></code> file.
They are easy to create in Python and easy to unpack from C code.
A CArchive can be appended to another file, such as
an ELF and COFF executable.
To allow this, the archive is made with its table of contents at the
end of the file, followed only by a cookie that tells where the
table of contents starts and
where the archive itself starts.</p>
<p>A CArchive can be embedded within another CArchive.
An inner archive can be opened and used in place,
without having to extract it.</p>
<p>Each table of contents entry has variable length.
The first field in the entry gives the length of the entry.
The last field is the name of the corresponding packed file.
The name is null terminated.
Compression is optional for each member.</p>
<p>There is also a type code associated with each member.
The type codes are used by the self-extracting executables.
If you’re using a <code class="docutils literal notranslate"><span class="pre">CArchive</span></code> as a <code class="docutils literal notranslate"><span class="pre">.zip</span></code> file, you don’t need to worry about the code.</p>
<p>The ELF executable format (Windows, GNU/Linux and some others) allows arbitrary
data to be concatenated to the end of the executable without disturbing its
functionality. For this reason, a CArchive’s Table of Contents is
at the end of the archive. The executable can open itself as a binary
file, seek to the end and ‘open’ the CArchive.</p>
<div class="figure align-default" id="id7">
<img alt="CArchive" src="_images/CArchive.png" />
<p class="caption"><span class="caption-text">Structure of the CArchive</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id8">
<img alt="Structure of the Self Extracting Executable" src="_images/SE_exe.png" />
<p class="caption"><span class="caption-text">Structure of the Self Extracting Executable</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="using-pyi-archive-viewer">
<h3>Using pyi-archive_viewer<a class="headerlink" href="#using-pyi-archive-viewer" title="Permalink to this headline">¶</a></h3>
<p>Use the <code class="docutils literal notranslate"><span class="pre">pyi-archive_viewer</span></code> command to inspect any type of archive:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">pyi-archive_viewer</span></code> <em>archivefile</em></p>
</div></blockquote>
<p>With this command you can examine the contents of any archive built with
<cite>PyInstaller</cite> (a <code class="docutils literal notranslate"><span class="pre">PYZ</span></code> or <code class="docutils literal notranslate"><span class="pre">PKG</span></code>), or any executable (<code class="docutils literal notranslate"><span class="pre">.exe</span></code> file
or an ELF or COFF binary).
The archive can be navigated using these commands:</p>
<dl class="simple">
<dt>O <em>name</em></dt><dd><p>Open the embedded archive <em>name</em> (will prompt if omitted).
For example when looking in a one-file executable, you
can open the <code class="docutils literal notranslate"><span class="pre">PYZ-00.pyz</span></code> archive inside it.</p>
</dd>
<dt>U</dt><dd><p>Go up one level (back to viewing the containing archive).</p>
</dd>
<dt>X <em>name</em></dt><dd><p>Extract <em>name</em> (will prompt if omitted).
Prompts for an output filename.
If none given, the member is extracted to stdout.</p>
</dd>
<dt>Q</dt><dd><p>Quit.</p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">pyi-archive_viewer</span></code> command has these options:</p>
<dl class="option-list">
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>Show help.</p>
</dd>
<dt><kbd><span class="option">-l</span>, <span class="option">--log</span></kbd></dt>
<dd><p>Quick contents log.</p>
</dd>
<dt><kbd><span class="option">-b</span>, <span class="option">--brief</span></kbd></dt>
<dd><p>Print a python evaluable list of contents filenames.</p>
</dd>
<dt><kbd><span class="option">-r</span>, <span class="option">--recursive</span></kbd></dt>
<dd><p>Used with -l or -b, applies recursive behaviour.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="inspecting-executables">
<span id="id4"></span><h2>Inspecting Executables<a class="headerlink" href="#inspecting-executables" title="Permalink to this headline">¶</a></h2>
<p>You can inspect any executable file with <code class="docutils literal notranslate"><span class="pre">pyi-bindepend</span></code>:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">pyi-bindepend</span></code> <em>executable_or_dynamic_library</em></p>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">pyi-bindepend</span></code> command analyzes the executable or DLL you name
and writes to stdout all its binary dependencies.
This is handy to find out which DLLs are required by
an executable or by another DLL.</p>
<p><code class="docutils literal notranslate"><span class="pre">pyi-bindepend</span></code> is used by <cite>PyInstaller</cite> to
follow the chain of dependencies of binary extensions
during Analysis.</p>
</div>
<div class="section" id="creating-a-reproducible-build">
<span id="id5"></span><h2>Creating a Reproducible Build<a class="headerlink" href="#creating-a-reproducible-build" title="Permalink to this headline">¶</a></h2>
<p>In certain cases it is important that when you build the same application twice,
using exactly the same set of dependencies,
the two bundles should be exactly, bit-for-bit identical.</p>
<p>That is not the case normally.
Python uses a random hash to make dicts and other hashed types,
and this affects compiled byte-code as well as <cite>PyInstaller</cite>
internal data structures.
As a result, two builds may not produce bit-for-bit identical results
even when all the components of the application bundle are the same
and the two applications execute in identical ways.</p>
<p>You can ensure that a build will produce the same bits
by setting the <span class="target" id="index-2"></span><a class="reference external" href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHASHSEED" title="(in Python v3.10)"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHASHSEED</span></code></a> environment variable to a known
integer value before running <cite>PyInstaller</cite>.
This forces Python to use the same random hash sequence until
<span class="target" id="index-3"></span><a class="reference external" href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHASHSEED" title="(in Python v3.10)"><code class="xref std std-envvar docutils literal notranslate"><span class="pre">PYTHONHASHSEED</span></code></a> is unset or set to <code class="docutils literal notranslate"><span class="pre">'random'</span></code>.
For example, execute <cite>PyInstaller</cite> in a script such as
the following (for GNU/Linux and OS X):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># set seed to a known repeatable integer value</span>
<span class="n">PYTHONHASHSEED</span><span class="o">=</span><span class="mi">1</span>
<span class="n">export</span> <span class="n">PYTHONHASHSEED</span>
<span class="c1"># create one-file build as myscript</span>
<span class="n">pyinstaller</span> <span class="n">myscript</span><span class="o">.</span><span class="n">spec</span>
<span class="c1"># make checksum</span>
<span class="n">cksum</span> <span class="n">dist</span><span class="o">/</span><span class="n">myscript</span><span class="o">/</span><span class="n">myscript</span> <span class="o">|</span> <span class="n">awk</span> <span class="s1">'{print $1}'</span> <span class="o">&gt;</span> <span class="n">dist</span><span class="o">/</span><span class="n">myscript</span><span class="o">/</span><span class="n">checksum</span><span class="o">.</span><span class="n">txt</span>
<span class="c1"># let Python be unpredictable again</span>
<span class="n">unset</span> <span class="n">PYTHONHASHSEED</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 4.8: </span>The build timestamp in the PE headers of the generated Windows
executables is set to the current time during the assembly process.
A custom timestamp value can be specified via the <code class="docutils literal notranslate"><span class="pre">SOURCE_DATE_EPOCH</span></code>
environment variable to achieve <a class="reference external" href="https://reproducible-builds.org/docs/source-date-epoch">reproducible builds</a>.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="hooks.html" class="btn btn-neutral float-right" title="Understanding PyInstaller Hooks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="when-things-go-wrong.html" class="btn btn-neutral float-left" title="When Things Go Wrong" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr /><div><div id="rtd-sidebar" data-ea-publisher="readthedocs" data-ea-type="readthedocs-sidebar" data-ea-manual="true" class="ethical-rtd loaded" data-ea-keywords="bundle|package|python|readthedocs-project-49038|readthedocs-project-pyinstaller" data-ea-campaign-types="community|house"><div class="ethical-sidebar"><div class="ethical-content"><a href="https://server.ethicalads.io/proxy/click/1639/307e4865-e3a4-4b96-900c-10db96f97685/" rel="nofollow noopener" target="_blank" class="ethical-image-link"><img src="https://media.ethicalads.io/media/images/2020/01/readthedocs-logo-fs8_k6Ps9wN.png" alt="Sponsored: Read the Docs" /></a><div class="ethical-text"><a href="https://server.ethicalads.io/proxy/click/1639/307e4865-e3a4-4b96-900c-10db96f97685/" rel="nofollow noopener" target="_blank"><strong>Read the Docs for Business: </strong><span>Private repos with Pull Request reviews.</span><strong> Start your free trial today.</strong></a></div></div><div class="ethical-callout"><small><em><a rel="nofollow noopener" target="_blank" href="https://ethicalads.io?ref=rtd-sidebar">Ad by EthicalAds</a><span>   ·   </span><a rel="nofollow noopener" target="_blank" href="https://www.ethicalads.io/publishers/?ref=rtd-sidebar-join">Monetize your site</a></em></small></div></div></div></div>

  <div role="contentinfo">
    <p>
        © Copyright This document has been placed in the public domain..
      <span class="commit">
        
        Revision <code>d006b364</code>.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: stable
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions"><!-- Inserted RTD Footer -->

<div class="injected">

  

      
      
      
      <dl>
        <dt>版本</dt>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/latest/advanced-topics.html">latest</a>
        </dd>
        
        <dd class="rtd-current-item">
          <a href="https://pyinstaller.readthedocs.io/en/stable/advanced-topics.html">stable</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.9/advanced-topics.html">v4.9</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.8/advanced-topics.html">v4.8</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.7/advanced-topics.html">v4.7</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.6/advanced-topics.html">v4.6</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.5.1/advanced-topics.html">v4.5.1</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.5/advanced-topics.html">v4.5</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.4/advanced-topics.html">v4.4</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.2/advanced-topics.html">v4.2</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.1/advanced-topics.html">v4.1</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v4.0/advanced-topics.html">v4.0</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v3.6/advanced-topics.html">v3.6</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v3.5/advanced-topics.html">v3.5</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v3.4/advanced-topics.html">v3.4</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v3.3.1/advanced-topics.html">v3.3.1</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v3.3/advanced-topics.html">v3.3</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v3.2.1/advanced-topics.html">v3.2.1</a>
        </dd>
        
        <dd>
          <a href="https://pyinstaller.readthedocs.io/en/v3.2/advanced-topics.html">v3.2</a>
        </dd>
        
      </dl>
      
      

      
      
      <dl>
        <dt>下载</dt>
        
        <dd><a href="//pyinstaller.readthedocs.io/_/downloads/en/stable/pdf/">PDF</a></dd>
        
        <dd><a href="//pyinstaller.readthedocs.io/_/downloads/en/stable/htmlzip/">HTML</a></dd>
        
        <dd><a href="//pyinstaller.readthedocs.io/_/downloads/en/stable/epub/">Epub</a></dd>
        
      </dl>
      
      

      
      <dl>
        
        <!-- These are kept as relative links for internal installs that are http -->
        <dt>On Read the Docs</dt>
        <dd>
          <a href="//readthedocs.org/projects/pyinstaller/">Project Home</a>
        </dd>
        <dd>
          <a href="//readthedocs.org/projects/pyinstaller/builds/">构建</a>
        </dd>
        <dd>
          <a href="//readthedocs.org/projects/pyinstaller/downloads/">下载</a>
        </dd>
      </dl>
      

      

      
      <dl>
        <dt>On GitHub</dt>
        <dd>
          <a href="https://github.com/pyinstaller/pyinstaller/blob/d006b364cfabd1ac23f57c28b92d385331987edf/doc/advanced-topics.rst">View</a>
        </dd>
        
      </dl>
      
      

      
      <dl>
        <dt>搜索</dt>
        <dd>
          <div style="padding: 6px;">
            
            <form id="flyout-search-form" class="wy-form" target="_blank" action="//readthedocs.org/projects/pyinstaller/search/" method="get">
              <input type="text" name="q" aria-label="Search docs" placeholder="Search docs" />
              </form>
          </div>
        </dd>
      </dl>
      

      <hr />

      
        <small>
          <span>Hosted by <a href="https://readthedocs.org">Read the Docs</a></span>
          <span> · </span>
          <a href="https://docs.readthedocs.io/page/privacy-policy.html">Privacy Policy</a>
        </small>
      

      

</div>
</div>
  </div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   


</body></html>