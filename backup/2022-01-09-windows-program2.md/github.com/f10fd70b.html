---
title : 自动快照存档
---

* TIME: 2021-03-06 22:13:07
* URL: <https://github.com/microsoft/Detours>

-----

Skip to content

[ ](https://github.com/)

[ Sign up
](/join?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-
name%3E%2F%3Crepo-name%3E&source=header-repo)

  * Why GitHub? 

[Features →](/features)

    * [Mobile →](/mobile)
    * [Actions →](/features/actions)
    * [Codespaces →](/features/codespaces)
    * [Packages →](/features/packages)
    * [Security →](/features/security)
    * [Code review →](/features/code-review/)
    * [Project management →](/features/project-management/)
    * [Integrations →](/features/integrations)
    * [GitHub Sponsors →](/sponsors)
    * [Customer stories→](/customer-stories)

  * [Team](/team)
  * [Enterprise](/enterprise)
  * Explore 

    * [Explore GitHub →](/explore)

#### Learn and contribute

    * [Topics →](/topics)
    * [Collections →](/collections)
    * [Trending →](/trending)
    * [Learning Lab →](https://lab.github.com/)
    * [Open source guides →](https://opensource.guide)

#### Connect with others

    * [The ReadME Project →](https://github.com/readme)
    * [Events →](https://github.com/events)
    * [Community forum →](https://github.community)
    * [GitHub Education →](https://education.github.com)
    * [GitHub Stars program →](https://stars.github.com)

  * [Marketplace](/marketplace)
  * Pricing 

[Plans →](/pricing)

    * [Compare plans →](/pricing#feature-comparison)
    * [Contact Sales →](https://enterprise.github.com/contact)
    * [Nonprofit →](/nonprofit)
    * [Education →](https://education.github.com)

![](https://github.githubassets.com/images/search-key-slash.svg)

  * [ ![]() In this repository  All GitHub  ↵ Jump to ↵ ]()

  * No suggested jump to results

  * [ ![]() In this repository  All GitHub  ↵ Jump to ↵ ]()
  * [ ![]() In this organization  All GitHub  ↵ Jump to ↵ ]()
  * [ ![]() In this repository  All GitHub  ↵ Jump to ↵ ]()

[ Sign in ](/login?return_to=%2Fmicrosoft%2FDetours) [ Sign up
](/join?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-
name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=microsoft%2FDetours)

{{ message }}

#  [microsoft](/microsoft) / **[Detours](/microsoft/Detours) **

  * [ Notifications ](/login?return_to=%2Fmicrosoft%2FDetours)
  * [ Star ](/login?return_to=%2Fmicrosoft%2FDetours) [ 2.5k ](/microsoft/Detours/stargazers)
  * [ Fork ](/login?return_to=%2Fmicrosoft%2FDetours) [ 575 ](/microsoft/Detours/network/members)

Detours is a software package for monitoring and instrumenting API calls on
Windows. It is distributed in source code form.

[ MIT License ](/microsoft/Detours/blob/master/LICENSE.md)

[ 2.5k stars ](/microsoft/Detours/stargazers) [ 575 forks
](/microsoft/Detours/network/members)

[ Star ](/login?return_to=%2Fmicrosoft%2FDetours)

[ Notifications ](/login?return_to=%2Fmicrosoft%2FDetours)

  * [ Code ](/microsoft/Detours)
  * [ Issues 25 ](/microsoft/Detours/issues)
  * [ Pull requests 7 ](/microsoft/Detours/pulls)
  * [ Actions ](/microsoft/Detours/actions)
  * [ Projects 1 ](/microsoft/Detours/projects)
  * [ Wiki ](/microsoft/Detours/wiki)
  * [ Security ](/microsoft/Detours/security)
  * [ Insights ](/microsoft/Detours/pulse)

More

  * [ Code ](/microsoft/Detours)
  * [ Issues ](/microsoft/Detours/issues)
  * [ Pull requests ](/microsoft/Detours/pulls)
  * [ Actions ](/microsoft/Detours/actions)
  * [ Projects ](/microsoft/Detours/projects)
  * [ Wiki ](/microsoft/Detours/wiki)
  * [ Security ](/microsoft/Detours/security)
  * [ Insights ](/microsoft/Detours/pulse)

master

Switch branches/tags

Branches Tags

Nothing to show

[ {{ refName }} default ](https://github.com/microsoft/Detours/tree/{{
urlEncodedRefName }}) [View all branches](/microsoft/Detours/branches)

Nothing to show

[ {{ refName }} default ](https://github.com/microsoft/Detours/tree/{{
urlEncodedRefName }})

[View all tags](/microsoft/Detours/tags)

[ **2** branches ](/microsoft/Detours/branches) [ **1** tag
](/microsoft/Detours/tags)

[ Go to file ](/microsoft/Detours/find/master) Code

[ ](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone

HTTPS  GitHub CLI

Use Git or checkout with SVN using the web URL.

Work fast with our official CLI. [Learn more](https://cli.github.com).

  * [ Open with GitHub Desktop ](https://desktop.github.com)
  * [ Download ZIP ](/microsoft/Detours/archive/master.zip)

#### Launching GitHub Desktop

If nothing happens, [download GitHub Desktop](https://desktop.github.com/) and
try again.

Go back

#### Launching GitHub Desktop

If nothing happens, [download GitHub Desktop](https://desktop.github.com/) and
try again.

Go back

#### Launching Xcode

If nothing happens, [download Xcode](https://developer.apple.com/xcode/) and
try again.

Go back

#### Launching Visual Studio

If nothing happens, [download the GitHub extension for Visual
Studio](https://visualstudio.github.com/) and try again.

Go back

## Latest commit

[ ![@sylveon](https://avatars.githubusercontent.com/u/6440374?s=48&v=4)
](/sylveon)

[sylveon](/microsoft/Detours/commits?author=sylveon "View all commits by
sylveon") and Charles Milette [Feature: Add DetourFindRemotePayload and
improve other payload-
relate…](/microsoft/Detours/commit/8cbb9e2b822d96d534400da915a5dc258ab65a9a
"Feature: Add DetourFindRemotePayload and improve other payload-related
methods \(#81\)

Other improvements:

- Makes the pcbData parameter in DetourFindPayload and DetourFindPayloadEx optional, so that if an application only needs to search for the presence of a payload, they can ignore the size by passing nullptr.

- Makes the pvData parameter in DetourCopyPayloadToProcess const, so that a pointer to a const C++ object can be passed instead of the object needing to be const_casted or being non-const.

- Adds DetourCopyPayloadToProcessEx, which has the same interface than DetourCopyPayloadToProcess, but it returns the address of the payload in the remote module, if the program later wants to write to it.

- Add payload example and extra unit tests covering new APIs. 

Fixes #79

Co-authored-by: Charles Milette <me@charlesmilette.net>")

…

Loading status checks…

[ 8cbb9e2
](/microsoft/Detours/commit/8cbb9e2b822d96d534400da915a5dc258ab65a9a) [ 6
hours ago
](/microsoft/Detours/commit/8cbb9e2b822d96d534400da915a5dc258ab65a9a)

[Feature: Add DetourFindRemotePayload and improve other payload-
relate…](/microsoft/Detours/commit/8cbb9e2b822d96d534400da915a5dc258ab65a9a)

    
    
    …d methods ([#81](https://github.com/microsoft/Detours/pull/81))
    
    Other improvements:
    
    - Makes the pcbData parameter in DetourFindPayload and DetourFindPayloadEx optional, so that if an application only needs to search for the presence of a payload, they can ignore the size by passing nullptr.
    
    - Makes the pvData parameter in DetourCopyPayloadToProcess const, so that a pointer to a const C++ object can be passed instead of the object needing to be const_casted or being non-const.
    
    - Adds DetourCopyPayloadToProcessEx, which has the same interface than DetourCopyPayloadToProcess, but it returns the address of the payload in the remote module, if the program later wants to write to it.
    
    - Add payload example and extra unit tests covering new APIs. 
    
    Fixes [#79](https://github.com/microsoft/Detours/issues/79)
    
    Co-authored-by: Charles Milette <me@charlesmilette.net>

8cbb9e2

## Git stats

  * [ **93** commits  ](/microsoft/Detours/commits/master)

## Files

[Permalink](/microsoft/Detours/tree/8cbb9e2b822d96d534400da915a5dc258ab65a9a)

Failed to load latest commit information.

Type

Name

Latest commit message

Commit time

[.github](/microsoft/Detours/tree/master/.github ".github")

[CI: Only run CodeQL for Debug matrix configuration
(](/microsoft/Detours/commit/58a61c7cc6db01f0b7e6e08ea77d71c34abda8dc "CI:
Only run CodeQL for Debug matrix configuration \(#179\)

The new "Debug" build now compiles all code.

So there's no use in running static analysis on
Release.")[#179](https://github.com/microsoft/Detours/pull/179)[)](/microsoft/Detours/commit/58a61c7cc6db01f0b7e6e08ea77d71c34abda8dc
"CI: Only run CodeQL for Debug matrix configuration \(#179\)

The new "Debug" build now compiles all code.

So there's no use in running static analysis on Release.")

4 days ago

[samples](/microsoft/Detours/tree/master/samples "samples")

[Feature: Add DetourFindRemotePayload and improve other payload-
relate…](/microsoft/Detours/commit/8cbb9e2b822d96d534400da915a5dc258ab65a9a
"Feature: Add DetourFindRemotePayload and improve other payload-related
methods \(#81\)

Other improvements:

- Makes the pcbData parameter in DetourFindPayload and DetourFindPayloadEx optional, so that if an application only needs to search for the presence of a payload, they can ignore the size by passing nullptr.

- Makes the pvData parameter in DetourCopyPayloadToProcess const, so that a pointer to a const C++ object can be passed instead of the object needing to be const_casted or being non-const.

- Adds DetourCopyPayloadToProcessEx, which has the same interface than DetourCopyPayloadToProcess, but it returns the address of the payload in the remote module, if the program later wants to write to it.

- Add payload example and extra unit tests covering new APIs. 

Fixes #79

Co-authored-by: Charles Milette <me@charlesmilette.net>")

6 hours ago

[src](/microsoft/Detours/tree/master/src "src")

[Feature: Add DetourFindRemotePayload and improve other payload-
relate…](/microsoft/Detours/commit/8cbb9e2b822d96d534400da915a5dc258ab65a9a
"Feature: Add DetourFindRemotePayload and improve other payload-related
methods \(#81\)

Other improvements:

- Makes the pcbData parameter in DetourFindPayload and DetourFindPayloadEx optional, so that if an application only needs to search for the presence of a payload, they can ignore the size by passing nullptr.

- Makes the pvData parameter in DetourCopyPayloadToProcess const, so that a pointer to a const C++ object can be passed instead of the object needing to be const_casted or being non-const.

- Adds DetourCopyPayloadToProcessEx, which has the same interface than DetourCopyPayloadToProcess, but it returns the address of the payload in the remote module, if the program later wants to write to it.

- Add payload example and extra unit tests covering new APIs. 

Fixes #79

Co-authored-by: Charles Milette <me@charlesmilette.net>")

6 hours ago

[tests](/microsoft/Detours/tree/master/tests "tests")

[Feature: Add DetourFindRemotePayload and improve other payload-
relate…](/microsoft/Detours/commit/8cbb9e2b822d96d534400da915a5dc258ab65a9a
"Feature: Add DetourFindRemotePayload and improve other payload-related
methods \(#81\)

Other improvements:

- Makes the pcbData parameter in DetourFindPayload and DetourFindPayloadEx optional, so that if an application only needs to search for the presence of a payload, they can ignore the size by passing nullptr.

- Makes the pvData parameter in DetourCopyPayloadToProcess const, so that a pointer to a const C++ object can be passed instead of the object needing to be const_casted or being non-const.

- Adds DetourCopyPayloadToProcessEx, which has the same interface than DetourCopyPayloadToProcess, but it returns the address of the payload in the remote module, if the program later wants to write to it.

- Add payload example and extra unit tests covering new APIs. 

Fixes #79

Co-authored-by: Charles Milette <me@charlesmilette.net>")

6 hours ago

[vc](/microsoft/Detours/tree/master/vc "vc")

[Feature: Add safe DetoursAttach (and friends) overloads
(](/microsoft/Detours/commit/784f155d91c158ba0d17b087e344a09e4eabc73f
"Feature: Add safe DetoursAttach \(and friends\) overloads \(#178\)

Fixes #176

I've also added a sample \(a copy of the `simple` sample, but without the
`\(PVOID&\)` casts\) to validate the
functionality.")[#178](https://github.com/microsoft/Detours/pull/178)[)](/microsoft/Detours/commit/784f155d91c158ba0d17b087e344a09e4eabc73f
"Feature: Add safe DetoursAttach \(and friends\) overloads \(#178\)

Fixes #176

I've also added a sample \(a copy of the `simple` sample, but without the
`\(PVOID&\)` casts\) to validate the functionality.")

4 days ago

[.gitignore](/microsoft/Detours/blob/master/.gitignore ".gitignore")

[add vs solution, it is safety because it only call nmake command,
and…](/microsoft/Detours/commit/73e9a0a34cab4f5c903a601f394250e89a8be9fe "add
vs solution, it is safety because it only call nmake command, and it is
friendly for edit, modify and debug code in Detours \(#138\)")

6 months ago

[CREDITS.md](/microsoft/Detours/blob/master/CREDITS.md "CREDITS.md")

[Maintenance: Reformat CREDITS.TXT ->
CREDITS.md](/microsoft/Detours/commit/8be832ee51308afa5a2e195e9f1f247ae2c9492c
"Maintenance: Reformat CREDITS.TXT -> CREDITS.md")

last month

[LICENSE.md](/microsoft/Detours/blob/master/LICENSE.md "LICENSE.md")

[Initial fork of Detours 4.0 from Detours 3.0
archive.](/microsoft/Detours/commit/e5400b4ec59478cb0f435cf3b1338226bcbe28f6
"Initial fork of Detours 4.0 from Detours 3.0 archive.")

4 years ago

[Makefile](/microsoft/Detours/blob/master/Makefile "Makefile")

[Tests: Add initial set of unit tests for Detours
(](/microsoft/Detours/commit/2de2babb256be6997f9d8f65166bebd84fe39d87 "Tests:
Add initial set of unit tests for Detours \(#137\)

- Import the Catch2 self-contained C++ test framework.
  It's used by many Microsoft OSS projects:

  - https://github.com/microsoft/cppwinrt/tree/master/test
  - https://github.com/microsoft/wil/tree/master/tests
  As well as many OSS projects in general.

  When the CMake PR is merged, we can remove this as

  a checked in development dependency, and can instead

  download it using CMake.

- Start basic set of unit tests to validate failure modes of

- Hook the execution into the existing NMake build system.

- Hook test execution into CI pipeline")[#137](https://github.com/microsoft/Detours/pull/137)[)](/microsoft/Detours/commit/2de2babb256be6997f9d8f65166bebd84fe39d87 "Tests: Add initial set of unit tests for Detours \(#137\)

- Import the Catch2 self-contained C++ test framework.
  It's used by many Microsoft OSS projects:

  - https://github.com/microsoft/cppwinrt/tree/master/test
  - https://github.com/microsoft/wil/tree/master/tests
  As well as many OSS projects in general.

  When the CMake PR is merged, we can remove this as

  a checked in development dependency, and can instead

  download it using CMake.

- Start basic set of unit tests to validate failure modes of

- Hook the execution into the existing NMake build system.

- Hook test execution into CI pipeline")

3 months ago

[README.md](/microsoft/Detours/blob/master/README.md "README.md")

[README.md link to License
file](/microsoft/Detours/commit/a3bdeaf006d0df813fd8616cd4d2cb36f970ed0c
"README.md link to License file")

6 months ago

[system.mak](/microsoft/Detours/blob/master/system.mak "system.mak")

[Maintenace + CI: Enable debug logging on 'Debug' build configs
(](/microsoft/Detours/commit/259ad4173a12a0c3e0586cf696084fcf07ff3364
"Maintenace + CI: Enable debug logging on 'Debug' build configs \(#175\)

This enables 'Debug' build configs to build the debug output and breakpoints,

and fixes all mistakes that slipped in printf format
specifiers.")[#175](https://github.com/microsoft/Detours/pull/175)[)](/microsoft/Detours/commit/259ad4173a12a0c3e0586cf696084fcf07ff3364
"Maintenace + CI: Enable debug logging on 'Debug' build configs \(#175\)

This enables 'Debug' build configs to build the debug output and breakpoints,

and fixes all mistakes that slipped in printf format specifiers.")

5 days ago

View code

##  README.md

# Microsoft Research Detours Package

Detours is a software package for monitoring and instrumenting API calls on
Windows. Detours has been used by many ISVs and is also used by product teams
at Microsoft. Detours is now available under a standard open source license
([MIT](https://github.com/microsoft/Detours/blob/master/LICENSE.md)). This
simplifies licensing for programmers using Detours and allows the community to
support Detours using open source tools and processes.

Detours is compatible with the Windows NT family of operating systems: Windows
NT, Windows XP, Windows Server 2003, Windows 7, Windows 8, and Windows 10. It
cannot be used by Windows Store apps because Detours requires APIs not
available to those applications. This repo contains the source code for
version 4.0.1 of Detours.

For technical documentation on Detours, see the [Detours
Wiki](https://github.com/microsoft/Detours/wiki). For directions on how to
build and run samples, see the samples
[README.txt](https://github.com/Microsoft/Detours/blob/master/samples/README.TXT)
file.

## Contributing

The [`Detours`](https://github.com/microsoft/detours) repository is where
development is done. Here are some ways you can participate in the project:

  * [Answer questions](https://github.com/microsoft/detours/issues) about using Detours.
  * [Improve the Wiki](https://github.com/microsoft/detours/wiki).
  * [Submit bugs](https://github.com/microsoft/detours/issues) and help us verify fixes and changes as they are checked in.
  * Review [source code changes](https://github.com/microsoft/detours/pulls).

Most contributions require you to agree to a Contributor License Agreement
(CLA) declaring that you have the right to, and actually do, grant us the
rights to use your contribution. For details, visit
<https://cla.opensource.microsoft.com>.

When you submit a pull request, a CLA bot will automatically determine whether
you need to provide a CLA and decorate the PR appropriately (e.g., status
check, comment). Simply follow the instructions provided by the bot. You will
only need to do this once across all repos using our CLA.

This project has adopted the [Microsoft Open Source Code of
Conduct](https://opensource.microsoft.com/codeofconduct/). For more
information see the [Code of Conduct
FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or contact
[opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional
questions or comments.

## Issues, questions, and feedback

  * Open an issue on [GitHub Issues](https://github.com/Microsoft/detours/issues).

## Mailing list for announcements

The detours-announce mailing list is a low-traffic email list for important
announcements about the project, such as the availability of new versions of
Detours. To join it, send an email to
[listserv@lists.research.microsoft.com](mailto:listserv@lists.research.microsoft.com)
with a message body containing only the text SUBSCRIBE DETOURS-ANNOUNCE. To
leave it, send an email to
[listserv@lists.research.microsoft.com](mailto:listserv@lists.research.microsoft.com)
with a message body containing only the text UNSUBSCRIBE DETOURS-ANNOUNCE.

## License

Copyright (c) Microsoft Corporation. All rights reserved.

Licensed under the [MIT](/microsoft/Detours/blob/master/LICENSE.md) License.

## About

Detours is a software package for monitoring and instrumenting API calls on
Windows. It is distributed in source code form.

### Resources

Readme

### License

[ MIT License ](/microsoft/Detours/blob/master/LICENSE.md)

##  [ Releases 1 ](/microsoft/Detours/releases)

[ Version 4.0.1 of Detours Latest  on 17 Apr 2018
](/microsoft/Detours/releases/tag/v4.0.1)

##  [ Packages 0 ](/orgs/microsoft/packages?repo_name=Detours)

No packages published  

##  [ Contributors 30 ](/microsoft/Detours/graphs/contributors)

  * [ ![@bgianfo](https://avatars.githubusercontent.com/u/1212?s=64&v=4) ](/bgianfo)
  * [ ![@dtarditi](https://avatars.githubusercontent.com/u/11841034?s=64&v=4) ](/dtarditi)
  * [ ![@jaykrell](https://avatars.githubusercontent.com/u/1635728?s=64&v=4) ](/jaykrell)
  * [ ![@sonyps5201314](https://avatars.githubusercontent.com/u/20564099?s=64&v=4) ](/sonyps5201314)
  * [ ![@sylveon](https://avatars.githubusercontent.com/u/6440374?s=64&v=4) ](/sylveon)
  * [ ![@zeffy](https://avatars.githubusercontent.com/u/10877719?s=64&v=4) ](/zeffy)
  * [ ![@lironzua](https://avatars.githubusercontent.com/u/10958413?s=64&v=4) ](/lironzua)
  * [ ![@austinkinross](https://avatars.githubusercontent.com/u/8118471?s=64&v=4) ](/austinkinross)
  * [ ![@danikdanik](https://avatars.githubusercontent.com/u/8233041?s=64&v=4) ](/danikdanik)
  * [ ![@msmania](https://avatars.githubusercontent.com/u/1780142?s=64&v=4) ](/msmania)
  * [ ![@rchildre3](https://avatars.githubusercontent.com/u/10655240?s=64&v=4) ](/rchildre3)

[ \+ 19 contributors ](/microsoft/Detours/graphs/contributors)

## Languages

  * [ C++ 98.8% ](/microsoft/Detours/search?l=c%2B%2B)
  * [ Makefile 1.1% ](/microsoft/Detours/search?l=makefile)
  * [ C 0.1% ](/microsoft/Detours/search?l=c)

  * © 2021 GitHub, Inc.
  * [Terms](https://github.com/site/terms)
  * [Privacy](https://github.com/site/privacy)
  * [Security](https://github.com/security)
  * [Status](https://www.githubstatus.com/)
  * [Docs](https://docs.github.com)

[ ](https://github.com "GitHub")

  * [Contact GitHub](https://support.github.com)
  * [Pricing](https://github.com/pricing)
  * [API](https://docs.github.com)
  * [Training](https://services.github.com)
  * [Blog](https://github.blog)
  * [About](https://github.com/about)

You can’t perform that action at this time.

You signed in with another tab or window. [Reload]() to refresh your session.
You signed out in another tab or window. [Reload]() to refresh your session.

