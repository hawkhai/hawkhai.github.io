<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head>
  <meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="renderer" content="webkit" />
<meta name="force-rendering" content="webkit" />
<meta name="referrer" content="always" />
<meta name="description" content="安全客 - 安全资讯平台" />
<link rel="icon" href="https://s3.ssl.qhres2.com/static/02b5158bbb6adeac.ico" type="image/x-icon" />
<link rel="shortcut icon" href="https://s3.ssl.qhres2.com/static/02b5158bbb6adeac.ico" type="image/x-icon" />
<meta name="keywords" content="安全媒体,安全资讯,安全知识, 安全热点,安全招聘,安全趋势,移动安全,网站安全,终端安全,无线安全,工控安全,物联网安全,WEB安全,系统安全,网络安全,区块链安全,安全活动,信息安全,安全预警,安全会议" />

  <title>关于Python病毒样本的分析方法-安全客 - 安全资讯平台</title>
  <meta name="description" content="安全客 - 安全资讯平台" />
  <meta name="keywords" content="安全媒体,安全资讯,安全知识, 安全热点,安全招聘,安全趋势,移动安全,网站安全,终端安全,无线安全,工控安全,物联网安全,WEB安全,系统安全,网络安全,区块链安全,安全活动,信息安全,安全预警,安全会议" />
  <script>(function(window){
        

function empty() {}

empty();
      })(this);</script>

<link rel="stylesheet" href="https://s1.ssl.qhimg.com/static/d4cec9cd8efbfd10.css" />
<link rel="stylesheet" href="https://s1.ssl.qhimg.com/static/a51843d6b82241be,d94674bd62441768,56ce5cef8079a575,8514be0a921ca6e8,4802c0c382205144,8e4464e423fe6849,13c0bf3b0c2e4882,2b3936345af879da,f568b72da28701d3,da046392ff3eccb9,aa4b116b0af3b8cd,e0bfaead3067bbc1,fea7be2aa27ff2f2,d9201f9584eef2b6,fd21c2ec74567dad,b7a96d5b0251b853,5dcd3ae257726a93,1c6ca2a1950ce544,0faa71bef217b8bc,a36a201f0d041a4e,7344734df279a41a,edd5eea8fdbfac69,5f39838e3d3adabf,639096234333f66b,7315fe23da834588,e8c1651c2e73e657,05bbb034f84fe2cd,4c4133809419f2be,14794e88015634b7,a165d020d16c358a,315ee55058416496.css" />
<script>window._dynamic_deps_={}</script>
</head>

<body>
  <div id="app" data-v-app=""><div class="_9" style="height: 60px;"><div class="g-w"><a class="logo1" href="/"></a><div class="_10"><div class="item"><div style="cursor: pointer;"><span>首页</span><ul></ul></div></div><div class="item"><div><span>阅读</span><ul><li class="sub-item"><a href=" https://www.anquanke.com/news">安全资讯</a></li><li class="sub-item"><a href="https://www.anquanke.com/knowledge">安全知识</a></li><li class="sub-item"><a href="https://www.anquanke.com/tool">安全工具</a></li></ul></div></div><div class="item"><div style="cursor: pointer;"><span>活动</span><ul></ul></div></div><div class="item"><div style="cursor: pointer;"><span>招聘</span><ul></ul></div></div><div class="item"><div style="cursor: pointer;"><span>安全导航</span><ul></ul></div></div><div class="item"><div style="cursor: pointer;"><span>内容精选</span><ul><li class="sub-item"><a href="/column/index.html">专栏</a></li><li class="sub-item"><a href="https://www.anquanke.com/subject-list">精选专题</a></li><li class="sub-item"><a href="https://www.anquanke.com/discovery">安全客季刊</a></li><li class="sub-item"><a href="https://www.anquanke.com/week-list">360网络安全周报</a></li></ul></div></div></div><div class="_11"><div class="block"><div class="search"><input class="input" placeholder="输入关键词搜索" /><button class="button"></button></div><!----><div class="user-href js-login-body" style="display: none;"><div class="user-href-top"><p class="user-avatar-bottom"><img class="user-href-avatar" /><!----></p><div class="user-href-top-main"><p class="user-href-grade"></p><p class="user-href-text"><span>累计积分</span><span>可用积分</span></p><p class="user-href-score"><span></span><span></span></p></div></div><ul><li><a href="/member.html?memberId=undefined">个人主页</a></li><li><a href="https://www.anquanke.com/setting?p=message">我的消息</a></li><li><a href="/user/set1.html">个人设置</a></li><li><a href="/user/score/search.html">积分商城</a></li><li>退出登录</li></ul></div><a href="/login/index.html" class="nologin"></a></div><span class="write"></span><a class="app" href="https://www.anquanke.com/app"><div class="app-img"><img src="https://p0.ssl.qhimg.com/t01103704213901dd1e.png" /></div></a></div></div></div><div class="index"><div class="index-main"><div class="_55"><h1>关于Python病毒样本的分析方法</h1><div class="read"><p><span class="read-text">阅读量</span><b class="read-num">243342</b></p><!----><!----></div><p class="publish">发布时间 : 2020-12-29 17:30:48</p><div class="_54" style="display: none;"><b class="close">x</b><h5>译文声明</h5><p> 本文是翻译文章<!----><!----></p><!----><p>译文仅供参考，具体内容表达以及含义原文为准。</p></div><div class="content" id="js-article">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<p><img class="alignnone size-full wp-image-226834 aligncenter" alt="" width="360" height="360" src="https://p5.ssl.qhimg.com/t01a4f850cb1ea1b70f.png" /></p>
<p> </p>
<h2 name="h2-0" id="h2-0">前言</h2>
<p>近年来，Python语言凭借其入门简单、功能强大和开发效率高等特性逐渐成为最受欢迎的开发语言，与此同时，Python在安全领域的应用也渐趋广泛，开始被用在黑客和渗透测试的各个领域。</p>
<p>微步在线在威胁监控过程中，多次发现病毒木马或直接使用Python来编写，或使用Python打包的方式进行投递：如在2020年1月的一起针对阿拉伯地区的APT攻击事件中，攻击者通过投递携带CVE-2017-0199漏洞的docx文件，释放并运行了Python打包的后门程序；又如2019年11月份，Gaza（中东背景APT组织）也被发现使用了Python封装其木马组件。由此可见，Python在网络攻击事件中的出现日趋频繁，这也为安全分析人员带来新的挑战。</p>
<p class="ql-align-justify">经过分析发现，Python打包的病毒木马主要存在以下3种形式：</p>
<p class="ql-align-justify">1. 以py脚本的形式存在，此种方式最为常见，但也最容易阅读和分析。</p>
<p class="ql-align-justify">2. 将pyc文件结构打包到各种可执行文件中，如PyInstaller工具等。</p>
<p class="ql-align-justify">3. 通过Cython转换成C语言代码，再编译成可执行文件。</p>
<p class="ql-align-justify">其中，以第1种方式最为简单也最为常见，而第2种、第3种方法具有一定分析难度。本文针对第二种方式进行介绍，将介绍常见的Python打包工具的安装和使用方法，同时对典型的Python打包木马病毒进行分析，并讲述相关逆向分析技巧。</p>
<h2 name="h2-1" id="h2-1">常见Python打包工具</h2>
<h3 name="h3-2" id="h3-2"><strong>1. PyInstaller</strong></h3>
<p class="ql-align-justify"><strong>简介</strong></p>
<p class="ql-align-justify">PyInstaller 是一个用来将 Python 程序打包成一个独立可执行软件包，支持 Windows、Linux 和 macOS X。该工具是现在非常成熟的一款工具，具有良好的兼容性，支持的Python版本可达到Python3.7。</p>
<p class="ql-align-justify"><strong>使用方式</strong></p>
<p class="ql-align-justify">PyInstaller的使用方式非常简单：</p>
<p class="ql-align-justify">(1) pip install pyinstaller指令就可进行安装。</p>
<p class="ql-align-justify">(2) pyinstaller.exe -F yourcode.py指令就可进行简单打包。</p>
<p class="ql-align-justify"><strong>分析方法</strong></p>
<p class="ql-align-justify">PyInstaller打包的文件分析起来也十分简单，有现成的工具脚本——pyinstxtractor.py可以使用。pyinstxtractor.py的下载地址如下：</p>
<p class="ql-align-justify">https://sourceforge.net/projects/pyinstallerextractor/。</p>
<p class="ql-align-justify">用法也很简单，指令pyinstxtractor.py+可执行文件，就可以进行解包。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p1.ssl.qhimg.com/t01df1fa27fb9e2a237.png" /></p>
<h3 name="h3-3" id="h3-3"><strong>2. py2exe</strong></h3>
<p><strong>简介</strong></p>
<p class="ql-align-justify">Py2exe这个工具只能在Windows平台使用，Py2exe是一个开源项目，github的地址：https://github.com/py2exe/py2exe。Py2exe执行Python2和Python3。</p>
<p class="ql-align-justify"><strong>使用方式</strong></p>
<p class="ql-align-justify">(1) 下载地址，如下：</p>
<ol>
<li data-list="bullet">Python3可直接pip下载。</li>
<li data-list="bullet">Python2在https://sourceforge.net/projects/py2exe/files/py2exe/下载。</li>
</ol>
<p class="ql-align-justify">(2) 使用方法，如下：</p>
<p>使用需要创建一个set.py(名称随意),文件内容：</p>
<p>from distutils.core import setup</p>
<p>import py2exe</p>
<p>setup(windows=[‘1.py’])</p>
<p>set.py -h可查看帮助</p>
<p>python set.py py2exe指令可编译成exe文件</p>
<p>效果如下图：</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p2.ssl.qhimg.com/t01fe6343b9d57d73d2.png" /></p>
<p class="ql-align-justify"><strong>分析方法</strong></p>
<p class="ql-align-justify">(1) 在py2exe打包后的结果文件中，exe和python.dll都是必要组件。有时python.dll可能会被内嵌在exe中。</p>
<p class="ql-align-justify">(2) 可执行文件运行时必然会调用附带的python.dll。</p>
<p class="ql-align-justify">(3) 对python.dll的导出函数PyMarshal_ReadObjectFromString进行hook或者下断点。</p>
<p class="ql-align-justify">(4) 通过PyMarshal_ReadObjectFromString函数可以获取到打包进exe的pyc数据。该函数有两个参数，参数一是pyc数据的起始地址，参数二为数据的长度。</p>
<p class="ql-align-justify">注意：在py2exe中获取的pyc数据内包含多个模块，一定要将多个模块进行拆分再反编译，否则会出错的。</p>
<h3 name="h3-4" id="h3-4"><strong>3. bbFreeze</strong></h3>
<p><strong>简介</strong></p>
<p class="ql-align-justify">BBFreeze由BrainBot Technologies AG开发。</p>
<p class="ql-align-justify">GitHub的地址：</p>
<p class="ql-align-justify">https://github.com/schmir/bbfreeze。</p>
<p class="ql-align-justify"><strong>使用方式</strong></p>
<p class="ql-align-justify">(1) 下载地址，如下：</p>
<p class="ql-align-justify">可以通过pip或easy_install直接下载。</p>
<p class="ql-align-justify">(2) 使用方法，如下：</p>
<p class="ql-align-justify">指令：bbFreeze+py脚本</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t0119ae8640e358fe71.png" /></p>
<p class="ql-align-justify">输出结果如图：</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t01e98198debb7089ff.png" /></p>
<p class="ql-align-justify"><strong>分析方法</strong></p>
<p class="ql-align-justify">BBFreeze和其他工具有所差别，它是通过PyRun_StringFlags函数进行。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t013f58c05c0f7e7881.png" /></p>
<p class="ql-align-justify">BBFreeze会通过zip模块把随身携带的library.zip进行解压，再通过python的exec来进行执行。其中的library.zip可能会嵌在可执行文件当中。library.zip解压后如图：</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p1.ssl.qhimg.com/t01f7f08a17b1dbf821.png" /></p>
<h3 name="h3-5" id="h3-5"><strong>4. cx_Freeze</strong></h3>
<p class="ql-align-justify"><strong>简介</strong></p>
<p class="ql-align-justify">cx_Freeze也是一种用于将Python脚本打包成可执行文件的一种工具，使用起来和py2exe差不多。GitHub的地址：</p>
<p class="ql-align-justify">https://github.com/marcelotduarte/cx_Freeze</p>
<p class="ql-align-justify"><strong>使用方式</strong></p>
<p class="ql-align-justify">(1) 下载地址，如下：</p>
<p class="ql-align-justify">https://sourceforge.net/projects/cx-freeze</p>
<p class="ql-align-justify">也可使用pip进行下载。</p>
<p class="ql-align-justify">(2) 使用方法，如下：</p>
<p class="ql-align-justify">指令：cxfreeze+py脚本。</p>
<p class="ql-align-justify">输出文件如同：</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p2.ssl.qhimg.com/t019b25344aed486ca0.png" /></p>
<p class="ql-align-justify"><strong>分析方法</strong></p>
<p class="ql-align-justify">cx_Freeze打包的文件分析起来更为简单。cx_Freeze会将pyc文件直接以资源的形式放在资源段中。我们可以直接使用压缩工具进行打开：</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p3.ssl.qhimg.com/t01ba4fd366529aa153.png" /></p>
<h2 name="h2-6" id="h2-6">典型木马病毒分析</h2>
<p class="ql-align-justify">通过分析一个简单的样本来演示如何分析这一系列的样本。我们找到一个样本哈希287b67d9927b6a318de8c94ef525cc426f59dc2199ee0e0e1caf9ef0881e7555。</p>
<p>分析第一步需要判断该样本是由什么工具打包的：</p>
<p class="ql-align-justify">首先，我们可以看到有“_MEIPASS2=”字符串，从这可以看到该样本是由Python打包而来。从WinMain函数的代码来看，可以看出来该样本是PythonInstaller打包而来。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t01937d53ec594afdc1.png" /></p>
<p class="ql-align-justify">确定好是由什么工具打包后，可以使用之前提到的方式直接对其解包。使用pyinstxtractor.py脚本对其进行解包。解包后的文件列表大致如下：</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p2.ssl.qhimg.com/t019d54e86c5e574bbc.png" /></p>
<p class="ql-align-justify">其中我们可以看到解包后会生成python27.dll，从这可以看出来该样本是由Python2.7编写的。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p1.ssl.qhimg.com/t01ea086133cb3e4fdf.png" /></p>
<p class="ql-align-justify">我们大致可以看到，解包后的文件有很多。会有很多Python运行必要的组件和第三方组件，如：_socket.pyd、Crypto.Cipher._AES.pyd等。我们可以在文件列表内看到一个没有扩展名的文件：</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t01d7bac648c89b9a0d.png" /></p>
<p class="ql-align-justify">该文件就是我们需要样本核心代码。该文件的文件名就是打包前py文件的文件名，该文件的文件格式很接近pyc的文件格式。之间的差别就是在于文件头缺少majic字段和时间戳。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p1.ssl.qhimg.com/t01121be783d2c9a264.png" /></p>
<p class="ql-align-justify">我们添加一个Python2.7的majic字段和任意的时间戳。然后我们就可以使用uncompile.py脚本还原出该py文件。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t01b75f2d5b32c4e7dd.png" /></p>
<p class="ql-align-justify">对于这种常见工具打包的Python样本，我们通常处理的流程：</p>
<p>(1) 判断样本是由什么工具打包而来的。这种工具很常见，它们打包出来的程序往往很容易判断出来。</p>
<p>(2) 使用针对的破解工具或方法进行代码提取。</p>
<p>(3) 提取的代码通常是pyc文件格式的。</p>
<p>(4) 使用uncompile.py脚本进行反编译就可得到原始的py文件。</p>
<p class="ql-align-justify"><strong>其他Python打包分析</strong></p>
<p>通常情况下，病毒样本不会乖乖的使用以上几种工具进行打包。很多黑客会使用自己定制的程序来对python脚本进行打包。我们以一个样本举例，通过该样本来演示如何分析。该样本是一个由pupy的py脚本打包而来的elf文件。</p>
<p class="ql-align-justify">1. 分析该样本，发现该样本会在内存中解密释放libpython2.7.so.1.0这个so文件。该文件是python2.7的核心文件，导出函数都是python重要的api函数。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t0142325994c41bbc8a.png" /></p>
<p class="ql-align-justify">2. 在将libpython2.7.so.1.0，就该函数sub_5637CE90DFD2负责获取libpython2.7.so.1.0的导出函数。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p1.ssl.qhimg.com/t0146c8f91a6ed47627.png" /></p>
<p class="ql-align-justify">3. 将libpython2.7.so.1.0的导出函数地址初始化到imports全局变量内。通过使用dlsym函数，利用函数的名称来获取函数地址。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t01fe5260593bf0356b.png" /></p>
<p class="ql-align-justify">4. 之前已经将python api的地址存储在imports变量内，之后的调用也是通过imports变量来进行的，还原一下调用的python函数的符号，可以看到样本初始化python环境和执行的整个过程。</p>
<p class="ql-align-justify">首先是初始化python运行环境。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t01235fadf6425cf797.png" /></p>
<p class="ql-align-justify">随后初始化必要的python模块。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t01b8344620db97c78d.png" /></p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t0163311421fb45996a.png" /></p>
<p class="ql-align-justify">在准备好python运行环境后，就该是加载pupy的代码了。</p>
<p class="ql-align-justify">看到PyMarshal_ReadObjectFromString函数的时候，可以得知该样本使用脚本式来执行python的代码。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t01453df7f8d86974d7.png" /></p>
<p class="ql-align-justify">PyMarshal_ReadObjectFromString函数的主要功能是，读取一段数据，生成一个PyCodeObject的python对象。第一个参数是string的地址，第二个参数是数据的长度。</p>
<p class="ql-align-justify">5. PyMarshal_ReadObjectFromString的第一个参数就是pupy的字节码，这个字节码的实际格式是一个pyc文件。将这个string还原成pyc文件就可以恢复出pupy的py脚本。</p>
<ul>
<li>将PyMarshal_ReadObjectFromString的第一个参数数据保存到pyc文件中。注意，这个时候保存的pyc文件内并没有python的版本信息和时间戳。在文件头前添加8个字节，前四个字节表示python版本（不可随意填写，一定要是python2.7版本）、后四个字节表示时间戳（可随便填写）。</li>
</ul>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p2.ssl.qhimg.com/t01996ed4a8aad650e1.png" /></p>
<p class="ql-align-justify">
</p>
<ul>
<li>通过python的反编译脚本uncompyle6.py对保存的pyc文件进行反编译，就可以生成一个pupy的py脚本。通过对脚本的简单分析就可以十分确定这个样本是pupy家族的。脚本是开源的，具体的行为就不进行分析。</li>
</ul>
<p> </p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t0145341e02587bf378.png" /></p>
<p> </p>
<h2 name="h2-7" id="h2-7">总结</h2>
<p>通过对多个工具分析可以看到，无论是通过什么工具进行打包，都需要一个关键的因素，那就是python.dll或libpython.so。那么我们先来介绍一下python.dll在python中起到了什么作用。</p>
<p class="ql-align-justify">实质上，在整个Python的目录结构中，python.dll是最核心最基础的组件。Python的运行时环境就是在python.dll中实现的，这里包含了对象/类型系统、内存分配器和运行时状态信息。这里也就可以理解为什么任何方式进行打包都需要将对应的python.dll一同打包进去了。</p>
<p class="ql-align-justify">也就是说，无论什么工具，都是要通过python.dll来建立python的运行环境。这个过程是可以通过调用python.dll的导出函数来实现的。在python.dll的一个导出函数中，有个函数Py_Initialize就是用来初始化Python的运行环境。</p>
<p class="ql-align-justify">Python有两种主要的运行模式，一种是交互式模式，另一种是脚本运行方式。我们通过两个简单例子来演示一下：</p>
<h3 name="h3-8" id="h3-8"><strong>1. 脚本运行方式</strong></h3>
<p class="ql-align-justify">我们准备一个简单的py脚本，将其编译为pyc文件。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t0103ab2527b426c4e5.png" /></p>
<p class="ql-align-justify">我们准备一个简单的C代码来调用此pyc文件。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p3.ssl.qhimg.com/t016226a81cbcf68f81.png" /></p>
<p class="ql-align-justify">(1) 加载对应版本的python.dll。</p>
<p class="ql-align-justify">(2) 首先先调用Py_Initialize函数。</p>
<p class="ql-align-justify">(3) 随后调用PyRun_SimpleFile，来运行pyc文件。</p>
<h3 name="h3-9" id="h3-9"><strong>2. 输出结果</strong></h3>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p5.ssl.qhimg.com/t01cd34339f75bce121.png" /></p>
<h3 name="h3-10" id="h3-10"><strong>3. 交互式模式</strong></h3>
<p class="ql-align-justify">简单的C代码的例子：</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p4.ssl.qhimg.com/t01afbacea6ff451e21.png" /></p>
<p class="ql-align-justify">(1) 加载对应版本的python.dll。</p>
<p class="ql-align-justify">(2) 首先先调用Py_Initialize函数。</p>
<p class="ql-align-justify">(3) 接下来利用PyDict_New创建一个Dict。</p>
<p class="ql-align-justify">(4) 然后调用PyEval_GetBuiltins获取解释器。</p>
<p class="ql-align-justify">(5) 最后调用PyRun_String来执行各种代码。</p>
<h3 name="h3-11" id="h3-11"><strong>4. 运行结果</strong></h3>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t0101c127752472f4ed.png" /></p>
<p class="ql-align-justify">根据两个演示，可以很明确的知道Python的运行逻辑。在之后遇到的任何由Python打包的可执行文件时，可以通过对PyRun系列的函数进行检测。</p>
<p class="ql-align-center"><img class="aligncenter" data-original="https://p0.ssl.qhimg.com/t0183850fad94bf904f.png" /></p>
<p class="ql-align-justify">通过这一系列的函数，我们可以获取到打包进可执行文件内的明文Python脚本或pyc的字节码。</p>
<h3 name="h3-12" id="h3-12"><strong>5. 总结</strong></h3>
<p class="ql-align-justify">处理python打包这一系列样本的过程主要如下：</p>
<p class="ql-align-justify">(1) 判断是否是已知工具打包。</p>
<p class="ql-align-justify">(2) 如果不是已知工具，可着手查找PyRun系列的函数的调用。</p>
<p class="ql-align-justify">(3) 在PyRun系列的函数的参数中可以获取到对应的样本代码。</p>
<p class="ql-align-justify">(4) 使用uncompile.py脚本进行反编译就可得到原始的py文件。</p>
<p> </p>
<h2 name="h2-13" id="h2-13">参考链接</h2>
<h3 name="h3-14" id="h3-14"><strong>6.1 工具链接</strong></h3>
<table><tbody>
<tr>
<td class="ql-align-justify" data-row="1"><strong>工具</strong></td>
<td class="ql-align-justify" data-row="1"><strong>链接</strong></td>
</tr>
<tr>
<td class="ql-align-justify" data-row="2">Pyinstaller</td>
<td class="ql-align-justify" data-row="2">https://pypi.org/project/pyinstaller/</td>
</tr>
<tr>
<td class="ql-align-justify" data-row="3">py2exe</td>
<td class="ql-align-justify" data-row="3">https://pypi.org/project/py2exe/</td>
</tr>
<tr>
<td class="ql-align-justify" data-row="4">bbFreeze</td>
<td class="ql-align-justify" data-row="4">https://pypi.org/project/bbfreeze/</td>
</tr>
<tr>
<td class="ql-align-justify" data-row="5">cx-Freeze</td>
<td class="ql-align-justify" data-row="5">https://pypi.org/project/cx-Freeze/</td>
</tr>
</tbody></table>
<h3 name="h3-15" id="h3-15"><strong>6.2 样本链接</strong></h3>
<ol>
<li data-list="bullet">https://s.threatbook.cn/report/file/287b67d9927b6a318de8c94ef525cc426f59dc2199ee0e0e1caf9ef0881e7555/?sign=history&amp;env=winxpsp3_exe</li>
<li class="ql-align-justify" data-list="bullet">https://s.threatbook.cn/report/file/4827847e926a1f39c720894aba3eae8ee1e711f8cc9f57effbba4ea36c072b81/?sign=history&amp;env=win7_sp1_enx86_office2013</li>
</ol>
<h3 name="h3-16" id="h3-16"><strong>6.3 有关Python木马的安全事件报告</strong></h3>
<ol>
<li class="ql-align-justify" data-list="bullet">https://x.threatbook.cn/nodev4/vb4/article?threatInfoID=2075</li>
<li class="ql-align-justify" data-list="bullet">https://blog.talosintelligence.com/2020/01/jhonerat.html</li>
</ol>
<p> </p>
<h2 name="h2-17" id="h2-17">关于微步在线研究响应团队</h2>
<p>微步情报局，即微步在线研究响应团队，负责微步在线安全分析与安全服务业务，主要研究内容包括威胁情报自动化研发、高级 APT 组织&amp;黑产研究与追踪、恶意代码与自动化分析技术、重大事件应急响应等。</p>

</div><div class="_53" style="display: none;"> 本文翻译自 <a href="" target="_blank">原文链接</a>。如若转载请注明出处。 </div><div class="_206" style="display: none;"> 商务合作，文章发布请联系 anquanke@360.cn </div><div class="_59"><p> 本文由<b>微步在线研究响应团队</b>原创发布 </p><p> 转载，请参考<a href="https://www.anquanke.com/note/repost" target="_blank">转载声明</a>，注明出处： <a href="/post/id/226721" target="_blank">https://www.anquanke.com/post/id/226721</a></p><p>安全客 - 有思想的安全新媒体</p></div><div class="_62" style="display: none;"><p> 本文转载自: <a href=""></a></p><p> 如若转载,请注明出处： <a href="" target="_blank"></a></p><p>安全客 - 有思想的安全新媒体</p></div><div class="_63 share1"><div class="main-w"><div class="bg"></div><div class="main"><span>分享到：</span><img class="icon" data-cmd="weixin" alt="微信" src="https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png" /></div></div><div class="qrcode" title="https://anquanke.com/post/id/226721" style="display: none;"><canvas width="90" height="90"></canvas><img style="display: none;" /></div></div><ul class="_65"><li><a target="_blank" href="/tag/Python">Python</a></li></ul><div class="_56"><div class="line line1"><div class="_18 item1"><b style="display: none;">+1</b><i class="iconfont icon-rate"></i><span class="rate-text">5赞</span></div><div class="_12 item1"><i class=""></i><span>收藏</span></div></div><div class="line line2"><div class="user"><img class="avatar" src="https://p2.ssl.qhimg.com/t01aa27e1778b04d216.png" /><span class="name">微步在线研究响应团队</span><span class="label label-verify"></span></div><div class="_63 share2"><div class="main-w"><div class="bg"></div><div class="main"><span>分享到：</span><img class="icon" data-cmd="weixin" alt="微信" src="https://p0.ssl.qhimg.com/sdm/28_28_100/t01e29062a5dcd13c10.png" /></div></div><div class="qrcode" title="https://anquanke.com/post/id/226721" style="display: none;"><canvas width="90" height="90"></canvas><img style="display: none;" /></div></div></div></div></div><div class="_60"><h2 class="g-title">推荐阅读</h2><ul><li><a href="/post/id/291098"><img src="https://p4.ssl.qhimg.com/sdm/229_160_100/t01ea6cce24f7aeef86.jpg" /><h5 class="g-line2">LOCKBIT 勒索软件团伙声称窃取了波音公司的数据</h5><p>2023-10-30 12:01:47</p></a></li><li><a href="/post/id/291093"><img src="https://p2.ssl.qhimg.com/sdm/229_160_100/t01e660f5663e5fe133.webp" /><h5 class="g-line2">F5 修复了 BIG-IP 身份验证绕过漏洞，允许远程代码执行攻击</h5><p>2023-10-30 11:47:49</p></a></li><li><a href="/post/id/290999"><img src="https://p5.ssl.qhimg.com/sdm/229_160_100/t01f5c9d530c78e3e7a.png" /><h5 class="g-line2">SBSCAN / 一款专注于Spring框架的渗透测试工具</h5><p>2023-10-26 16:04:18</p></a></li><li><a href="/post/id/291000"><img src="https://p1.ssl.qhimg.com/sdm/229_160_100/t01f512a8aeff48c4f9.jpg" /><h5 class="g-line2">云上安全暴露的攻击点</h5><p>2023-10-26 16:02:48</p></a></li></ul></div><div class="_7 index-comment"><h2 class="g-title">发表评论</h2><div class="login"><p class="login-text">您还未登录，请先登录。</p><p class="login-bar"><a href="/login/index.html">登录</a></p></div><!----><!----><!----></div></div><div class="index-side"><div class="index-side-top"><div class="_66"><img class="banner" src="https://p5.ssl.qhimg.com/t01573092fda7526799.png" /><div class="w"><a class="avatar" href="/member.html?memberId=155341"><img src="https://p2.ssl.qhimg.com/t01aa27e1778b04d216.png" /></a><p class="info"><a href="/member.html?memberId=155341" class="name">微步在线研究响应团队</a><a href="/member.html?memberId=155341" class="user-label user-label-verify"></a></p><p class="hint">神秘，低调，手里全是情报。中国网络安全圈不可缺少的力量。</p><div class="bottom"><ul class="bottom-1"><li>文章</li><li><strong>35</strong></li></ul><ul class="bottom-2"><li>粉丝</li><li><strong>32</strong></li></ul><div class="spacer"></div><!----></div></div></div><div class="_64"><h3 class="title"> TA的文章</h3><ul><li><h5><a href="/post/id/263872">Emotet木马"卷土重来"</a></h5><p>2021-12-28 17:30:46</p></li><li><h5><a href="/post/id/259453">相煎何急，印APT组织蔓灵花针对巴基斯坦政府机构展开定向攻击</a></h5><p>2021-11-23 12:00:45</p></li><li><h5><a href="/post/id/258873">双十一，明知是骗局还想薅骗子羊毛，我做到了！</a></h5><p>2021-11-12 12:00:09</p></li><li><h5><a href="/post/id/258167">涉俄APT组织“圣贤熊”针对军队、政府展开经济犯罪和间谍攻击</a></h5><p>2021-11-04 12:00:48</p></li><li><h5><a href="/post/id/255674">推陈出新，Donot组织窃密手法再升级</a></h5><p>2021-10-21 12:00:10</p></li></ul></div><div class="_61"><h3 class="title"> 相关文章</h3><ul><li><h5><a href="/post/id/286709">Python开发人员警告木马化恶意PyPI包</a></h5><p>2023-02-24 12:00:04</p></li><li><h5><a href="/post/id/285352">恶意PyPI软件包使用Cloudflare隧道潜入防火墙</a></h5><p>2023-01-10 14:00:23</p></li><li><h5><a href="/post/id/283446">W4SP恶意软件借供应链攻击，盯上Python开发人员</a></h5><p>2022-11-18 14:00:54</p></li><li><h5><a href="/post/id/280661">15年前未修补Python漏洞或影响35万+项目</a></h5><p>2022-09-23 11:15:56</p></li><li><h5><a href="/post/id/272638">利用python腾讯在线文档的修改</a></h5><p>2022-05-05 10:30:13</p></li><li><h5><a href="/post/id/254410">记一次简单实用的Python脚本编写</a></h5><p>2021-09-27 18:12:44</p></li><li><h5><a href="/post/id/254023">资产扫描利器——AlliN</a></h5><p>2021-09-27 15:30:53</p></li></ul></div><div class="_52"><h3 class="title">热门推荐</h3><ul><li><a href="https://www.anquanke.com/subject/id/289102"><!----><img alt="热门推荐" src="https://p0.ssl.qhimg.com/sdm/386_200_100/t0152915f347d48903f.jpg" /></a></li></ul></div></div><div class="_57"><div class="wrap"><div class="title">文章目录</div><ul class="list"><li class="item"><a class="g-line1" target="_self" href="#h2-0">前言</a><ul></ul></li><li class="item"><a class="g-line1" target="_self" href="#h2-1">常见Python打包工具</a><ul><li class="subitem"><a class="g-line1" href="#h3-2">1. PyInstaller</a></li><li class="subitem"><a class="g-line1" href="#h3-3">2. py2exe</a></li><li class="subitem"><a class="g-line1" href="#h3-4">3. bbFreeze</a></li><li class="subitem"><a class="g-line1" href="#h3-5">4. cx_Freeze</a></li></ul></li><li class="item"><a class="g-line1" target="_self" href="#h2-6">典型木马病毒分析</a><ul></ul></li><li class="item"><a class="g-line1" target="_self" href="#h2-7">总结</a><ul><li class="subitem"><a class="g-line1" href="#h3-8">1. 脚本运行方式</a></li><li class="subitem"><a class="g-line1" href="#h3-9">2. 输出结果</a></li><li class="subitem"><a class="g-line1" href="#h3-10">3. 交互式模式</a></li><li class="subitem"><a class="g-line1" href="#h3-11">4. 运行结果</a></li><li class="subitem"><a class="g-line1" href="#h3-12">5. 总结</a></li></ul></li><li class="item"><a class="g-line1" target="_self" href="#h2-13">参考链接</a><ul><li class="subitem"><a class="g-line1" href="#h3-14">6.1 工具链接</a></li><li class="subitem"><a class="g-line1" href="#h3-15">6.2 样本链接</a></li><li class="subitem"><a class="g-line1" href="#h3-16">6.3 有关Python木马的安全事件报告</a></li></ul></li><li class="item"><a class="g-line1" target="_self" href="#h2-17">关于微步在线研究响应团队</a><ul></ul></li></ul></div></div></div></div><div class="_8"><div class="g-w main"><div class="col1"><p class="col1-logo"><img src="https://p2.ssl.qhimg.com/t018717b31ed82fff86.png" /></p><div class="col1-link"><b class="col1-weixin"></b><a href="https://weibo.com/360adlab" class="col1-sina"></a><a href="https://zhuanlan.zhihu.com/c_118578260" class="col1-zhi"></a></div></div><div class="col2"><div class="title">安全客</div><ul class="col2-list"><li><a href="/about" rel="noopener noreferrer" target="_blank">关于我们</a></li><li><a href="/note/contact" target="_blank" rel="noopener noreferrer">联系我们</a></li><li><a href="/note/protocol" target="_blank" rel="noopener noreferrer">用户协议</a></li></ul></div><div class="col3"><div class="title">商务合作</div><ul class="col3-list"><li><a href="/note/business" target="_blank" rel="noopener noreferrer">合作内容</a></li><li><a href="/note/contact" target="_blank" rel="noopener noreferrer">联系方式</a></li><li><a href="/link" target="_blank" rel="noopener noreferrer">友情链接</a></li></ul></div><div class="col4"><div class="title">内容需知</div><ul><li><a href="https://www.anquanke.com/contribute/tips" target="_blank" rel="noopener noreferrer">投稿须知</a></li><li><a href="/note/repost" target="_blank" rel="noopener noreferrer">转载须知</a></li><li>官网QQ群8：819797106</li><li>官网QQ群3：830462644(已满)</li><li>官网QQ群2：814450983(已满)</li><li>官网QQ群1：702511263(已满)</li></ul></div><div class="col5"><div class="title">合作单位</div><ul><li><a href="http://www.cert.org.cn/" target="_blank" rel="noopener noreferrer"><img alt="安全客" src="https://p0.ssl.qhimg.com/t01592a959354157bc0.png" style="max-height: 40px;" /></a></li><li style="margin-top: -20px;"><a href="http://www.cnnvd.org.cn/" target="_blank" rel="noopener noreferrer"><img alt="安全客" src="https://p0.ssl.qhimg.com/t014f76fcea94035e47.png" style="max-height: 50px; margin-top: 10px;" /></a></li></ul></div></div><div class="right g-w"><span>Copyright © 北京奇虎科技有限公司 360网络攻防实验室 安全客 All Rights Reserved </span><a href="https://beian.miit.gov.cn/">京ICP备08010314号-66</a><span id="cnzz_stat_icon_1271278035"><a href="https://www.cnzz.com/stat/website.php?web_id=1271278035" target="_blank" title="站长统计"><img border="0" hspace="0" vspace="0" src="https://icon.cnzz.com/img/pic.gif" /></a></span></div><div class="layer" style="display: none;"><div class="layer-main"><div class="layer-title">微信二维码</div><b class="layer-close">X</b><img src="https://p0.ssl.qhimg.com/t0151209205b47f2270.jpg" alt="安全客" /></div></div></div></div><script>window.__state__={"artical":{"post":{"id":226721,"title":"关于Python病毒样本的分析方法","category_name":"安全知识","category_slug":"knowledge","desc":"近年来，Python语言凭借其入门简单、功能强大和开发效率高等特性逐渐成为最受欢迎的开发语言，与此同时，Python在安全领域的应用也渐趋广泛，开始被用在黑客和渗透测试的各个领域。","date":"2020-12-29 17:30:48","time_interval":"2020-12-29","status":"publish","comment":0,"cover":"https://p5.ssl.qhimg.com/t01a4f850cb1ea1b70f.png","subject":false,"red":false,"type":"origin","url":"","source":"","fee":"","origin_author":"","pv":243342,"like_count":5,"liked":0,"tags":["Python"],"is_favorite":false,"favorite_count":7,"content":"&lt;html&gt;\n&lt;head&gt;&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"&gt;&lt;/head&gt;\n&lt;body&gt;\n&lt;p&gt;&lt;img class=\"alignnone size-full wp-image-226834 aligncenter\" alt=\"\" width=\"360\" height=\"360\" data-original=\"https://p5.ssl.qhimg.com/t01a4f850cb1ea1b70f.png\"&gt;&lt;/p&gt;\n&lt;p&gt; &lt;/p&gt;\n&lt;h2 name=\"h2-0\" id=\"h2-0\"&gt;前言&lt;/h2&gt;\n&lt;p&gt;近年来，Python语言凭借其入门简单、功能强大和开发效率高等特性逐渐成为最受欢迎的开发语言，与此同时，Python在安全领域的应用也渐趋广泛，开始被用在黑客和渗透测试的各个领域。&lt;/p&gt;\n&lt;p&gt;微步在线在威胁监控过程中，多次发现病毒木马或直接使用Python来编写，或使用Python打包的方式进行投递：如在2020年1月的一起针对阿拉伯地区的APT攻击事件中，攻击者通过投递携带CVE-2017-0199漏洞的docx文件，释放并运行了Python打包的后门程序；又如2019年11月份，Gaza（中东背景APT组织）也被发现使用了Python封装其木马组件。由此可见，Python在网络攻击事件中的出现日趋频繁，这也为安全分析人员带来新的挑战。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;经过分析发现，Python打包的病毒木马主要存在以下3种形式：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;1. 以py脚本的形式存在，此种方式最为常见，但也最容易阅读和分析。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;2. 将pyc文件结构打包到各种可执行文件中，如PyInstaller工具等。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;3. 通过Cython转换成C语言代码，再编译成可执行文件。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;其中，以第1种方式最为简单也最为常见，而第2种、第3种方法具有一定分析难度。本文针对第二种方式进行介绍，将介绍常见的Python打包工具的安装和使用方法，同时对典型的Python打包木马病毒进行分析，并讲述相关逆向分析技巧。&lt;/p&gt;\n&lt;h2 name=\"h2-1\" id=\"h2-1\"&gt;常见Python打包工具&lt;/h2&gt;\n&lt;h3 name=\"h3-2\" id=\"h3-2\"&gt;&lt;strong&gt;1. PyInstaller&lt;/strong&gt;&lt;/h3&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;简介&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;PyInstaller 是一个用来将 Python 程序打包成一个独立可执行软件包，支持 Windows、Linux 和 macOS X。该工具是现在非常成熟的一款工具，具有良好的兼容性，支持的Python版本可达到Python3.7。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;使用方式&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;PyInstaller的使用方式非常简单：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(1) pip install pyinstaller指令就可进行安装。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(2) pyinstaller.exe -F yourcode.py指令就可进行简单打包。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;分析方法&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;PyInstaller打包的文件分析起来也十分简单，有现成的工具脚本——pyinstxtractor.py可以使用。pyinstxtractor.py的下载地址如下：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;https://sourceforge.net/projects/pyinstallerextractor/。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;用法也很简单，指令pyinstxtractor.py+可执行文件，就可以进行解包。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p1.ssl.qhimg.com/t01df1fa27fb9e2a237.png\"&gt;&lt;/p&gt;\n&lt;h3 name=\"h3-3\" id=\"h3-3\"&gt;&lt;strong&gt;2. py2exe&lt;/strong&gt;&lt;/h3&gt;\n&lt;p&gt;&lt;strong&gt;简介&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;Py2exe这个工具只能在Windows平台使用，Py2exe是一个开源项目，github的地址：https://github.com/py2exe/py2exe。Py2exe执行Python2和Python3。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;使用方式&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(1) 下载地址，如下：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li data-list=\"bullet\"&gt;Python3可直接pip下载。&lt;/li&gt;\n&lt;li data-list=\"bullet\"&gt;Python2在https://sourceforge.net/projects/py2exe/files/py2exe/下载。&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p class=\"ql-align-justify\"&gt;(2) 使用方法，如下：&lt;/p&gt;\n&lt;p&gt;使用需要创建一个set.py(名称随意),文件内容：&lt;/p&gt;\n&lt;p&gt;from distutils.core import setup&lt;/p&gt;\n&lt;p&gt;import py2exe&lt;/p&gt;\n&lt;p&gt;setup(windows=[‘1.py’])&lt;/p&gt;\n&lt;p&gt;set.py -h可查看帮助&lt;/p&gt;\n&lt;p&gt;python set.py py2exe指令可编译成exe文件&lt;/p&gt;\n&lt;p&gt;效果如下图：&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p2.ssl.qhimg.com/t01fe6343b9d57d73d2.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;分析方法&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(1) 在py2exe打包后的结果文件中，exe和python.dll都是必要组件。有时python.dll可能会被内嵌在exe中。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(2) 可执行文件运行时必然会调用附带的python.dll。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(3) 对python.dll的导出函数PyMarshal_ReadObjectFromString进行hook或者下断点。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(4) 通过PyMarshal_ReadObjectFromString函数可以获取到打包进exe的pyc数据。该函数有两个参数，参数一是pyc数据的起始地址，参数二为数据的长度。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;注意：在py2exe中获取的pyc数据内包含多个模块，一定要将多个模块进行拆分再反编译，否则会出错的。&lt;/p&gt;\n&lt;h3 name=\"h3-4\" id=\"h3-4\"&gt;&lt;strong&gt;3. bbFreeze&lt;/strong&gt;&lt;/h3&gt;\n&lt;p&gt;&lt;strong&gt;简介&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;BBFreeze由BrainBot Technologies AG开发。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;GitHub的地址：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;https://github.com/schmir/bbfreeze。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;使用方式&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(1) 下载地址，如下：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;可以通过pip或easy_install直接下载。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(2) 使用方法，如下：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;指令：bbFreeze+py脚本&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t0119ae8640e358fe71.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;输出结果如图：&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t01e98198debb7089ff.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;分析方法&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;BBFreeze和其他工具有所差别，它是通过PyRun_StringFlags函数进行。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t013f58c05c0f7e7881.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;BBFreeze会通过zip模块把随身携带的library.zip进行解压，再通过python的exec来进行执行。其中的library.zip可能会嵌在可执行文件当中。library.zip解压后如图：&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p1.ssl.qhimg.com/t01f7f08a17b1dbf821.png\"&gt;&lt;/p&gt;\n&lt;h3 name=\"h3-5\" id=\"h3-5\"&gt;&lt;strong&gt;4. cx_Freeze&lt;/strong&gt;&lt;/h3&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;简介&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;cx_Freeze也是一种用于将Python脚本打包成可执行文件的一种工具，使用起来和py2exe差不多。GitHub的地址：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;https://github.com/marcelotduarte/cx_Freeze&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;使用方式&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(1) 下载地址，如下：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;https://sourceforge.net/projects/cx-freeze&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;也可使用pip进行下载。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(2) 使用方法，如下：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;指令：cxfreeze+py脚本。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;输出文件如同：&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p2.ssl.qhimg.com/t019b25344aed486ca0.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;分析方法&lt;/strong&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;cx_Freeze打包的文件分析起来更为简单。cx_Freeze会将pyc文件直接以资源的形式放在资源段中。我们可以直接使用压缩工具进行打开：&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p3.ssl.qhimg.com/t01ba4fd366529aa153.png\"&gt;&lt;/p&gt;\n&lt;h2 name=\"h2-6\" id=\"h2-6\"&gt;典型木马病毒分析&lt;/h2&gt;\n&lt;p class=\"ql-align-justify\"&gt;通过分析一个简单的样本来演示如何分析这一系列的样本。我们找到一个样本哈希287b67d9927b6a318de8c94ef525cc426f59dc2199ee0e0e1caf9ef0881e7555。&lt;/p&gt;\n&lt;p&gt;分析第一步需要判断该样本是由什么工具打包的：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;首先，我们可以看到有“_MEIPASS2=”字符串，从这可以看到该样本是由Python打包而来。从WinMain函数的代码来看，可以看出来该样本是PythonInstaller打包而来。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t01937d53ec594afdc1.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;确定好是由什么工具打包后，可以使用之前提到的方式直接对其解包。使用pyinstxtractor.py脚本对其进行解包。解包后的文件列表大致如下：&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p2.ssl.qhimg.com/t019d54e86c5e574bbc.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;其中我们可以看到解包后会生成python27.dll，从这可以看出来该样本是由Python2.7编写的。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p1.ssl.qhimg.com/t01ea086133cb3e4fdf.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;我们大致可以看到，解包后的文件有很多。会有很多Python运行必要的组件和第三方组件，如：_socket.pyd、Crypto.Cipher._AES.pyd等。我们可以在文件列表内看到一个没有扩展名的文件：&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t01d7bac648c89b9a0d.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;该文件就是我们需要样本核心代码。该文件的文件名就是打包前py文件的文件名，该文件的文件格式很接近pyc的文件格式。之间的差别就是在于文件头缺少majic字段和时间戳。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p1.ssl.qhimg.com/t01121be783d2c9a264.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;我们添加一个Python2.7的majic字段和任意的时间戳。然后我们就可以使用uncompile.py脚本还原出该py文件。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t01b75f2d5b32c4e7dd.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;对于这种常见工具打包的Python样本，我们通常处理的流程：&lt;/p&gt;\n&lt;p&gt;(1) 判断样本是由什么工具打包而来的。这种工具很常见，它们打包出来的程序往往很容易判断出来。&lt;/p&gt;\n&lt;p&gt;(2) 使用针对的破解工具或方法进行代码提取。&lt;/p&gt;\n&lt;p&gt;(3) 提取的代码通常是pyc文件格式的。&lt;/p&gt;\n&lt;p&gt;(4) 使用uncompile.py脚本进行反编译就可得到原始的py文件。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;&lt;strong&gt;其他Python打包分析&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;通常情况下，病毒样本不会乖乖的使用以上几种工具进行打包。很多黑客会使用自己定制的程序来对python脚本进行打包。我们以一个样本举例，通过该样本来演示如何分析。该样本是一个由pupy的py脚本打包而来的elf文件。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;1. 分析该样本，发现该样本会在内存中解密释放libpython2.7.so.1.0这个so文件。该文件是python2.7的核心文件，导出函数都是python重要的api函数。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t0142325994c41bbc8a.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;2. 在将libpython2.7.so.1.0，就该函数sub_5637CE90DFD2负责获取libpython2.7.so.1.0的导出函数。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p1.ssl.qhimg.com/t0146c8f91a6ed47627.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;3. 将libpython2.7.so.1.0的导出函数地址初始化到imports全局变量内。通过使用dlsym函数，利用函数的名称来获取函数地址。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t01fe5260593bf0356b.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;4. 之前已经将python api的地址存储在imports变量内，之后的调用也是通过imports变量来进行的，还原一下调用的python函数的符号，可以看到样本初始化python环境和执行的整个过程。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;首先是初始化python运行环境。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t01235fadf6425cf797.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;随后初始化必要的python模块。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t01b8344620db97c78d.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t0163311421fb45996a.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;在准备好python运行环境后，就该是加载pupy的代码了。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;看到PyMarshal_ReadObjectFromString函数的时候，可以得知该样本使用脚本式来执行python的代码。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t01453df7f8d86974d7.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;PyMarshal_ReadObjectFromString函数的主要功能是，读取一段数据，生成一个PyCodeObject的python对象。第一个参数是string的地址，第二个参数是数据的长度。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;5. PyMarshal_ReadObjectFromString的第一个参数就是pupy的字节码，这个字节码的实际格式是一个pyc文件。将这个string还原成pyc文件就可以恢复出pupy的py脚本。&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;将PyMarshal_ReadObjectFromString的第一个参数数据保存到pyc文件中。注意，这个时候保存的pyc文件内并没有python的版本信息和时间戳。在文件头前添加8个字节，前四个字节表示python版本（不可随意填写，一定要是python2.7版本）、后四个字节表示时间戳（可随便填写）。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p2.ssl.qhimg.com/t01996ed4a8aad650e1.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;\n&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;通过python的反编译脚本uncompyle6.py对保存的pyc文件进行反编译，就可以生成一个pupy的py脚本。通过对脚本的简单分析就可以十分确定这个样本是pupy家族的。脚本是开源的，具体的行为就不进行分析。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt; &lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t0145341e02587bf378.png\"&gt;&lt;/p&gt;\n&lt;p&gt; &lt;/p&gt;\n&lt;h2 name=\"h2-7\" id=\"h2-7\"&gt;总结&lt;/h2&gt;\n&lt;p&gt;通过对多个工具分析可以看到，无论是通过什么工具进行打包，都需要一个关键的因素，那就是python.dll或libpython.so。那么我们先来介绍一下python.dll在python中起到了什么作用。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;实质上，在整个Python的目录结构中，python.dll是最核心最基础的组件。Python的运行时环境就是在python.dll中实现的，这里包含了对象/类型系统、内存分配器和运行时状态信息。这里也就可以理解为什么任何方式进行打包都需要将对应的python.dll一同打包进去了。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;也就是说，无论什么工具，都是要通过python.dll来建立python的运行环境。这个过程是可以通过调用python.dll的导出函数来实现的。在python.dll的一个导出函数中，有个函数Py_Initialize就是用来初始化Python的运行环境。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;Python有两种主要的运行模式，一种是交互式模式，另一种是脚本运行方式。我们通过两个简单例子来演示一下：&lt;/p&gt;\n&lt;h3 name=\"h3-8\" id=\"h3-8\"&gt;&lt;strong&gt;1. 脚本运行方式&lt;/strong&gt;&lt;/h3&gt;\n&lt;p class=\"ql-align-justify\"&gt;我们准备一个简单的py脚本，将其编译为pyc文件。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t0103ab2527b426c4e5.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;我们准备一个简单的C代码来调用此pyc文件。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p3.ssl.qhimg.com/t016226a81cbcf68f81.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(1) 加载对应版本的python.dll。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(2) 首先先调用Py_Initialize函数。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(3) 随后调用PyRun_SimpleFile，来运行pyc文件。&lt;/p&gt;\n&lt;h3 name=\"h3-9\" id=\"h3-9\"&gt;&lt;strong&gt;2. 输出结果&lt;/strong&gt;&lt;/h3&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p5.ssl.qhimg.com/t01cd34339f75bce121.png\"&gt;&lt;/p&gt;\n&lt;h3 name=\"h3-10\" id=\"h3-10\"&gt;&lt;strong&gt;3. 交互式模式&lt;/strong&gt;&lt;/h3&gt;\n&lt;p class=\"ql-align-justify\"&gt;简单的C代码的例子：&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p4.ssl.qhimg.com/t01afbacea6ff451e21.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(1) 加载对应版本的python.dll。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(2) 首先先调用Py_Initialize函数。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(3) 接下来利用PyDict_New创建一个Dict。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(4) 然后调用PyEval_GetBuiltins获取解释器。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(5) 最后调用PyRun_String来执行各种代码。&lt;/p&gt;\n&lt;h3 name=\"h3-11\" id=\"h3-11\"&gt;&lt;strong&gt;4. 运行结果&lt;/strong&gt;&lt;/h3&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t0101c127752472f4ed.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;根据两个演示，可以很明确的知道Python的运行逻辑。在之后遇到的任何由Python打包的可执行文件时，可以通过对PyRun系列的函数进行检测。&lt;/p&gt;\n&lt;p class=\"ql-align-center\"&gt;&lt;img class=\"aligncenter\" data-original=\"https://p0.ssl.qhimg.com/t0183850fad94bf904f.png\"&gt;&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;通过这一系列的函数，我们可以获取到打包进可执行文件内的明文Python脚本或pyc的字节码。&lt;/p&gt;\n&lt;h3 name=\"h3-12\" id=\"h3-12\"&gt;&lt;strong&gt;5. 总结&lt;/strong&gt;&lt;/h3&gt;\n&lt;p class=\"ql-align-justify\"&gt;处理python打包这一系列样本的过程主要如下：&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(1) 判断是否是已知工具打包。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(2) 如果不是已知工具，可着手查找PyRun系列的函数的调用。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(3) 在PyRun系列的函数的参数中可以获取到对应的样本代码。&lt;/p&gt;\n&lt;p class=\"ql-align-justify\"&gt;(4) 使用uncompile.py脚本进行反编译就可得到原始的py文件。&lt;/p&gt;\n&lt;p&gt; &lt;/p&gt;\n&lt;h2 name=\"h2-13\" id=\"h2-13\"&gt;参考链接&lt;/h2&gt;\n&lt;h3 name=\"h3-14\" id=\"h3-14\"&gt;&lt;strong&gt;6.1 工具链接&lt;/strong&gt;&lt;/h3&gt;\n&lt;table&gt;&lt;tbody&gt;\n&lt;tr&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"1\"&gt;&lt;strong&gt;工具&lt;/strong&gt;&lt;/td&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"1\"&gt;&lt;strong&gt;链接&lt;/strong&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"2\"&gt;Pyinstaller&lt;/td&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"2\"&gt;https://pypi.org/project/pyinstaller/&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"3\"&gt;py2exe&lt;/td&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"3\"&gt;https://pypi.org/project/py2exe/&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"4\"&gt;bbFreeze&lt;/td&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"4\"&gt;https://pypi.org/project/bbfreeze/&lt;/td&gt;\n&lt;/tr&gt;\n&lt;tr&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"5\"&gt;cx-Freeze&lt;/td&gt;\n&lt;td class=\"ql-align-justify\" data-row=\"5\"&gt;https://pypi.org/project/cx-Freeze/&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n&lt;h3 name=\"h3-15\" id=\"h3-15\"&gt;&lt;strong&gt;6.2 样本链接&lt;/strong&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li data-list=\"bullet\"&gt;https://s.threatbook.cn/report/file/287b67d9927b6a318de8c94ef525cc426f59dc2199ee0e0e1caf9ef0881e7555/?sign=history&amp;amp;env=winxpsp3_exe&lt;/li&gt;\n&lt;li class=\"ql-align-justify\" data-list=\"bullet\"&gt;https://s.threatbook.cn/report/file/4827847e926a1f39c720894aba3eae8ee1e711f8cc9f57effbba4ea36c072b81/?sign=history&amp;amp;env=win7_sp1_enx86_office2013&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h3 name=\"h3-16\" id=\"h3-16\"&gt;&lt;strong&gt;6.3 有关Python木马的安全事件报告&lt;/strong&gt;&lt;/h3&gt;\n&lt;ol&gt;\n&lt;li class=\"ql-align-justify\" data-list=\"bullet\"&gt;https://x.threatbook.cn/nodev4/vb4/article?threatInfoID=2075&lt;/li&gt;\n&lt;li class=\"ql-align-justify\" data-list=\"bullet\"&gt;https://blog.talosintelligence.com/2020/01/jhonerat.html&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt; &lt;/p&gt;\n&lt;h2 name=\"h2-17\" id=\"h2-17\"&gt;关于微步在线研究响应团队&lt;/h2&gt;\n&lt;p&gt;微步情报局，即微步在线研究响应团队，负责微步在线安全分析与安全服务业务，主要研究内容包括威胁情报自动化研发、高级 APT 组织&amp;amp;黑产研究与追踪、恶意代码与自动化分析技术、重大事件应急响应等。&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;","index":[{"title":"前言","id":"#h2-0","sub":[]},{"title":"常见Python打包工具","id":"#h2-1","sub":[{"title":"1. PyInstaller","id":"#h3-2"},{"title":"2. py2exe","id":"#h3-3"},{"title":"3. bbFreeze","id":"#h3-4"},{"title":"4. cx_Freeze","id":"#h3-5"}]},{"title":"典型木马病毒分析","id":"#h2-6","sub":[]},{"title":"总结","id":"#h2-7","sub":[{"title":"1. 脚本运行方式","id":"#h3-8"},{"title":"2. 输出结果","id":"#h3-9"},{"title":"3. 交互式模式","id":"#h3-10"},{"title":"4. 运行结果","id":"#h3-11"},{"title":"5. 总结","id":"#h3-12"}]},{"title":"参考链接","id":"#h2-13","sub":[{"title":"6.1 工具链接","id":"#h3-14"},{"title":"6.2 样本链接","id":"#h3-15"},{"title":"6.3 有关Python木马的安全事件报告","id":"#h3-16"}]},{"title":"关于微步在线研究响应团队","id":"#h2-17","sub":[]}],"success":true},"share":{"title":"关于Python病毒样本的分析方法","desc":"近年来，Python语言凭借其入门简单、功能强大和开发效率高等特性逐渐成为最受欢迎的开发语言，与此同时，Python在安全领域的应用也渐趋广泛，开始被用在黑客和渗透测试的各个领域。","imgUrl":"https://p5.ssl.qhimg.com/sdm/160_160_100/t01a4f850cb1ea1b70f.png"},"author":{"nickname":"微步在线研究响应团队","user_url":"","id":155341,"avatar":"https://p2.ssl.qhimg.com/t01aa27e1778b04d216.png","banner":"https://p5.ssl.qhimg.com/t01573092fda7526799.png","location":"","user_label":"verify","description":"神秘，低调，手里全是情报。中国网络安全圈不可缺少的力量。","register_date":"2020-11-13 14:44:37","self":false,"follow":false,"post_count":35,"follower_count":32,"follow_count":0,"comment_count":0},"relevant":[{"id":286709,"title":"Python开发人员警告木马化恶意PyPI包","date":"2023-02-24 12:00:04"},{"id":285352,"title":"恶意PyPI软件包使用Cloudflare隧道潜入防火墙","date":"2023-01-10 14:00:23"},{"id":283446,"title":"W4SP恶意软件借供应链攻击，盯上Python开发人员","date":"2022-11-18 14:00:54"},{"id":280661,"title":"15年前未修补Python漏洞或影响35万+项目","date":"2022-09-23 11:15:56"},{"id":272638,"title":"利用python腾讯在线文档的修改","date":"2022-05-05 10:30:13"},{"id":254410,"title":"记一次简单实用的Python脚本编写","date":"2021-09-27 18:12:44"},{"id":254023,"title":"资产扫描利器——AlliN","date":"2021-09-27 15:30:53"}],"authorPostList":[{"post_id":263872,"title":"Emotet木马\"卷土重来\"","cover":"https://p2.ssl.qhimg.com/sdm/229_160_100/t01091ed8e9cdd4d7b6.jpg","date":"2021-12-28 17:30:46"},{"post_id":259453,"title":"相煎何急，印APT组织蔓灵花针对巴基斯坦政府机构展开定向攻击","cover":"https://p1.ssl.qhimg.com/sdm/229_160_100/t01cec7932b452164ec.jpg","date":"2021-11-23 12:00:45"},{"post_id":258873,"title":"双十一，明知是骗局还想薅骗子羊毛，我做到了！","cover":"https://p1.ssl.qhimg.com/sdm/229_160_100/t01920b9ec8dc6d5856.jpg","date":"2021-11-12 12:00:09"},{"post_id":258167,"title":"涉俄APT组织“圣贤熊”针对军队、政府展开经济犯罪和间谍攻击","cover":"https://p5.ssl.qhimg.com/sdm/229_160_100/t0128e5ff6ca47bc6dc.jpg","date":"2021-11-04 12:00:48"},{"post_id":255674,"title":"推陈出新，Donot组织窃密手法再升级","cover":"https://p2.ssl.qhimg.com/sdm/229_160_100/t011da4e61721e1aef2.jpg","date":"2021-10-21 12:00:10"}],"cookie":[]}};
//published at: 10/30/2023, 8:03:58 AM</script>

<script src="https://s0.ssl.qhimg.com/static/a89b1e55fab19834,969b9d2ab6d58ff9.js"></script>
<script src="https://s0.ssl.qhimg.com/static/e855bc476c0070c4,d70645fabcfd28e5,b00f894d26352cfe,374cd4f654903275,1fbf0cc911f15a9c.js"></script>
<script src="https://s0.ssl.qhimg.com/static/43c736269a19e5f8,d7c4492c306d9e12.js"></script>
<script src="https://s0.ssl.qhimg.com/static/c3f64e723fc684b2,d29a864a4b5dd4b6,5c4b8b1bbe75533d,f59329488ebbc180,569b6657398e046f,50a9d6f78d7b9c2b,ffa01aa1dfa9875c,1e0c54ddfbe618cb,cc52ec6e18fb5e0f,7e2ef3c63800d75a,163f062eddf12afb,12d46f82993a5686,a0f3df7d061398da,d13f12550890a37e,a1038fbbcca5451e,b4f09346293512df,c4dd2a401c8d680a,2cf22cf2afd2abeb,097579769ff1a9e5,cdf1af3ce7fb15c0,52624e35e0a71a1d,2a6f530aa0ff4ab1,a1dbcc9d979007e3,21c0bbbac4162adc,b48c87c047227d8d,a4c086374473de3d,8986a347a9b1bf47,0df21b2fbcae7ee2,5ed46454edb70992,48968bfda2315809,5df7f89714480d5b,2ac5433e81c47d4c,3458ad5e1fb21426,c0f2dbc584b90d28,9b256882cc6d1129,f45edb50c819dfb9,22dc6a03fc216c80,7603fdbafaed5beb,8f3880f75e82b893,7e4ef35e980d3675,1fbafd3380b80586.js"></script><div id="js-toast" data-v-app=""></div><!----><div id="js-lift" data-v-app=""></div><div class="_15"></div>


</body></html>