"undefined"!=typeof lego&&("undefined"==typeof JSON&&(JSON=function(){function m(e){return e<10?"0"+e:e}function s(e){return t.lastIndex=0,t.test(e)?'"'+e.replace(t,function(e){var t=v[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function q(t,r){var o,i,c,a,u,l=e,p=r[t];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(t)),"function"==typeof k&&(p=k.call(r,t,p)),typeof p){case"string":return s(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(e+=n,u=[],"[object Array]"===Object.prototype.toString.apply(p)){for(a=p.length,o=0;o<a;o+=1)u[o]=q(o,p)||"null";return c=0===u.length?"[]":e?"[\n"+e+u.join(",\n"+e)+"\n"+l+"]":"["+u.join(",")+"]",e=l,c}if(k&&"object"==typeof k)for(a=k.length,o=0;o<a;o+=1)"string"==typeof k[o]&&((c=q(i=k[o],p))&&u.push(s(i)+(e?": ":":")+c));else for(i in p)Object.prototype.hasOwnProperty.call(p,i)&&(c=q(i,p))&&u.push(s(i)+(e?": ":":")+c);return c=0===u.length?"{}":e?"{\n"+e+u.join(",\n"+e)+"\n"+l+"}":"{"+u.join(",")+"}",e=l,c}}var p={};"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+m(this.getUTCMonth()+1)+"-"+m(this.getUTCDate())+"T"+m(this.getUTCHours())+":"+m(this.getUTCMinutes())+":"+m(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var u=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,n,v={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},k;return"function"!=typeof p.stringify&&(p.stringify=function(t,r,o){var i;if(n=e="","number"==typeof o)for(i=0;i<o;i+=1)n+=" ";else"string"==typeof o&&(n=o);if((k=r)&&"function"!=typeof r&&("object"!=typeof r||"number"!=typeof r.length))throw Error("JSON.stringify");return q("",{"":t})}),"function"!=typeof p.parse&&(p.parse=function(a,e){function c(t,n){var r,o,i=t[n];if(i&&"object"==typeof i)for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(void 0!==(o=c(i,r))?i[r]=o:delete i[r]);return e.call(t,n,i)}var d;if(a=String(a),u.lastIndex=0,u.test(a)&&(a=a.replace(u,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d=eval("("+a+")"),"function"==typeof e?c({"":d},""):d;throw new SyntaxError("JSON.parse")}),p}()),"undefined"==typeof es5inited&&(es5inited=!0,function(){function c(){}function o(e){return(e=+e)!=e?e=0:0!==e&&e!==1/0&&e!==-1/0&&(e=(0<e||-1)*Math.floor(Math.abs(e))),e}function n(e){var t=typeof e;return null===e||"undefined"==t||"boolean"==t||"number"==t||"string"==t}Function.prototype.bind||(Function.prototype.bind=function(t){var n=this;if("function"!=typeof n)throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var r=l.call(arguments,1),e=Math.max(0,n.length-r.length),o=[],i=0;i<e;i++)o.push("$"+i);var s=Function("binder","return function("+o.join(",")+"){return binder.apply(this,arguments)}")(function(){if(this instanceof s){var e=n.apply(this,r.concat(l.call(arguments)));return Object(e)===e?e:this}return n.apply(t,r.concat(l.call(arguments)))});return n.prototype&&(c.prototype=n.prototype,s.prototype=new c,c.prototype=null),s});var i,s,a,e,t,r=Function.prototype.call,u=Object.prototype,l=Array.prototype.slice,p=r.bind(u.toString),f=r.bind(u.hasOwnProperty);function h(e){for(var t=[];e--;)t.unshift(e);return t}f(u,"__defineGetter__")&&(r.bind(u.__defineGetter__),r.bind(u.__defineSetter__),r.bind(u.__lookupGetter__),r.bind(u.__lookupSetter__)),2!=[1,2].splice(0).length&&(i=Array.prototype.splice,s=Array.prototype.push,a=Array.prototype.unshift,(t=[]).splice.bind(t,0,0).apply(null,h(20)),t.splice.bind(t,0,0).apply(null,h(26)),e=t.length,t.splice(5,0,"XXX"),e+1==t.length?Array.prototype.splice=function(e,t){return arguments.length?i.apply(this,[void 0===e?0:e,void 0===t?this.length-e:t].concat(l.call(arguments,2))):[]}:Array.prototype.splice=function(e,t){var n=l.call(arguments,2),r=n.length;if(!arguments.length)return[];if(void 0===e&&(e=0),void 0===t&&(t=this.length-e),0<r){if(t<=0){if(e==this.length)return s.apply(this,n),[];if(0==e)return a.apply(this,n),[]}return r=l.call(this,e,e+t),n.push.apply(n,l.call(this,e+t,this.length)),n.unshift.apply(n,l.call(this,0,e)),n.unshift(0,this.length),i.apply(this,n),r}return i.call(this,e,t)}),1!=[].unshift(0)&&(a=Array.prototype.unshift,Array.prototype.unshift=function(){return a.apply(this,arguments),this.length}),Array.isArray||(Array.isArray=function(e){return"[object Array]"==p(e)});var y,d,g,b="a"!=(r=Object("a"))[0]||!(0 in r),v=!0;if(Array.prototype.forEach&&Array.prototype.forEach.call("foo",function(e,t,n){"object"!=typeof n&&(v=!1)}),Array.prototype.forEach&&v||(Array.prototype.forEach=function(e,t){var n=C(this),r=b&&"[object String]"==p(this)?this.split(""):n,o=-1,i=r.length>>>0;if("[object Function]"!=p(e))throw new TypeError;for(;++o<i;)o in r&&e.call(t,r[o],o,n)}),Array.prototype.map||(Array.prototype.map=function(e,t){var n=C(this),r=b&&"[object String]"==p(this)?this.split(""):n,o=r.length>>>0,i=Array(o);if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var s=0;s<o;s++)s in r&&(i[s]=e.call(t,r[s],s,n));return i}),Array.prototype.filter||(Array.prototype.filter=function(e,t){var n,r=C(this),o=b&&"[object String]"==p(this)?this.split(""):r,i=o.length>>>0,s=[];if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var c=0;c<i;c++)c in o&&(n=o[c],e.call(t,n,c,r)&&s.push(n));return s}),Array.prototype.every||(Array.prototype.every=function(e,t){var n=C(this),r=b&&"[object String]"==p(this)?this.split(""):n,o=r.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var i=0;i<o;i++)if(i in r&&!e.call(t,r[i],i,n))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(e,t){var n=C(this),r=b&&"[object String]"==p(this)?this.split(""):n,o=r.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");for(var i=0;i<o;i++)if(i in r&&e.call(t,r[i],i,n))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){var t=C(this),n=b&&"[object String]"==p(this)?this.split(""):t,r=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");if(!r&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var o,i=0;if(2<=arguments.length)o=arguments[1];else for(;;){if(i in n){o=n[i++];break}if(++i>=r)throw new TypeError("reduce of empty array with no initial value")}for(;i<r;i++)i in n&&(o=e.call(void 0,o,n[i],i,t));return o}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){var t=C(this),n=b&&"[object String]"==p(this)?this.split(""):t,r=n.length>>>0;if("[object Function]"!=p(e))throw new TypeError(e+" is not a function");if(!r&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var o,r=r-1;if(2<=arguments.length)o=arguments[1];else for(;;){if(r in n){o=n[r--];break}if(--r<0)throw new TypeError("reduceRight of empty array with no initial value")}if(r<0)return o;for(;r in this&&(o=e.call(void 0,o,n[r],r,t)),r--;);return o}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(e){var t=b&&"[object String]"==p(this)?this.split(""):C(this),n=t.length>>>0;if(!n)return-1;var r=0;for(1<arguments.length&&(r=o(arguments[1])),r=0<=r?r:Math.max(0,n+r);r<n;r++)if(r in t&&t[r]===e)return r;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(e){var t=b&&"[object String]"==p(this)?this.split(""):C(this),n=t.length>>>0;if(!n)return-1;var r=n-1;for(1<arguments.length&&(r=Math.min(r,o(arguments[1]))),r=0<=r?r:n-Math.abs(r);0<=r;r--)if(r in t&&e===t[r])return r;return-1}),!Object.keys){var m,w=!0,O="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),_=O.length;for(m in{toString:null})w=!1;Object.keys=function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var t,n=[];for(t in e)f(e,t)&&n.push(t);if(w)for(t=0;t<_;t++){var r=O[t];f(e,r)&&n.push(r)}return n}}Date.prototype.toISOString&&-1!==new Date(-621987552e5).toISOString().indexOf("-000001")||(Date.prototype.toISOString=function(){var e,t,n,r;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(r=this.getUTCFullYear(),e=this.getUTCMonth(),r+=Math.floor(e/12),e=[(e%12+12)%12+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],r=(r<0?"-":9999<r?"+":"")+("00000"+Math.abs(r)).slice(0<=r&&r<=9999?-4:-6),t=e.length;t--;)(n=e[t])<10&&(e[t]="0"+n);return r+"-"+e.slice(0,2).join("-")+"T"+e.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}),m=!1;try{m=Date.prototype.toJSON&&null===new Date(NaN).toJSON()&&-1!==new Date(-621987552e5).toJSON().indexOf("-000001")&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(e){}function j(e,t){for(var n=-1;++n<d;)t+=e*g[n],g[n]=t%y,t=Math.floor(t/y)}function S(e){for(var t=d,n=0;0<=--t;)n+=g[t],g[t]=Math.floor(n/e),n=n%e*y}function E(){for(var e,t=d,n="";0<=--t;){""===n&&0!==t&&0===g[t]||(e=String(g[t]),n=""===n?e:n+("0000000".slice(0,7-e.length)+e))}return n}function x(e,t,n){return 0===t?n:1==t%2?x(e,t-1,n*e):x(e*e,t/2,n)}m||(Date.prototype.toJSON=function(e){var t;e:{if(!n(e=Object(this))){if("function"==typeof(t=e.valueOf)&&n(t=t.call(e)))break e;if("function"==typeof(t=e.toString)&&n(t=t.call(e)))break e;throw new TypeError}t=e}if("number"==typeof t&&!isFinite(t))return null;if("function"!=typeof(t=e.toISOString))throw new TypeError("toISOString property is not callable");return t.call(e)}),Date=function(f){function a(e,t,n,r,o,i,s){var c=arguments.length;return this instanceof f?((c=1==c&&String(e)===e?new f(a.parse(e)):7<=c?new f(e,t,n,r,o,i,s):6<=c?new f(e,t,n,r,o,i):5<=c?new f(e,t,n,r,o):4<=c?new f(e,t,n,r):3<=c?new f(e,t,n):2<=c?new f(e,t):1<=c?new f(e):new f).constructor=a,c):f.apply(this,arguments)}function h(e,t){var n=1<t?1:0;return r[t]+Math.floor((e-1969+n)/4)-Math.floor((e-1901+n)/100)+Math.floor((e-1601+n)/400)+365*(e-1970)}var e,y=RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),r=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(e in f)a[e]=f[e];return a.now=f.now,a.UTC=f.UTC,a.prototype=f.prototype,(a.prototype.constructor=a).parse=function(e){if(p=y.exec(e)){var t=Number(p[1]),n=Number(p[2]||1)-1,r=Number(p[3]||1)-1,o=Number(p[4]||0),i=Number(p[5]||0),s=Number(p[6]||0),c=Math.floor(1e3*Number(p[7]||0)),a=Boolean(p[4]&&!p[8]),u="-"===p[9]?1:-1,l=Number(p[10]||0),p=Number(p[11]||0);return o<(0<i||0<s||0<c?24:25)&&i<60&&s<60&&c<1e3&&-1<n&&n<12&&l<24&&p<60&&-1<r&&r<h(t,1+n)-h(t,n)&&(t=1e3*(60*((t=60*(24*(h(t,n)+r)+o+l*u))+i+p*u)+s)+c,a&&(t=Number(new f(1970,0,1,0,0,0,t))),-864e13<=t&&t<=864e13)?t:NaN}return f.parse.apply(this,arguments)},a}(Date),Date.now||(Date.now=function(){return(new Date).getTime()}),Number.prototype.toFixed&&"0.000"===8e-5.toFixed(3)&&"0"!==.9.toFixed(0)&&"1.25"===1.255.toFixed(2)&&"1000000000000000128"===(0xde0b6b3a7640080).toFixed(0)||(y=1e7,d=6,g=[0,0,0,0,0,0],Number.prototype.toFixed=function(e){var t,n,r;if((e=(e=Number(e))!=e?0:Math.floor(e))<0||20<e)throw new RangeError("Number.toFixed called with invalid number of decimals");if((t=Number(this))!=t)return"NaN";if(t<=-1e21||1e21<=t)return String(t);if(n="",t<0&&(n="-",t=-t),r="0",1e-21<t){r=t*x(2,69,1);for(var o=0;4096<=r;)o+=12,r/=4096;for(;2<=r;)o+=1,r/=2;if(t=(r=o-69)<0?t*x(2,-r,1):t/x(2,r,1),t*=4503599627370496,0<(r=52-r)){for(j(0,t),t=e;7<=t;)j(1e7,0),t-=7;for(j(x(10,t,1),0),t=r-1;23<=t;)S(8388608),t-=23;S(1<<t),j(1,1),S(2),r=E()}else j(0,t),j(1<<-r,0),r=E()+"0.00000000000000000000".slice(2,2+e)}return r=0<e?(t=r.length)<=e?n+"0.0000000000000000000".slice(0,e-t+2)+r:n+r.slice(0,t-e)+"."+r.slice(t-e):n+r});var M,T,N,k,A=String.prototype.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||"".split(/.?/).length||1<".".split(/()()/).length?(M=void 0===/()??/.exec("")[1],String.prototype.split=function(e,t){var n=this;if(void 0===e&&0===t)return[];if("[object RegExp]"!==Object.prototype.toString.call(e))return A.apply(this,arguments);var r=[],o=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),i=0;e=RegExp(e.source,o+"g");var s,c,a,n=n+"";for(M||(s=RegExp("^"+e.source+"$(?!\\s)",o)),t=void 0===t?4294967295:t>>>0;(c=e.exec(n))&&!(i<(o=c.index+c[0].length)&&(r.push(n.slice(i,c.index)),!M&&1<c.length&&c[0].replace(s,function(){for(var e=1;e<arguments.length-2;e++)void 0===arguments[e]&&(c[e]=void 0)}),1<c.length&&c.index<n.length&&Array.prototype.push.apply(r,c.slice(1)),a=c[0].length,i=o,r.length>=t));)e.lastIndex===c.index&&e.lastIndex++;return i===n.length?!a&&e.test("")||r.push(""):r.push(n.slice(i)),r.length>t?r.slice(0,t):r}):"0".split(void 0,0).length&&(String.prototype.split=function(e,t){return void 0===e&&0===t?[]:A.apply(this,arguments)}),"".substr&&"b"!=="0b".substr(-1)&&(T=String.prototype.substr,String.prototype.substr=function(e,t){return T.call(this,e<0&&(e=this.length+e)<0?0:e,t)}),m="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",String.prototype.trim&&!m.trim()||(m="["+m+"]",N=RegExp("^"+m+m+"*"),k=RegExp(m+m+"*$"),String.prototype.trim=function(){if(null==this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(N,"").replace(k,"")});var C=function(e){if(null==e)throw new TypeError("can't convert "+e+" to object");return Object(e)}}(),function(){function e(e){try{return(e.sentinel=0)===Object.getOwnPropertyDescriptor(e,"sentinel").value}catch(e){}}function t(e){try{return Object.defineProperty(e,"sentinel",{}),"sentinel"in e}catch(e){}}var o,i,s,c,a,u,l,n,p,r,f=Function.prototype.call,h=Object.prototype,y=f.bind(h.hasOwnProperty);(a=y(h,"__defineGetter__"))&&(o=f.bind(h.__defineGetter__),i=f.bind(h.__defineSetter__),s=f.bind(h.__lookupGetter__),c=f.bind(h.__lookupSetter__)),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__||(e.constructor?e.constructor.prototype:h)}),Object.defineProperty&&(f=e({}),"undefined"!=typeof document&&!e(document.createElement("div"))||!f)&&(u=Object.getOwnPropertyDescriptor),Object.getOwnPropertyDescriptor&&!u||(Object.getOwnPropertyDescriptor=function(e,t){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+e);if(u)try{return u.call(Object,e,t)}catch(e){}if(y(e,t)){var n={enumerable:!0,configurable:!0};if(a){var r=e.__proto__;e.__proto__=h;var o=s(e,t),i=c(e,t);if(e.__proto__=r,o||i)return o&&(n.get=o),i&&(n.set=i),n}return n.value=e[t],n.writable=!0,n}}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(e){return Object.keys(e)}),Object.create||(l=null===Object.prototype.__proto__||"undefined"==typeof document?function(){return{__proto__:null}}:function(){function e(){}var t=document.createElement("iframe"),n=document.body||document.documentElement;t.style.display="none",n.appendChild(t),t.src="javascript:";var r=t.contentWindow.Object.prototype;return n.removeChild(t),t=null,delete r.constructor,delete r.hasOwnProperty,delete r.propertyIsEnumerable,delete r.isPrototypeOf,delete r.toLocaleString,delete r.toString,delete r.valueOf,r.__proto__=null,e.prototype=r,l=function(){return new e},new e},Object.create=function(e,t){function n(){}var r;if(null===e)r=l();else{if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object prototype may only be an Object or null");n.prototype=e,(r=new n).__proto__=e}return void 0!==t&&Object.defineProperties(r,t),r}),Object.defineProperty&&(f=t({}),n="undefined"==typeof document||t(document.createElement("div")),f&&n||(p=Object.defineProperty,r=Object.defineProperties)),Object.defineProperty&&!p||(Object.defineProperty=function(e,t,n){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.defineProperty called on non-object: "+e);if("object"!=typeof n&&"function"!=typeof n||null===n)throw new TypeError("Property description must be an object: "+n);if(p)try{return p.call(Object,e,t,n)}catch(e){}if(y(n,"value")){var r;a&&(s(e,t)||c(e,t))?(r=e.__proto__,e.__proto__=h,delete e[t],e[t]=n.value,e.__proto__=r):e[t]=n.value}else{if(!a)throw new TypeError("getters & setters can not be defined on this javascript engine");y(n,"get")&&o(e,t,n.get),y(n,"set")&&i(e,t,n.set)}return e}),Object.defineProperties&&!r||(Object.defineProperties=function(e,t){if(r)try{return r.call(Object,e,t)}catch(e){}for(var n in t)y(t,n)&&"__proto__"!=n&&Object.defineProperty(e,n,t[n]);return e}),Object.seal||(Object.seal=function(e){return e}),Object.freeze||(Object.freeze=function(e){return e});try{Object.freeze(function(){})}catch(e){Object.freeze=function(t){return function(e){return"function"==typeof e?e:t(e)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(e){return e}),Object.isSealed||(Object.isSealed=function(e){return!1}),Object.isFrozen||(Object.isFrozen=function(e){return!1}),Object.isExtensible||(Object.isExtensible=function(e){if(Object(e)!==e)throw new TypeError;for(var t="";y(e,t);)t+="?";e[t]=!0;var n=y(e,t);return delete e[t],n})}()),function(){var extensionId="$${lego_id}$$",secKey="$${lego_sec_key}$$",kRequestChannel="chrome.extension.sendRequest",kMessageChannel="chrome.runtime.sendMessage",kNativeMessageChannel="chrome.runtime.sendNativeMessage";function empty(){}var fnLen="function".length,head;function isFn(e){return"string"!=typeof e&&"function"===e.toString().slice(0,fnLen)}["clearInterval","clearTimeout","alert","confirm"].forEach(function(key){eval(key+"=function(a){return window."+key+"(a);};")}),["prompt","setInterval","setTimeout","getComputedStyle"].forEach(function(key){eval(key+"=function(a,b){return window."+key+"(a,b);};")}),["navigator","screen","history","location","document","console","Image","Math"].forEach(function(key){eval(key+"=window."+key)}),document.head||(head=document.getElementsByTagName("head")[0],head&&(document.head=head)),window.getComputedStyle||(getComputedStyle=function(e){return e.currentStyle}),Date.now&&(Date.now=function(){return(new Date).getTime()}),console=console||{log:empty,warn:empty,error:empty,dir:empty},chrome={runtime:{id:extensionId}};var error=function(e){console.log("Error:"),console.log(e.message)},Event=(fe.prototype.addListener=function(e,t){if(this.destroyed_)throw"Event destroyed";if(this.listeners_.push(e),t)throw"Filter not supported"},fe.prototype.dispatch=function(){if(this.destroyed_)throw"Event destroyed";for(var e=[],t=this.listeners_,n=t.length,r=0;r<n;++r){var o=t[r];if(o){try{var i=o.apply(null,arguments)}catch(e){error(e);continue}e.push(i)}}if(0<e.length)return{results:e}},fe.prototype.removeListener=function(e,t){if(this.destroyed_)throw"Event destroyed";for(var n=this.listeners_,r=n.length,o=0;o<r;++o){var i=n[o];i&&i===e&&(i[o]=null)}if(t)throw"Filter not supported"},fe.prototype.destroy_=function(){this.listeners_.length=0,this.destroyed_=!0},fe.prototype.hasListeners=function(){return 0!==this.listeners_.length},fe);function fe(){this.listeners_=[],this.destroyed_=null}chrome.runtime.onConnectExternal=new Event,chrome.runtime.onConnect=new Event,chrome.runtime.onMessageExternal=new Event,chrome.runtime.onMessage=new Event,chrome.runtime.onRequestExternal=new Event,chrome.runtime.onRequest=new Event;var ports={},Port=(ve.prototype.postMessage=function(e){if(this.destroyed_)throw"Port destroyed";void 0===e&&(e=null),void 0!==(e=JSON.stringify(e))?lego.miscellaneous.PostMessage(secKey,this.portId_,e):error("Illegal argument to Port.postMessage")},ve.prototype.disconnect=function(){if(this.destroyed_)throw"Port destroyed";lego.miscellaneous.CloseChannel(secKey,this.portId_,!0),this.destroy_()},ve.prototype.destroy_=function(){if(this.destroyed_)throw"Port destroyed";var e=this.portId_;this.onDestroy_&&this.onDestroy_(),this.onDisconnect.destroy_(),this.onMessage.destroy_(),delete ports[e]},ve);function ve(e,t){this.portId_=e,this.name=t,this.onDisconnect=new Event,this.onMessage=new Event,this.onDestroy_=null,this.destroyed_=null}function createPort(e,t){if(ports[e])throw new Error("Port '"+e+"' already exists.");var n=new Port(e,t);return ports[e]=n,lego.miscellaneous.PortAddRef(e),n}function dispatchOnRequest(e,t,r,n,o,i,s){var c=t==kMessageChannel,a=null;if(!(a=c?s?chrome.runtime.onMessageExternal:chrome.runtime.onMessage:s?chrome.extension.onRequestExternal:chrome.extension.onRequest))return!1;if(!a.hasListeners())return!1;var u=createPort(e,t);function l(e){function t(e){u.postMessage(e),u.destroy_(),u=null}var n;c?(n=a.dispatch(e,r,t))&&n.results&&-1<indexOf(n.results,!0)||!u||(u.destroy_(),u=null):a.dispatch(e,r,t)}return u.onDestroy_=function(){u.onMessage.removeListener(l)},u.onMessage.addListener(l),!0}function dispatchOnConnect(e,t,n,r,o){if(r!=extensionId)return!1;var i=n!=extensionId,s={};if(""!=n&&(s.id=n),o&&(s.url=o),t==kRequestChannel||t==kMessageChannel)return dispatchOnRequest(e,t,s,n,r,o,i);var c=i?chrome.runtime.onConnectExternal:chrome.runtime.onConnect;if(!c)return!1;if(!c.hasListeners())return!1;var a=createPort(e,t);a.sender=s;return c.dispatch(a),!0}function dispatchOnDisconnect(e,t){var n=ports[e];if(n){lego.miscellaneous.CloseChannel(secKey,e,!1),t&&error(t);try{n.onDisconnect.dispatch(n)}catch(e){error(e)}n.destroy_()}}function dispatchOnMessage(e,t){var n=ports[e];n&&(t=t&&JSON.parse(t),n.onMessage.dispatch(t,n))}function sendMessageImpl(t,e,n){function r(){chrome.runtime&&chrome.runtime.lastError&&n()}function o(e){try{n(e)}finally{t.disconnect()}}t.name!=kNativeMessageChannel&&t.postMessage(e),t.name!=kMessageChannel||n?(n=n||function(){},t.onDestroy_=function(){t.onDisconnect.removeListener(r),t.onMessage.removeListener(o)},t.onDisconnect.addListener(r),t.onMessage.addListener(o)):t.disconnect()}lego.miscellaneous.AddListenerOnHasPort(secKey,function(e){return e in ports}),lego.miscellaneous.AddListenerOnConnect(secKey,dispatchOnConnect),lego.miscellaneous.AddListenerOnDisconnect(secKey,dispatchOnDisconnect),lego.miscellaneous.AddListenerOnMessage(secKey,dispatchOnMessage),chrome.runtime.connect=function(e,t){var n,r;switch(arguments.length){case 0:break;case 1:"string"==typeof e?r=e:n=e.name;break;case 2:r=e,n=t.name}return n=n||"",r=r||extensionId,createPort(lego.runtime.OpenChannelToExtension(secKey,extensionId,r,n),n)},chrome.runtime.sendMessage=function(e,t,n){var r,o,i;switch(arguments.length){case 0:throw"Message not provided";case 1:o=e;break;case 2:isFn(t)?(o=e,i=t):(r=e,o=t);break;case 3:r=e,o=t,i=n}r=r||extensionId,o=o||null,i=i||empty;var s={name:kMessageChannel};sendMessageImpl(chrome.runtime.connect(r,s),o,i)}}());
